<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ROOT Analyzer: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ROOT Analyzer Documentation</h1><dl class="rcs"><dt><b>Id</b></dt><dd><a class="el" href="a00050.html">Doxygen.cxx</a> 127 2013-05-03 18:57:16Z lindner </dd></dl>
<h2><a class="anchor" id="intro_sec">
Introduction</a></h2>
<p>This "ROOT analyzer" package is a collection of C++ classes to simplify online and offline analysis of data collected using the MIDAS data acquisition system.</p>
<p>To permit standalone data analysis in mobile and "home institution" environments, this package does not generally require that MIDAS itself be present or installed.</p>
<p>It is envisioned that the user will use this package to develop their experiment specific analyzer using the online data connection to a MIDAS experiment. Then they could copy all the code and data (.mid files) to their laptop and continue further analysis without depending on or requiring installation of MIDAS software.</p>
<p>It is assumed that data will be analyzed using the ROOT toolkit. However, to permit the most wide use of this package, most base classes do not use or require ROOT.</p>
<h2><a class="anchor" id="features_sec">
Features</a></h2>
<ul>
<li>C++ classes for reading MIDAS events from .mid files, including compressed midas files and remote midas files through ssh and dcache pipes, see <a class="el" href="a00031.html#a0f39c35bb559a648f46a5b0d05c16768" title="Open input file.">TMidasFile::Open()</a></li>
<li>C++ classes for reading MIDAS events from a running MIDAS experiment via the mserver or directly from the MIDAS shared memory (this requires linking with MIDAS libraries) (see <a class="el" href="a00032.html" title="MIDAS online connection, including access to online ODB.">TMidasOnline</a>, <a class="el" href="a00049.html">analyzer.cxx</a> and <a class="el" href="a00051.html">event_dump.cxx</a>)</li>
<li>C++ classes for accessing XML ODB data from .mid files (see <a class="el" href="a00047.html" title="Access to ODB saved in XML format inside midas .mid files.">XmlOdb</a>)</li>
<li>C++ classes for accessing ODB through HTTP/mhttpd (see <a class="el" href="a00006.html" title="Access to ODB through the MIDAS HTTP server mhttpd.">HttpOdb</a>)</li>
<li>C++ classes for accessing ODB from MIDAS shared memory (see <a class="el" href="a00032.html" title="MIDAS online connection, including access to online ODB.">TMidasOnline</a>, requires linking with MIDAS libraries).</li>
<li>an example event dump program</li>
<li>an example C++ analyzer main program</li>
<li>the example analyzer creates a graphical ROOT application permitting full use of ROOT graphics in online and offline modes.</li>
<li>for looking at "live" histograms using the ROODY graphical histogram viewer, included is the "TNetDirectory" package for accessing remote ROOT objects.</li>
</ul>
<h2><a class="anchor" id="links_sec">
Links to external packages</a></h2>
<ul>
<li>ROOT data analysis toolkit: <a href="http://root.cern.ch">http://root.cern.ch</a></li>
<li>MIDAS data acquisition system: <a href="http://midas.psi.ch">http://midas.psi.ch</a></li>
<li>ROODY graphical histogram viewer: <a href="http://daq-plone.triumf.ca/SR/ROODY/">http://daq-plone.triumf.ca/SR/ROODY/</a></li>
</ul>
<h2><a class="anchor" id="docs_sec">
Documentation</a></h2>
<ul>
<li>important classes: <a href="classTMidasEvent.html">MIDAS event</a>, <a href="classTMidasFile.html">MIDAS file reader</a>, <a href="classTMidasOnline.html">MIDAS online connection</a>, <a href="structVirtualOdb.html">access ODB data</a></li>
<li><a href="analyzer_8cxx-source.html">example analyzer</a></li>
<li><a href="annotated.html">all ROOTANA classes</a></li>
<li><a href="files.html">all ROOTANA files</a></li>
</ul>
<h2><a class="anchor" id="starting_sec">
Getting started</a></h2>
<ul>
<li>"get" the sources: svn checkout <a href="https://ladd00.triumf.ca/svn/rootana/trunk">https://ladd00.triumf.ca/svn/rootana/trunk</a> rootana</li>
<li>cd rootana</li>
<li>make</li>
<li>make dox (generate this documentation); cd html; mozilla index.html</li>
<li>edit <a class="el" href="a00049.html">analyzer.cxx</a>, look at how different MIDAS events are handled in <a class="el" href="a00049.html#a02459e0090feced3b21974cef795351a">HandleMidasEvent()</a> and how event data is passed to the example user function <a class="el" href="a00049.html#a1700345458ef0b50773df63aad4b9be9">HandleSample()</a>. Create your own HandleFoo() functions to handle your data.</li>
<li>for more advanced analysis, use rootana as a library: in your own analysis directory, copy the example <a class="el" href="a00049.html">analyzer.cxx</a> (rename it according to your tastes, popular choices are "alpharoot", "dragonroot", "fgdroot", etc), place the HandleFoo() functions into separate files HandleFoo{.h,.cxx}.</li>
</ul>
<h2><a class="anchor" id="config_sec">
Configuration</a></h2>
<ul>
<li>env.variable ROOTSYS controls support for ROOT (also the C++ define -DHAVE_ROOT). Most rootana classes require ROOT, so if ROOTSYS is not defined, only code that works without ROOT will be compiled - <a class="el" href="a00030.html" title="MIDAS event.">TMidasEvent</a> and <a class="el" href="a00031.html" title="Reader for MIDAS .mid files.">TMidasFile</a> at this moment.</li>
<li>env.variable MIDASSYS controls support for connecting to live MIDAS data (also the C++ define -DHAVE_MIDAS). All of rootana is supposed to work without MIDAS, except for the <a class="el" href="a00032.html" title="MIDAS online connection, including access to online ODB.">TMidasOnline</a> class.</li>
<li>C++ define -DHAVE_LIBNETDIRECTORY enables use of the newer "libNetDirectory" interface for Roody. This replaces the "-DOLD_SERVER" functions that use the "MIDAS server" from MIDAS mana.c.</li>
<li>C++ define "-DOLD_SERVER" enables the obsolete MIDAS server from MIDAS mana.c. Please use the newer libNetDirectory instead.</li>
</ul>
<h2><a class="anchor" id="histo_sec">
Creating histograms, etc</a></h2>
<p>Think of the example ROOT analyzer as a normal ROOT application where you can do all the normal ROOT things to create histograms, plots, etc</p>
<p>However, one needs to be aware of two things traditionally done by MIDAS analyzers. As can be seen by reading the example analyzer, it creates an output ROOT file and it makes histograms, plots, etc available to other aplications using a network socket connection (via the netDirectoryServer or midasServer). Neither of this functions is required and the corresponding code can be safely removed.</p>
<ul>
<li>interaction with the output ROOT file: by default, for each run, the analyzer opens a new ROOT file outputNNNNN.root and make it the current directory (gOutputFile) for newly created ROOT objects, i.e. those create by "new TH1(...)". At the end of a run, all these objects are saved into the file, the file is closed and all these objects disappear from memory. To create ROOT objects that persist across runs, use some other ROOT directory (i.e. gOnlineHistDir-&gt;cd()).</li>
</ul>
<ul>
<li>when using the netDirectoryServer (HAVE_LIBNETDIRECTORY), the contents of gOnlineHistDir and gOutputFile are exported to outside applications. Other programs, i.e. ROODY, can use <a class="el" href="a00034.html">TNetDirectory</a> to "see" the histograms (and other objects) as they are filled. (Note: this does not work for most TTree objects because they cannot be easily "exported").</li>
</ul>
<h2><a class="anchor" id="graph_sec">
Creating interactive graphics, etc</a></h2>
<p>Think of the example ROOT analyzer as a normal ROOT application where you can use all the normal ROOT graphics operations - create new TCanvas objects, draw on them, interact with them at will. This is possible because in the online mode, the application is controlled by the ROOT TApplication-&gt;Run() method - MIDAS event processing happens from <a class="el" href="a00040.html">TTimer</a> events. In the offline mode, the example analyzer does not start the ROOT event loop until the last file has been processed.</p>
<p>The example analyzer contains graphics code to create a new "main window" with an example menu and provides an example ROOT event handler to execute menu commands and to interact with the user.</p>
<h2><a class="anchor" id="analyzerFramework">
Analyzer Framework</a></h2>
<p>Recently (post 2012) we have also been adding additional framework classes to rootana. You can see more information on this framework here:</p>
<ul>
<li><a class="el" href="analyzerClass.html">Analyzer Classes</a></li>
<li><a class="el" href="displayClass.html">Display Classes</a> </li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 15 May 2013 for ROOT Analyzer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
