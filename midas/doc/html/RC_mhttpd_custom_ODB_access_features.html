<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Features using ODB access from a Custom page</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="RunControl.html">SECTION 5: Run Control</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_run_control.html">Run Control Programs</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd.html">mhttpd: the MIDAS Web-based Run Control utility</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_Custom_page.html">Custom pages</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_custom_features.html">Features available on custom pages</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_custom_ODB_access.html">Access to the ODB from a Custom page</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="RC_mhttpd_custom_ODB_access_features">Features using ODB access from a Custom page </a></h1><p><br/>
</p>
 <script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_custom_ODB_access_examples", "RunControl", "RC_mhttpd_custom_RPC_access","RC_mhttpd_custom_ODB_access_features",  "end" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script> <p><br/>
 This page describes several features with ODB access on a custom page.</p>
<ul>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_custom_checkboxes">Including checkboxes on a custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_js_update_part">Periodic update of parts of a custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_custom_pw_protection">Password protection of ODB variables accessed from a custom page</a></li>
</ul>
<h2><a class="anchor" id="RC_mhttpd_custom_checkboxes">
Including checkboxes on a custom page</a></h2>
<p>The function <span class="js">ODBSet</span> can be used when one clicks on an <b>checkbox</b> for example: </p>
<div class="fragment"><pre class="fragment">  &lt;input type=<span class="stringliteral">&quot;checkbox&quot;</span> onClick=<span class="stringliteral">&quot;ODBSet(&apos;/Logger/Write data&apos;,this.checked?&apos;1&apos;:&apos;0&apos;)&quot;</span>&gt;
</pre></div><p>If used as above, the state of the checkbox must be initialized when the page is loaded. This can be done with some JavaScript code called on initialization, which then uses <a class="el" href="RC_mhttpd_custom_ODB_access.html#RC_mhttpd_custom_odbset">ODBSet JavaScript function</a> as described above.</p>
<p>Alternatively, the checkbox can be created using an <span class="odbtag"> &lt;odb...&gt; </span> <a class="el" href="RC_mhttpd_custom_ODB_access.html#RC_mhttpd_custom_odb_html">tag</a> as follows: </p>
<div class="fragment"><pre class="fragment">  &lt;odb src=<span class="stringliteral">&quot;/Logger/Write data&quot;</span> type=<span class="stringliteral">&quot;checkbox&quot;</span> edit=<span class="stringliteral">&quot;2&quot;</span> onclick=<span class="stringliteral">&quot;ODBSet(&apos;/Logger/Write data&apos;,this.checked?&apos;1&apos;:&apos;0&apos;)&quot;</span>&gt;
</pre></div><p>The special code <b>edit="2"</b> instructs <span class="utility">mhttpd</span> not to put any JavaScript code into the checkbox tag, since setting this value in the ODB is now handled by the user-supplied <span class="js">ODBSet()</span> code.</p>
<h2><a class="anchor" id="RC_mhttpd_js_example_3">
Example of Checkboxes using JavaScript and HTML</a></h2>
<div class="fragment"><pre class="fragment">&lt;!DOCTYPE HTML PUBLIC <span class="stringliteral">&quot;-//W3C//DTD HTML 4.0 TRANSITIONAL//EN&quot;</span>&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt; ODBEdit test&lt;/title&gt;
&lt;!-- include the mhttpd JS library --&gt;
\htmlonly &lt;script src=<span class="stringliteral">&quot;/js/mhttpd.js&quot;</span> type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;&lt;/script&gt; \endhtmlonly

\htmlonly &lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;

var my_action = <span class="stringliteral">&apos;&quot;/CS/try&amp;&quot;&apos;</span>
var ival;
var my_expt=<span class="stringliteral">&quot;midas&quot;</span>;
&lt;/script&gt; \endhtmlonly
&lt;/head&gt;&lt;body&gt;
&lt;form method=<span class="stringliteral">&quot;get&quot;</span> name=<span class="stringliteral">&quot;form2&quot;</span> action=<span class="stringliteral">&apos;+my_action+&apos;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;exp&quot;</span> value=<span class="stringliteral">&quot;&apos;+my_expt+&apos;&quot;</span> type=<span class="stringliteral">&quot;hidden&quot;</span>&gt;
Write data: &lt;odb src=<span class="stringliteral">&quot;/Logger/Write data&quot;</span>&gt;&lt;br&gt;
JS Checkbox ... Write Data:
&lt;input  name=<span class="stringliteral">&quot;mybox&quot;</span>  type=<span class="stringliteral">&quot;checkbox&quot;</span>   onClick=<span class="stringliteral">&quot;ODBSet(&apos;/Logger/Write data&apos;,this.checked?&apos;1&apos;:&apos;0&apos;)&quot;</span>&gt;
\htmlonly &lt;script&gt;
<span class="keywordflow">if</span>( ODBGet(<span class="stringliteral">&apos;/Logger/Write data&apos;</span>) ==<span class="charliteral">&apos;y&apos;</span>)
  ival=1;
<span class="keywordflow">else</span>
  ival=0;
document.write(<span class="stringliteral">&apos;&lt;br&gt;ival=&apos;</span>+ival+<span class="stringliteral">&apos;&lt;br&gt;&apos;</span>);
document.form2.mybox.checked=ival  <span class="comment">// initialize to the correct value</span>
&lt;/script&gt; \endhtmlonly

&lt;br&gt;HTML checkbox... Write Data:
  &lt;odb src=<span class="stringliteral">&quot;/Logger/Write data&quot;</span> type=<span class="stringliteral">&quot;checkbox&quot;</span> edit=<span class="stringliteral">&quot;2&quot;</span> onclick=<span class="stringliteral">&quot;ODBSet(&apos;/Logger/Write data&apos;,this.checked?&apos;1&apos;:&apos;0&apos;)&quot;</span>&gt;
&lt;br&gt;
&lt;/form&gt;
&lt;/html&gt;
</pre></div><p><br/>
<br/>
<br/>
 </p>
<center> <span class="image">Figure 4 Output from above code: checkboxes <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="checkboxes.png" alt="checkboxes.png"/>
</div>
<p> <br/>
<br/>
<br/>
 </span></center><p><br/>
<hr/>
<br/>
</p>
<p><a class="anchor" id="idx_mhttpd_page_custom_refresh_partial"></a> </p>
<h2><a class="anchor" id="RC_mhttpd_js_update_part">
Periodic update of parts of a custom page</a></h2>
<p>The functionality of <span class="js">ODBGet</span> together with the</p>
<ul>
<li><b>window.setInterval()</b> function</li>
</ul>
<p>can be used to update parts of the web page periodically. <br/>
 For example the Javascript fragment below contains a function which updates the current run number every 10 seconds in the background : </p>
<div class="fragment"><pre class="fragment">  window.setInterval(<span class="stringliteral">&quot;Refresh()&quot;</span>, 10000);

  function Refresh() {
    document.getElementById(<span class="stringliteral">&quot;run_number&quot;</span>).innerHTML = ODBGet(<span class="stringliteral">&apos;/Runinfo/Run number&apos;</span>);
  }
</pre></div><p>The custom page has to contain an element with id="run_number", such as </p>
<div class="fragment"><pre class="fragment">  &lt;td <span class="keywordtype">id</span>=<span class="stringliteral">&quot;run_number&quot;</span>&gt;&lt;/td&gt;
</pre></div><p> <br/>
<br/>
</p>
<h2><a class="anchor" id="RC_mhttpd_custom_pw_protection">
Password protection of ODB variables accessed from a custom page</a></h2>
<p>Being able to control an experiment through a web interface of course raises the question of safety. This is not so much about external access (for which there are other protection schemes like host lists etc.) but it's about accidental access by the normal shift crew. If a single click on a web page opens a critical valve, this might be a problem. In order to restrict access to some "experts", an additional password can be chosen for all or some controls on a custom page.</p>
<p>Password protection is optional, and must be set up by the user. The <em>password</em> must be defined as an ODB entry of the form <span class="odb"> /Custom/Pwd/&lt;password&gt; </span>. If the password is <em>CustomPwd</em>, the ODB key <span class="odb">/Custom/Pwd/CustomPwd </span> would be defined.</p>
<p>By using an explicit name, one can use a single password for all controls on a page, or one could use several passwords on the same page. For example, a shift crew password for the less severe controls (<em>ShiftPwd</em>), and an "expert" password (<em>ExpertPwd</em>) for the critical things.</p>
<p>The ODB would have two passwords defined, i.e.<br/>
 <span class="odb"> /Custom/Pwd/ExpertPwd<br/>
 /Custom/Pwd/ShiftPwd</span><br/>
</p>
<p>The password is of course not secure in the sense that it's placed in plain text into the ODB, but its purpose is to prevent accidental modification, rather than malicious interference.</p>
<p><br/>
 Password protection is available for</p>
<ul>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_pw">Password protection of Edit Boxes</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access.html#RC_mhttpd_custom_odbset">ODBSet JavaScript function</a></li>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_imagemap_pw">Area map with password check</a></li>
</ul>
<p>If password protection <b>is</b> set up, <span class="utility">mhttpd</span> will check the supplied password against the ODB entry, and show an error if they don't match.</p>
<p><a class="anchor" id="end"></a></p>
 <script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_custom_ODB_access_examples", "RunControl", "RC_mhttpd_custom_RPC_access","RC_mhttpd_custom_ODB_access_features",  "" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

