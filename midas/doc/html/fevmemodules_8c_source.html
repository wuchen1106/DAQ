<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: fevmemodules.c Source File</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_df984a6dc4b1d10721bf65eb91241719.html">examples</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_b0429a58672f76ea50f1ba586d7ec660.html">Triumf</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5b6d33c4e46691d194201415b862e084.html">c</a>
  </div>
</div>
<div class="contents">
<h1>fevmemodules.c</h1><a href="fevmemodules_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/********************************************************************\</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">  Name:         fevmemodules.c</span>
<a name="l00004"></a>00004 <span class="comment">  Created by:   </span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">  Contents:    C code example of standarized frontend dealing with</span>
<a name="l00007"></a>00007 <span class="comment">  common VME module at Triumf.</span>
<a name="l00008"></a>00008 <span class="comment">  Used with the VMIC Fanuc VME processor board. </span>
<a name="l00009"></a>00009 <span class="comment">  Missing parameters for the V1729</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment">  $Id: fevmemodules.c 3551 2007-02-02 05:52:20Z amaudruz $</span>
<a name="l00012"></a>00012 <span class="comment">\********************************************************************/</span>
<a name="l00013"></a>00013 <span class="preprocessor">#undef  V792_CODE</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#undef  VADC0_CODE</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#undef  VADC1_CODE</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor">#undef  VADC2_CODE</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">#undef  VADC3_CODE</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span><span class="preprocessor">#undef  VTDC0_CODE</span>
<a name="l00019"></a><a class="code" href="fevmemodules_8c.html#a12a02425f79527aa8cf10894e2d0e0d6">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define  VF48_CODE</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#undef  VMEIO_CODE</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#undef V1729_CODE</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="midas_8h.html">midas.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="mvmestd_8h.html">mvmestd.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;vmicvme.h&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="vmeio_8h.html">vmeio.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="v1190B_8h.html">v1190B.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="v792_8h.html">v792.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;vf48.h&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="v1729_8h.html">v1729.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="experim_8h.html">experim.h</a>&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// VMEIO definition</span>
<a name="l00036"></a><a class="code" href="fevmemodules_8c.html#ad6c3e6f40d580b713afb1d8f4fe92dd7">00036</a> <span class="preprocessor">#define P_BOE      0x1  // </span>
<a name="l00037"></a><a class="code" href="fevmemodules_8c.html#a93d7238f44b662d68192a2091933821e">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define P_EOE      0x2  // </span>
<a name="l00038"></a><a class="code" href="fevmemodules_8c.html#ae4e1fdc925f086a479d7e889dbfaaf9e">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define P_CLR      0x4  // </span>
<a name="l00039"></a><a class="code" href="fevmemodules_8c.html#af89ae631a74234ea7f55a6d3767eb8cc">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define S_READOUT  0x8  //</span>
<a name="l00040"></a><a class="code" href="fevmemodules_8c.html#a1218cb0e8300322e213dcc9e94677c13">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define S_RUNGATE  0x10 //</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>
<a name="l00042"></a>00042 <span class="comment">/* Interrupt vector */</span>
<a name="l00043"></a><a class="code" href="fevmemodules_8c.html#ad8650f66958ab0805468d3ed83722cd6">00043</a> <span class="keywordtype">int</span> <a class="code" href="fevmemodules_8c.html#ad8650f66958ab0805468d3ed83722cd6">trig_level</a> =  0;
<a name="l00044"></a><a class="code" href="fevmemodules_8c.html#a90a84f3ea9d75594c6cde52a179b5e88">00044</a> <span class="preprocessor">#define TRIG_LEVEL  (int) 1</span>
<a name="l00045"></a><a class="code" href="fevmemodules_8c.html#aed01298d37e73ed9737c8a6b70e67caa">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define INT_LEVEL   (int) 3</span>
<a name="l00046"></a><a class="code" href="fevmemodules_8c.html#aa992c6e0d30eebad60b642ec25681bcb">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define INT_VECTOR  (int) 0x16</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="keyword">extern</span> INT_INFO <a class="code" href="fevmemodules_8c.html#ab41e1a698055c9419f431cb4a4c2339c">int_info</a>;
<a name="l00048"></a><a class="code" href="fevmemodules_8c.html#a078c7a09da85e54e060ec80b7f9e2649">00048</a> <span class="keywordtype">int</span> <a class="code" href="fevmemodules_8c.html#a078c7a09da85e54e060ec80b7f9e2649">myinfo</a> = VME_INTERRUPT_SIGEVENT;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">/* make frontend functions callable from the C framework */</span>
<a name="l00051"></a>00051 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00053"></a>00053 <span class="preprocessor">#endif</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>
<a name="l00055"></a>00055 <span class="comment">/*-- Globals -------------------------------------------------------*/</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* The frontend name (client name) as seen by other MIDAS clients   */</span>
<a name="l00058"></a><a class="code" href="mevb_8c.html#ac1f0c6df66e35778b61c611107501ec4">00058</a> <span class="keywordtype">char</span> *<a class="code" href="mfe_8c.html#ac1f0c6df66e35778b61c611107501ec4">frontend_name</a> = <span class="stringliteral">&quot;fevmemodules&quot;</span>;
<a name="l00059"></a>00059 <span class="comment">/* The frontend file name, don&apos;t change it */</span>
<a name="l00060"></a><a class="code" href="mevb_8c.html#ac7fc683b5a25d9607abc270a54db6d97">00060</a> <span class="keywordtype">char</span> *<a class="code" href="mfe_8c.html#ac7fc683b5a25d9607abc270a54db6d97">frontend_file_name</a> = __FILE__;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/* frontend_loop is called periodically if this variable is TRUE    */</span>
<a name="l00063"></a><a class="code" href="mevb_8c.html#a0215c0a842a0e97fe65c7ef5fb7633a5">00063</a> <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a> <a class="code" href="mfe_8c.html#a0215c0a842a0e97fe65c7ef5fb7633a5">frontend_call_loop</a> = FALSE;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/* a frontend status page is displayed with this frequency in ms */</span>
<a name="l00066"></a><a class="code" href="mevb_8c.html#ab9cdcefda91459091b0ed33011d0d18c">00066</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ab9cdcefda91459091b0ed33011d0d18c">display_period</a> = 000;
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">/* maximum event size produced by this frontend */</span>
<a name="l00069"></a><a class="code" href="mevb_8c.html#a13adb6e6b95ca2a62bbfe2453d71a1cd">00069</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a13adb6e6b95ca2a62bbfe2453d71a1cd">max_event_size</a> = 200000;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">/* maximum event size for fragmented events (EQ_FRAGMENTED) */</span>
<a name="l00072"></a><a class="code" href="mevb_8c.html#a5593758d19398ebc7c3d58d7f05ec160">00072</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a5593758d19398ebc7c3d58d7f05ec160">max_event_size_frag</a> = 5 * 1024 * 1024;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* buffer size to hold events */</span>
<a name="l00075"></a><a class="code" href="mevb_8c.html#a4411d7db6f901c968b946ed659d202f6">00075</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a4411d7db6f901c968b946ed659d202f6">event_buffer_size</a> = 10 * 100000;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">/* Hardware */</span>
<a name="l00078"></a><a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">00078</a> <a class="code" href="structMVME__INTERFACE.html">MVME_INTERFACE</a> *<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>;
<a name="l00079"></a><a class="code" href="fevmemodules_8c.html#ac7cce186dd76dade3ec935efb745e1a0">00079</a> <span class="keywordtype">int</span>  <a class="code" href="fevmemodules_8c.html#ac7cce186dd76dade3ec935efb745e1a0">sRG</a> = 0;    <span class="comment">// state run gate</span>
<a name="l00080"></a><a class="code" href="fevmemodules_8c.html#af04b8670f9eb7a42f73148ced267ab35">00080</a> <span class="keywordtype">int</span>  <a class="code" href="fevmemodules_8c.html#af04b8670f9eb7a42f73148ced267ab35">intflag</a> = 0;
<a name="l00081"></a><a class="code" href="fevmemodules_8c.html#a6cde1377f6c51796f78ef647404f396a">00081</a> <span class="keywordtype">int</span>  <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a> = 0, <a class="code" href="fevmemodules_8c.html#a6cde1377f6c51796f78ef647404f396a">missed</a>=0;
<a name="l00082"></a><a class="code" href="fevmemodules_8c.html#a25a07c1f75f0b67144cbdc264ffdb09c">00082</a> <span class="keywordtype">int</span> <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>=0, <a class="code" href="fevmemodules_8c.html#a25a07c1f75f0b67144cbdc264ffdb09c">stop_req</a>=0;
<a name="l00083"></a><a class="code" href="fevmemodules_8c.html#adb65a4e8d1413f7d40cc16e7118899ce">00083</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#adb65a4e8d1413f7d40cc16e7118899ce">evlimit</a>;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">/* VME base address */</span>
<a name="l00086"></a><a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">00086</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a> = 0x780000;
<a name="l00087"></a><a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">00087</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a> = 0xF10000;
<a name="l00088"></a><a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">00088</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a> = 0x100000;
<a name="l00089"></a><a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">00089</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a> = 0x200000;
<a name="l00090"></a><a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">00090</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a> = 0x300000;
<a name="l00091"></a><a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">00091</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a> = 0x400000;
<a name="l00092"></a>00092   <span class="comment">// DWORD VLAM_BASE  = 0x500000;</span>
<a name="l00093"></a><a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">00093</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>  = 0x800000;
<a name="l00094"></a><a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">00094</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>  = 0xAF0000;
<a name="l00095"></a><a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">00095</a> <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a> = 0x120000;
<a name="l00096"></a>00096 <span class="comment">/* Globals */</span>
<a name="l00097"></a><a class="code" href="fevmemodules_8c.html#aeac9187aeffc031aa4adaf856d17093b">00097</a> <span class="preprocessor">#define  N_ADC 100</span>
<a name="l00098"></a><a class="code" href="fevmemodules_8c.html#a7e9c82b300255f54b1528c66fdcdfafd">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define  N_TDC 100</span>
<a name="l00099"></a><a class="code" href="fevmemodules_8c.html#a67f9565ee144db95e5394b15e393e539">00099</a> <span class="preprocessor"></span><span class="preprocessor">#define  N_PTS 5000</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="keyword">extern</span> HNDLE <a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>;
<a name="l00101"></a><a class="code" href="fevmemodules_8c.html#a24a9e510d792776924958328f8220d75">00101</a> HNDLE <a class="code" href="fevmemodules_8c.html#a24a9e510d792776924958328f8220d75">hSet</a>;
<a name="l00102"></a><a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">00102</a> <a class="code" href="structTRIGGER__SETTINGS.html">TRIGGER_SETTINGS</a> <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">/* number of channels */</span>
<a name="l00105"></a><a class="code" href="fevmemodules_8c.html#ad2e95a3b1cf99277a9faad8a41d0ab8b">00105</a> <span class="preprocessor">#define N_SCLR 4</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span>
<a name="l00107"></a>00107 <span class="comment">/*-- Function declarations -----------------------------------------*/</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a802849119d469feb2d1deee1be9593ac">frontend_init</a>();
<a name="l00110"></a>00110 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a3b682405038cc4f6af505d7ca6367a4f">frontend_exit</a>();
<a name="l00111"></a>00111 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ad8bfe703c49342b9f0275aba77dc7758">begin_of_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error);
<a name="l00112"></a>00112 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ae6d798649008b7523c77222bae2d4187">end_of_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error);
<a name="l00113"></a>00113 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a164db20cf6c8c81e8c8ca50a590de436">pause_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error);
<a name="l00114"></a>00114 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a6cada7e3f07b9fc2b9886263223661d4">resume_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error);
<a name="l00115"></a>00115 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ad902740ed5577f2f940454359ec1df1c">frontend_loop</a>();
<a name="l00116"></a>00116 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="mfe_8c.html#a8b84b3b4051dae0ba00258a3c885c0c7">interrupt_routine</a>(<span class="keywordtype">void</span>);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="fevmemodules_8c.html#a9c54bafa1af403e5e4737f9d8d5aba07">read_trigger_event</a>(<span class="keywordtype">char</span> *pevent, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> off);
<a name="l00119"></a>00119 <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="fevmemodules_8c.html#af3ad062393c1437922bae26841d8927c">read_scaler_event</a>(<span class="keywordtype">char</span> *pevent, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> off);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="keywordtype">void</span> <a class="code" href="fevmemodules_8c.html#a4c2c646c3b139346601893d06cf6df9d">register_cnaf_callback</a>(<span class="keywordtype">int</span> <a class="code" href="mfe_8c.html#a81f0a890e023743f1b88d0cb7d4f74db">debug</a>);
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="fevmemodules_8c.html#a578a99806dff3ee5cd0c3c6583e60db4">00123</a> <a class="code" href="structBANK__LIST.html">BANK_LIST</a> <a class="code" href="fevmemodules_8c.html#a578a99806dff3ee5cd0c3c6583e60db4">trigger_bank_list</a>[] = {
<a name="l00124"></a>00124 
<a name="l00125"></a>00125    <span class="comment">/* online banks */</span>
<a name="l00126"></a>00126    {<span class="stringliteral">&quot;ADC0&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#aeac9187aeffc031aa4adaf856d17093b">N_ADC</a>, NULL}
<a name="l00127"></a>00127    ,
<a name="l00128"></a>00128    {<span class="stringliteral">&quot;ADC1&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#aeac9187aeffc031aa4adaf856d17093b">N_ADC</a>, NULL}
<a name="l00129"></a>00129    ,
<a name="l00130"></a>00130    {<span class="stringliteral">&quot;ADC2&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#aeac9187aeffc031aa4adaf856d17093b">N_ADC</a>, NULL}
<a name="l00131"></a>00131    ,
<a name="l00132"></a>00132    {<span class="stringliteral">&quot;ADC3&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#aeac9187aeffc031aa4adaf856d17093b">N_ADC</a>, NULL}
<a name="l00133"></a>00133    ,
<a name="l00134"></a>00134    {<span class="stringliteral">&quot;TDC0&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#a7e9c82b300255f54b1528c66fdcdfafd">N_TDC</a>, NULL}
<a name="l00135"></a>00135    ,
<a name="l00136"></a>00136 
<a name="l00137"></a>00137    {<span class="stringliteral">&quot;WAVE&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#a7e9c82b300255f54b1528c66fdcdfafd">N_TDC</a>, NULL}
<a name="l00138"></a>00138    ,
<a name="l00139"></a>00139    {<span class="stringliteral">&quot;FWAV&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="fevmemodules_8c.html#a67f9565ee144db95e5394b15e393e539">N_PTS</a>, NULL}
<a name="l00140"></a>00140    ,
<a name="l00141"></a>00141 
<a name="l00142"></a>00142    {<span class="stringliteral">&quot;&quot;</span>}
<a name="l00143"></a>00143    ,
<a name="l00144"></a>00144 };
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">/*-- Equipment list ------------------------------------------------*/</span>
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="preprocessor">#undef USE_INT</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>
<a name="l00150"></a><a class="code" href="mevb_8c.html#aa86ef8764826784b74603ffb23852283">00150</a> <a class="code" href="structeqpmnt.html">EQUIPMENT</a> <a class="code" href="mfe_8c.html#aa86ef8764826784b74603ffb23852283">equipment</a>[] = {
<a name="l00151"></a>00151 
<a name="l00152"></a>00152    {<span class="stringliteral">&quot;Trigger&quot;</span>,               <span class="comment">/* equipment name */</span>
<a name="l00153"></a>00153     {1, 0,                   <span class="comment">/* event ID, trigger mask */</span>
<a name="l00154"></a>00154      <span class="stringliteral">&quot;SYSTEM&quot;</span>,               <span class="comment">/* event buffer */</span>
<a name="l00155"></a>00155 <span class="preprocessor">#ifdef USE_INT</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>     <a class="code" href="group__mdefineh.html#gad5ba2ec0f5d55139048dbe2d416da6ba">EQ_INTERRUPT</a>,           <span class="comment">/* equipment type */</span>
<a name="l00157"></a>00157 <span class="preprocessor">#else</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>     <a class="code" href="group__mdefineh.html#ga58e919e4e401b299c1834be965c3e78c">EQ_PERIODIC</a>, <span class="comment">// POLLED,              /* equipment type */</span>
<a name="l00159"></a>00159 <span class="preprocessor">#endif</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>     <a class="code" href="group__midasincludecode.html#ga93fde3913a488880c4f96267e24579ee">LAM_SOURCE</a>(0, 0x0),     <span class="comment">/* event source crate 0, all stations */</span>
<a name="l00161"></a>00161      <span class="stringliteral">&quot;MIDAS&quot;</span>,                <span class="comment">/* format */</span>
<a name="l00162"></a>00162      TRUE,                   <span class="comment">/* enabled */</span>
<a name="l00163"></a>00163      <a class="code" href="group__mdefineh.html#gafc5ef41cae398b8500f9c3a42cef6d2c">RO_RUNNING</a>,          <span class="comment">/* read only when running */</span>
<a name="l00164"></a>00164      500,                    <span class="comment">/* poll for 500ms */</span>
<a name="l00165"></a>00165      0,                      <span class="comment">/* stop run after this event limit */</span>
<a name="l00166"></a>00166      0,                      <span class="comment">/* number of sub events */</span>
<a name="l00167"></a>00167      0,                      <span class="comment">/* don&apos;t log history */</span>
<a name="l00168"></a>00168      <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,},
<a name="l00169"></a>00169     <a class="code" href="fevmemodules_8c.html#a9c54bafa1af403e5e4737f9d8d5aba07">read_trigger_event</a>,      <span class="comment">/* readout routine */</span>
<a name="l00170"></a>00170     NULL, NULL,
<a name="l00171"></a>00171     trigger_bank_list,
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173    ,
<a name="l00174"></a>00174 
<a name="l00175"></a>00175    {<span class="stringliteral">&quot;Scaler&quot;</span>,                <span class="comment">/* equipment name */</span>
<a name="l00176"></a>00176     {2, 0,                   <span class="comment">/* event ID, trigger mask */</span>
<a name="l00177"></a>00177      <span class="stringliteral">&quot;SYSTEM&quot;</span>,               <span class="comment">/* event buffer */</span>
<a name="l00178"></a>00178      <a class="code" href="group__mdefineh.html#ga58e919e4e401b299c1834be965c3e78c">EQ_PERIODIC</a> ,           <span class="comment">/* equipment type */</span>
<a name="l00179"></a>00179      0,                      <span class="comment">/* event source */</span>
<a name="l00180"></a>00180      <span class="stringliteral">&quot;MIDAS&quot;</span>,                <span class="comment">/* format */</span>
<a name="l00181"></a>00181      FALSE,                   <span class="comment">/* enabled */</span>
<a name="l00182"></a>00182      <a class="code" href="group__mdefineh.html#gafc5ef41cae398b8500f9c3a42cef6d2c">RO_RUNNING</a> | <a class="code" href="group__mdefineh.html#gadcbbd9e66d9455950d508d10b32b1f74">RO_TRANSITIONS</a> |   <span class="comment">/* read when running and on transitions */</span>
<a name="l00183"></a>00183      <a class="code" href="group__mdefineh.html#ga2de85e3b635c54456698533ebfc5635d">RO_ODB</a>,                 <span class="comment">/* and update ODB */</span>
<a name="l00184"></a>00184      10000,                  <span class="comment">/* read every 10 sec */</span>
<a name="l00185"></a>00185      0,                      <span class="comment">/* stop run after this event limit */</span>
<a name="l00186"></a>00186      0,                      <span class="comment">/* number of sub events */</span>
<a name="l00187"></a>00187      0,                      <span class="comment">/* log history */</span>
<a name="l00188"></a>00188      <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,},
<a name="l00189"></a>00189     <a class="code" href="fevmemodules_8c.html#af3ad062393c1437922bae26841d8927c">read_scaler_event</a>,       <span class="comment">/* readout routine */</span>
<a name="l00190"></a>00190     },
<a name="l00191"></a>00191 
<a name="l00192"></a>00192    {<span class="stringliteral">&quot;&quot;</span>}
<a name="l00193"></a>00193 };
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>}
<a name="l00197"></a>00197 <span class="preprocessor">#endif</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>
<a name="l00199"></a>00199 <span class="comment">/********************************************************************\</span>
<a name="l00200"></a>00200 <span class="comment">              Callback routines for system transitions</span>
<a name="l00201"></a>00201 <span class="comment"></span>
<a name="l00202"></a>00202 <span class="comment">  These routines are called whenever a system transition like start/</span>
<a name="l00203"></a>00203 <span class="comment">  stop of a run occurs. The routines are called on the following</span>
<a name="l00204"></a>00204 <span class="comment">  occations:</span>
<a name="l00205"></a>00205 <span class="comment"></span>
<a name="l00206"></a>00206 <span class="comment">  frontend_init:  When the frontend program is started. This routine</span>
<a name="l00207"></a>00207 <span class="comment">                  should initialize the hardware.</span>
<a name="l00208"></a>00208 <span class="comment"></span>
<a name="l00209"></a>00209 <span class="comment">  frontend_exit:  When the frontend program is shut down. Can be used</span>
<a name="l00210"></a>00210 <span class="comment">                  to releas any locked resources like memory, commu-</span>
<a name="l00211"></a>00211 <span class="comment">                  nications ports etc.</span>
<a name="l00212"></a>00212 <span class="comment"></span>
<a name="l00213"></a>00213 <span class="comment">  begin_of_run:   When a new run is started. Clear scalers, open</span>
<a name="l00214"></a>00214 <span class="comment">                  rungates, etc.</span>
<a name="l00215"></a>00215 <span class="comment"></span>
<a name="l00216"></a>00216 <span class="comment">  end_of_run:     Called on a request to stop a run. Can send</span>
<a name="l00217"></a>00217 <span class="comment">                  end-of-run event and close run gates.</span>
<a name="l00218"></a>00218 <span class="comment"></span>
<a name="l00219"></a>00219 <span class="comment">  pause_run:      When a run is paused. Should disable trigger events.</span>
<a name="l00220"></a>00220 <span class="comment"></span>
<a name="l00221"></a>00221 <span class="comment">  resume_run:     When a run is resumed. Should enable trigger events.</span>
<a name="l00222"></a>00222 <span class="comment">\********************************************************************/</span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">/********************************************************************/</span>
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">/*-- Sequencer callback info  --------------------------------------*/</span>
<a name="l00227"></a><a class="code" href="fevmemodules_8c.html#a0dc058822b97bbd8a5f918f0213e4a9e">00227</a> <span class="keywordtype">void</span> <a class="code" href="fevmemodules_8c.html#a0dc058822b97bbd8a5f918f0213e4a9e">seq_callback</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> hseq, <span class="keywordtype">void</span> *info)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229   printf(<span class="stringliteral">&quot;odb ... trigger settings touched\n&quot;</span>);
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment">/*-- Frontend Init -------------------------------------------------*/</span>
<a name="l00233"></a><a class="code" href="fevmemodules_8c.html#a34c51ae8c88f4717087b0604975516f4">00233</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a802849119d469feb2d1deee1be9593ac">frontend_init</a>()
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   <span class="keywordtype">int</span> size, status;
<a name="l00236"></a>00236   <span class="keywordtype">char</span> set_str[80];
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <span class="comment">/* Book Setting space */</span>
<a name="l00239"></a>00239   <a class="code" href="experim_8h.html#aba8c5b4adf8180aae43451def4ed3c0c">TRIGGER_SETTINGS_STR</a>(trigger_settings_str);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="comment">/* Map /equipment/Trigger/settings for the sequencer */</span>
<a name="l00242"></a>00242   sprintf(set_str, <span class="stringliteral">&quot;/Equipment/Trigger/Settings&quot;</span>);
<a name="l00243"></a>00243   status = <a class="code" href="group__odbfunctionc.html#ga59b971e77416b2b463e2e63f1b05342b">db_create_record</a>(<a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, set_str, strcomb(trigger_settings_str));
<a name="l00244"></a>00244   status = <a class="code" href="group__odbfunctionc.html#ga321df44195a9cbc83dbf10e32e32fd5b">db_find_key</a> (<a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, set_str, &amp;<a class="code" href="fevmemodules_8c.html#a24a9e510d792776924958328f8220d75">hSet</a>);
<a name="l00245"></a>00245   <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00246"></a>00246     <a class="code" href="group__msgfunctionc.html#gaac032ca2438c47466bfc9722de6746ea">cm_msg</a>(<a class="code" href="group__mdefineh.html#ga6e27d8876a43afce3ee4dd16527cbb9e">MINFO</a>,<span class="stringliteral">&quot;FE&quot;</span>,<span class="stringliteral">&quot;Key %s not found&quot;</span>, set_str);
<a name="l00247"></a>00247   
<a name="l00248"></a>00248   <span class="comment">/* Enable hot-link on settings/ of the equipment */</span>
<a name="l00249"></a>00249   size = <span class="keyword">sizeof</span>(<a class="code" href="structTRIGGER__SETTINGS.html">TRIGGER_SETTINGS</a>);
<a name="l00250"></a>00250   <span class="keywordflow">if</span> ((status = <a class="code" href="group__odbfunctionc.html#ga852bc9fa8ee4d0884b328aeb0b0cfd63">db_open_record</a>(<a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="code" href="fevmemodules_8c.html#a24a9e510d792776924958328f8220d75">hSet</a>, &amp;<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>, size, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>
<a name="l00251"></a>00251                                , <a class="code" href="fevmemodules_8c.html#a0dc058822b97bbd8a5f918f0213e4a9e">seq_callback</a>, NULL)) != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00252"></a>00252     <span class="keywordflow">return</span> status;
<a name="l00253"></a>00253   
<a name="l00254"></a>00254   <span class="comment">// Open VME interface   </span>
<a name="l00255"></a>00255   status = <a class="code" href="group__mvmestdfunctionh.html#ga13db7fc7c7c022e46fadd8fc4dc40047">mvme_open</a>(&amp;<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, 0);
<a name="l00256"></a>00256   
<a name="l00257"></a>00257   <span class="comment">// Set am to A24 non-privileged Data</span>
<a name="l00258"></a>00258   <a class="code" href="group__mvmestdfunctionh.html#gaf1529ef7e75316beebc1672840217bd0">mvme_set_am</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga803ae58eabffb7258a6b07843c6c2523">MVME_AM_A24_ND</a>);
<a name="l00259"></a>00259   
<a name="l00260"></a>00260   <span class="comment">// Set dmode to D32</span>
<a name="l00261"></a>00261   <a class="code" href="group__mvmestdfunctionh.html#gaaed1e33d2affe73c5afea1ce30b6c25b">mvme_set_dmode</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga1106eeff8cdbd2cfb5516f7feea8c1ff">MVME_DMODE_D32</a>);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="preprocessor">#if defined V1729_CODE</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span>  <span class="comment">// Collect Pedestals</span>
<a name="l00265"></a>00265   <a class="code" href="v1729_8c.html#a135c3c66398c94b6bee6cccad799cfec">v1729_PedestalRun</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, 10, 1);
<a name="l00266"></a>00266   
<a name="l00267"></a>00267   <span class="comment">// Do vernier calibration</span>
<a name="l00268"></a>00268   <a class="code" href="v1729_8c.html#a6a5b223f30c983b7f4dcac408d3f8b9f">v1729_TimeCalibrationRun</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, 1);
<a name="l00269"></a>00269 <span class="preprocessor">#endif</span>
<a name="l00270"></a>00270 <span class="preprocessor"></span>
<a name="l00271"></a>00271   <span class="comment">/* print message and return FE_ERR_HW if frontend should not be started */</span>
<a name="l00272"></a>00272   
<a name="l00273"></a>00273   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="comment">/*-- Frontend Exit -------------------------------------------------*/</span>
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="fevmemodules_8c.html#a15271255cca6c92978b28afd5a548382">00278</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a3b682405038cc4f6af505d7ca6367a4f">frontend_exit</a>()
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280    <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">/*-- Begin of Run --------------------------------------------------*/</span>
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="fevmemodules_8c.html#ad8bfe703c49342b9f0275aba77dc7758">00285</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ad8bfe703c49342b9f0275aba77dc7758">begin_of_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error)
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287   <span class="keywordtype">int</span> i, csr, status, size;
<a name="l00288"></a>00288    <span class="comment">/* put here clear scalers etc. */</span>
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <span class="comment">/* read Triggger settings */</span>
<a name="l00291"></a>00291   size = <span class="keyword">sizeof</span>(<a class="code" href="structTRIGGER__SETTINGS.html">TRIGGER_SETTINGS</a>);
<a name="l00292"></a>00292   <span class="keywordflow">if</span> ((status = <a class="code" href="group__odbfunctionc.html#ga7a9c0dd3e4bec48a07be99d2fc0e08cf">db_get_record</a> (<a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="code" href="fevmemodules_8c.html#a24a9e510d792776924958328f8220d75">hSet</a>, &amp;<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>, &amp;size, 0)) != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00293"></a>00293     <span class="keywordflow">return</span> status;
<a name="l00294"></a>00294 
<a name="l00295"></a>00295   <span class="comment">// Set am to A24 non-privileged Data</span>
<a name="l00296"></a>00296   <a class="code" href="group__mvmestdfunctionh.html#gaf1529ef7e75316beebc1672840217bd0">mvme_set_am</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga803ae58eabffb7258a6b07843c6c2523">MVME_AM_A24_ND</a>);
<a name="l00297"></a>00297   
<a name="l00298"></a>00298   <span class="comment">// Set dmode to D32</span>
<a name="l00299"></a>00299   <a class="code" href="group__mvmestdfunctionh.html#gaaed1e33d2affe73c5afea1ce30b6c25b">mvme_set_dmode</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga1106eeff8cdbd2cfb5516f7feea8c1ff">MVME_DMODE_D32</a>);
<a name="l00300"></a>00300   
<a name="l00301"></a>00301 <span class="preprocessor">#if defined VTDC0_CODE</span>
<a name="l00302"></a>00302 <span class="preprocessor"></span>  <span class="comment">//-------- TDCs -------------------------------------------</span>
<a name="l00303"></a>00303   <span class="comment">// Check the TDC</span>
<a name="l00304"></a>00304   csr = <a class="code" href="group__mvmestdfunctionh.html#ga5cab05257f96039738eec34ec330e0d8">mvme_read_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>+<a class="code" href="v1190B_8h.html#aa40d97048826c28a4f94b4bd676bbbea">V1190_FIRM_REV_RO</a>);
<a name="l00305"></a>00305   printf(<span class="stringliteral">&quot;Firmware revision: 0x%x\n&quot;</span>, csr);
<a name="l00306"></a>00306   
<a name="l00307"></a>00307   <span class="comment">// Set mode 1</span>
<a name="l00308"></a>00308   <a class="code" href="v1190B_8c.html#a08c507c60af774a2828a1e0ff6eac4c2">v1190_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>, 1);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310   <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1190.leresolution == 100)
<a name="l00311"></a>00311     temp = <a class="code" href="v1190B_8h.html#a6b124d6638860913a000ec71a10412f0">LE_RESOLUTION_100</a>;
<a name="l00312"></a>00312   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1190.leresolution == 200)
<a name="l00313"></a>00313     temp = <a class="code" href="v1190B_8h.html#ac6023e0596d452026a97581eae04bf1b">LE_RESOLUTION_200</a>;
<a name="l00314"></a>00314   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1190.leresolution == 800)
<a name="l00315"></a>00315     temp = <a class="code" href="v1190B_8h.html#af203e58693ac94231188c6ac4d28723c">LE_RESOLUTION_800</a>;
<a name="l00316"></a>00316   <span class="keywordflow">else</span>
<a name="l00317"></a>00317     temp = 3;
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (temp != 2)
<a name="l00319"></a>00319     <a class="code" href="v1190B_8c.html#a1d56cae6f08c550adf87b649c548e5aa">v1190_LEResolutionSet</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>, temp);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321   <span class="comment">// Adjust window width to 10us </span>
<a name="l00322"></a>00322   <span class="comment">// 10us == 0x18F</span>
<a name="l00323"></a>00323   temp = (<a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>) <a class="code" href="hv_8c.html#a6a010865b10e541735fa2da8f3cd062d">abs</a>(<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1190.windowwidth / 25e-9);
<a name="l00324"></a>00324   <a class="code" href="v1190B_8c.html#af9175bc6e8cd2dc1c63dbd69d974f8a1">v1190_WidthSet</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>, temp);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326   <span class="comment">// Adjust offset width to 10us </span>
<a name="l00327"></a>00327   <span class="comment">// 10us == 0xE70</span>
<a name="l00328"></a>00328   temp = <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1190.windowoffset / 25e-9;
<a name="l00329"></a>00329   temp = temp &lt; 0 ? ((<a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>)temp&amp;0xFFF): (<a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>) temp;
<a name="l00330"></a>00330   <a class="code" href="v1190B_8c.html#a47b04f666b0640f4ec4b5b03a78bcff5">v1190_OffsetSet</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>, temp);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332   <span class="comment">// Print Current status </span>
<a name="l00333"></a>00333   printf(<span class="stringliteral">&quot;BOR : FELIXE V1190B settings\n&quot;</span>);
<a name="l00334"></a>00334   <a class="code" href="v1190B_8c.html#a620a197083a0d776491f7bd620e2effd">v1190_Status</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>);
<a name="l00335"></a>00335 <span class="preprocessor">#endif</span>
<a name="l00336"></a>00336 <span class="preprocessor"></span>
<a name="l00337"></a>00337 <span class="preprocessor">#if defined V792_CODE</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span>  <span class="comment">//-------- ADCs ------------------------------------------</span>
<a name="l00339"></a>00339   printf(<span class="stringliteral">&quot;ADC0\n&quot;</span>);
<a name="l00340"></a>00340   <a class="code" href="v792_8c.html#ab1fa02b31b58838414803d8d750dbaa3">v792_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>, 2);
<a name="l00341"></a>00341   printf(<span class="stringliteral">&quot;ADC1\n&quot;</span>);
<a name="l00342"></a>00342   <a class="code" href="v792_8c.html#ab1fa02b31b58838414803d8d750dbaa3">v792_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a>, 2);
<a name="l00343"></a>00343   printf(<span class="stringliteral">&quot;ADC2\n&quot;</span>);
<a name="l00344"></a>00344   <a class="code" href="v792_8c.html#ab1fa02b31b58838414803d8d750dbaa3">v792_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a>, 2);
<a name="l00345"></a>00345   printf(<span class="stringliteral">&quot;ADC3\n&quot;</span>);
<a name="l00346"></a>00346   <a class="code" href="v792_8c.html#ab1fa02b31b58838414803d8d750dbaa3">v792_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a>, 2);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348   <span class="comment">/* Initialize the V792s ADC0 --*/</span>
<a name="l00349"></a>00349   <span class="comment">/* Load Threshold */</span>
<a name="l00350"></a>00350   <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="v792_8h.html#a7d8310a20d773e8c3de4549c81a5c7ae">V792_MAX_CHANNELS</a>;i+=2) {
<a name="l00351"></a>00351     printf(<span class="stringliteral">&quot;B Threshold[%i] = 0x%4.4x\t   -  &quot;</span>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.threshold1[i]);
<a name="l00352"></a>00352     printf(<span class="stringliteral">&quot;Threshold[%i] = 0x%4.4x\n&quot;</span>, i+1, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.threshold1[i+1]);
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354   <a class="code" href="v792_8c.html#a3eec625d3dca654c6f99f82d964d4287">v792_ThresholdWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>, (<a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> *)&amp;(<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.threshold1));
<a name="l00355"></a>00355   
<a name="l00356"></a>00356   <span class="keywordflow">for</span> (i=0;i&lt;V792_MAX_CHANNELS;i+=2) {
<a name="l00357"></a>00357     printf(<span class="stringliteral">&quot;Threshold[%i] = 0x%4.4x\t   -  &quot;</span>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.threshold1[i]);
<a name="l00358"></a>00358     printf(<span class="stringliteral">&quot;Threshold[%i] = 0x%4.4x\n&quot;</span>, i+1, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.threshold1[i+1]);
<a name="l00359"></a>00359   }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <a class="code" href="v792_8c.html#a526dbfe955e68a6e982bb5a3345b74e3">v792_DataClear</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>);
<a name="l00362"></a>00362   csr = <a class="code" href="v792_8c.html#a01124a009c024fb70d7243658facd6b9">v792_CSR1Read</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>);
<a name="l00363"></a>00363   printf(<span class="stringliteral">&quot;Data Ready ADC0: 0x%x\n&quot;</span>, csr);
<a name="l00364"></a>00364   
<a name="l00365"></a>00365   <span class="comment">/* Initialize the V792s ADC1 --*/</span>
<a name="l00366"></a>00366   <span class="comment">/* Load Threshold */</span>
<a name="l00367"></a>00367   <a class="code" href="v792_8c.html#a3eec625d3dca654c6f99f82d964d4287">v792_ThresholdWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a>, (<a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> *)&amp;(<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.thresholds2));
<a name="l00368"></a>00368   <a class="code" href="v792_8c.html#a526dbfe955e68a6e982bb5a3345b74e3">v792_DataClear</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a>);
<a name="l00369"></a>00369   csr = <a class="code" href="v792_8c.html#a01124a009c024fb70d7243658facd6b9">v792_CSR1Read</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a>);
<a name="l00370"></a>00370   printf(<span class="stringliteral">&quot;Data Ready ADC1: 0x%x\n&quot;</span>, csr);
<a name="l00371"></a>00371   
<a name="l00372"></a>00372   <span class="comment">/* Initialize the V792s ADC2 --*/</span>
<a name="l00373"></a>00373   <span class="comment">/* Load Threshold */</span>
<a name="l00374"></a>00374   <a class="code" href="v792_8c.html#a3eec625d3dca654c6f99f82d964d4287">v792_ThresholdWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a>, (<a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> *)&amp;(<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.thresholds3));
<a name="l00375"></a>00375   <a class="code" href="v792_8c.html#a526dbfe955e68a6e982bb5a3345b74e3">v792_DataClear</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a>);
<a name="l00376"></a>00376   csr = <a class="code" href="v792_8c.html#a01124a009c024fb70d7243658facd6b9">v792_CSR1Read</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a>);
<a name="l00377"></a>00377   printf(<span class="stringliteral">&quot;Data Ready ADC2: 0x%x\n&quot;</span>, csr);
<a name="l00378"></a>00378   
<a name="l00379"></a>00379   <span class="comment">/* Initialize the V792s ADC3 --*/</span>
<a name="l00380"></a>00380   <span class="comment">/* Load Threshold */</span>
<a name="l00381"></a>00381   <a class="code" href="v792_8c.html#a3eec625d3dca654c6f99f82d964d4287">v792_ThresholdWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a>, (<a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> *)&amp;(<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v792.thresold4));
<a name="l00382"></a>00382   <a class="code" href="v792_8c.html#a526dbfe955e68a6e982bb5a3345b74e3">v792_DataClear</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a>);
<a name="l00383"></a>00383   csr = <a class="code" href="v792_8c.html#a01124a009c024fb70d7243658facd6b9">v792_CSR1Read</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a>);
<a name="l00384"></a>00384   printf(<span class="stringliteral">&quot;Data Ready ADC3: 0x%x\n&quot;</span>, csr);
<a name="l00385"></a>00385 <span class="preprocessor">#endif</span>
<a name="l00386"></a>00386 <span class="preprocessor"></span>
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="preprocessor">#if defined V1729_CODE</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span>  <span class="comment">//-------- 1/2 Gsps ADC (CAEN) -------------------------------------</span>
<a name="l00390"></a>00390   <span class="comment">// Set mode 3 (128 full range)</span>
<a name="l00391"></a>00391   <a class="code" href="v1729_8c.html#a16a8a323c157ed043a86ac69a6ada37d">v1729_Setup</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, 3);
<a name="l00392"></a>00392   <a class="code" href="v1729_8c.html#a0c3ea27e8238bd1aa89966c08339681d">v1729_PostTrigSet</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.v1729.post_trigger);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394   <span class="comment">// Print Current status</span>
<a name="l00395"></a>00395   <a class="code" href="v1729_8c.html#a6025f9ff1237562264e91f22ca834fb7">v1729_Status</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>);
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="comment">// Start acquisition</span>
<a name="l00398"></a>00398   <a class="code" href="v1729_8c.html#ada0344e2f7a00d26cc500f480fb47e4c">v1729_AcqStart</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>);
<a name="l00399"></a>00399 <span class="preprocessor">#endif</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>
<a name="l00401"></a>00401 <span class="preprocessor">#if defined VF48_CODE</span>
<a name="l00402"></a>00402 <span class="preprocessor"></span>  <span class="comment">//-------- 20..65 Msps ADC (Uni Montreal) -------------------------</span>
<a name="l00403"></a>00403   <span class="comment">/* Initialize the VF48 --*/</span>
<a name="l00404"></a>00404   vf48_Reset(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   <span class="comment">// Stop DAQ for seting up the parameters</span>
<a name="l00407"></a>00407   vf48_AcqStop(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00408"></a>00408     
<a name="l00409"></a>00409   <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.external_trigger) {
<a name="l00410"></a>00410     vf48_ExtTrgSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00411"></a>00411     printf(<span class="stringliteral">&quot;vf48: External trigger mode\n&quot;</span>);
<a name="l00412"></a>00412   } <span class="keywordflow">else</span> {
<a name="l00413"></a>00413     vf48_ExtTrgClr(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00414"></a>00414     printf(<span class="stringliteral">&quot;vf48: Self triggering mode\n&quot;</span>);
<a name="l00415"></a>00415   }
<a name="l00416"></a>00416   csr = vf48_CsrRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00417"></a>00417   printf(<span class="stringliteral">&quot;CSR Buffer: 0x%x\n&quot;</span>, csr);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="comment">// Segment Size</span>
<a name="l00420"></a>00420   vf48_SegmentSizeSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.segment_size);
<a name="l00421"></a>00421     <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00422"></a>00422       printf(<span class="stringliteral">&quot;vf48: SegSize grp (%d) %i:%d\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.segment_size
<a name="l00423"></a>00423              , i, vf48_SegmentSizeRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="comment">// Set Threshold high for external trigger, as the </span>
<a name="l00427"></a>00427   <span class="comment">// the self-trigger is always sending info to the collector </span>
<a name="l00428"></a>00428   <span class="comment">// and overwhelming the link. (max maybe 10 bits (0x3FF))</span>
<a name="l00429"></a>00429   <span class="comment">// Threshold</span>
<a name="l00430"></a>00430   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00431"></a>00431     vf48_TrgThresholdSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.trigger_threshold);
<a name="l00432"></a>00432       printf(<span class="stringliteral">&quot;vf48: Trigger Threshold grp (%d) %i:%d\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.trigger_threshold
<a name="l00433"></a>00433              , i, vf48_TrgThresholdRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00434"></a>00434   }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="comment">// Set Threshold high for Hit detection</span>
<a name="l00437"></a>00437   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00438"></a>00438     vf48_HitThresholdSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.hit_threshold);
<a name="l00439"></a>00439       printf(<span class="stringliteral">&quot;vf48: Hit Threshold grp (%d) %i:%d\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.hit_threshold
<a name="l00440"></a>00440              , i, vf48_HitThresholdRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   <span class="comment">// Active Channel Mask</span>
<a name="l00444"></a>00444   <span class="keywordflow">for</span> (i=0;i&lt;6;i++){
<a name="l00445"></a>00445     vf48_ActiveChMaskSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.active_channel_mask);
<a name="l00446"></a>00446     printf(<span class="stringliteral">&quot;vf48: Active channel mask grp (%x) %i:0x%x\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.active_channel_mask
<a name="l00447"></a>00447            , i, vf48_ActiveChMaskRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00448"></a>00448   }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   <span class="comment">// Raw Data Suppression</span>
<a name="l00451"></a>00451   <span class="keywordflow">for</span> (i=0;i&lt;6;i++){
<a name="l00452"></a>00452     vf48_RawDataSuppSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.raw_data_suppress);
<a name="l00453"></a>00453     printf(<span class="stringliteral">&quot;vf48: Raw Data Suppress grp (%x) %i:0x%x\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.raw_data_suppress
<a name="l00454"></a>00454            , i, vf48_RawDataSuppRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00455"></a>00455   }
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   <span class="comment">// Channel Suppress Enable</span>
<a name="l00458"></a>00458   <span class="keywordflow">for</span> (i=0;i&lt;6;i++){
<a name="l00459"></a>00459     vf48_ChSuppSet(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.channel_suppress_enable);
<a name="l00460"></a>00460     printf(<span class="stringliteral">&quot;vf48: Channel Suppression Enable grp (%x) %i:0x%x\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.channel_suppress_enable
<a name="l00461"></a>00461            , i, 0x1 &amp; vf48_ChSuppRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00462"></a>00462   }
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <span class="comment">// Divisor</span>
<a name="l00465"></a>00465   vf48_DivisorWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.divisor);
<a name="l00466"></a>00466   <span class="keywordflow">for</span> (i=0;i&lt;6;i++){
<a name="l00467"></a>00467     printf(<span class="stringliteral">&quot;vf48: Divisor grp (%x) %i:0x%x\n&quot;</span>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.divisor
<a name="l00468"></a>00468            , i, vf48_DivisorRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i));
<a name="l00469"></a>00469   }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   <span class="comment">// PreTrigger</span>
<a name="l00472"></a>00472   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00473"></a>00473     vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_PRE_TRIGGER, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.pretrigger);
<a name="l00474"></a>00474     printf(<span class="stringliteral">&quot;vf48: Pre Trigger grp %i:%d\n&quot;</span>
<a name="l00475"></a>00475            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_PRE_TRIGGER));
<a name="l00476"></a>00476   }
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="comment">// Latency</span>
<a name="l00479"></a>00479   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00480"></a>00480     vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_LATENCY, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.latency);
<a name="l00481"></a>00481     printf(<span class="stringliteral">&quot;vf48: Latency grp %i:%d\n&quot;</span>
<a name="l00482"></a>00482            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_LATENCY));
<a name="l00483"></a>00483   }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485   <span class="comment">// K-coef</span>
<a name="l00486"></a>00486   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00487"></a>00487     vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_K_COEF, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.k_coeff);
<a name="l00488"></a>00488     printf(<span class="stringliteral">&quot;vf48: K-coeff grp %i:%d\n&quot;</span>
<a name="l00489"></a>00489            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_K_COEF));
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491   <span class="comment">// L-coef</span>
<a name="l00492"></a>00492   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00493"></a>00493     vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_L_COEF, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.l_coeff);
<a name="l00494"></a>00494     printf(<span class="stringliteral">&quot;vf48: L-coeff grp %i:%d\n&quot;</span>
<a name="l00495"></a>00495            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_L_COEF));
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497   <span class="comment">// M-coef</span>
<a name="l00498"></a>00498   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00499"></a>00499     vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_M_COEF, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.m_coeff);
<a name="l00500"></a>00500     printf(<span class="stringliteral">&quot;vf48: M-coeff grp %i:%d\n&quot;</span>
<a name="l00501"></a>00501            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_M_COEF));
<a name="l00502"></a>00502   }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="comment">// Polarity</span>
<a name="l00505"></a>00505   <span class="keywordflow">for</span> (i=0;i&lt;6;i++) {
<a name="l00506"></a>00506     <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> pat;
<a name="l00507"></a>00507     <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.inverse_signal){
<a name="l00508"></a>00508       pat = vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_MBIT1);
<a name="l00509"></a>00509       pat |= VF48_INVERSE_SIGNAL;
<a name="l00510"></a>00510       vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_MBIT1, pat);
<a name="l00511"></a>00511     } <span class="keywordflow">else</span> {
<a name="l00512"></a>00512       pat = vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_MBIT1);
<a name="l00513"></a>00513       pat &amp;= ~(VF48_INVERSE_SIGNAL);
<a name="l00514"></a>00514       vf48_ParameterWrite(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_MBIT1, pat);
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516     printf(<span class="stringliteral">&quot;vf48: Polarity grp %i:%d\n&quot;</span>
<a name="l00517"></a>00517            , i, vf48_ParameterRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, i, VF48_MBIT1));
<a name="l00518"></a>00518   }
<a name="l00519"></a>00519   
<a name="l00520"></a>00520   <span class="comment">// Group Enable</span>
<a name="l00521"></a>00521   vf48_GrpEnable(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, <a class="code" href="fevmemodules_8c.html#a8d1988d3d35f995fe7cb2e1095e59136">ts</a>.vf48.group_bitwise_all_0x3f_);
<a name="l00522"></a>00522   printf(<span class="stringliteral">&quot;vf48: Group Enable :0x%x\n&quot;</span>, vf48_GrpRead(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>));
<a name="l00523"></a>00523 
<a name="l00524"></a>00524   <span class="comment">// Start ACQ for VF48</span>
<a name="l00525"></a>00525   vf48_AcqStart(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00526"></a>00526 <span class="preprocessor">#endif</span>
<a name="l00527"></a>00527 <span class="preprocessor"></span>
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="preprocessor">#if defined VMEIO_CODE</span>
<a name="l00530"></a>00530 <span class="preprocessor"></span>  <span class="comment">//-------- VMEIO (triumf board) ----------------------------------</span>
<a name="l00531"></a>00531   <span class="comment">// Set am to A24 non-privileged Data</span>
<a name="l00532"></a>00532   <a class="code" href="group__mvmestdfunctionh.html#gaf1529ef7e75316beebc1672840217bd0">mvme_set_am</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga803ae58eabffb7258a6b07843c6c2523">MVME_AM_A24_ND</a>);
<a name="l00533"></a>00533 
<a name="l00534"></a>00534   <span class="comment">// Set dmode to D32</span>
<a name="l00535"></a>00535   <a class="code" href="group__mvmestdfunctionh.html#gaaed1e33d2affe73c5afea1ce30b6c25b">mvme_set_dmode</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga1106eeff8cdbd2cfb5516f7feea8c1ff">MVME_DMODE_D32</a>);
<a name="l00536"></a>00536 
<a name="l00537"></a>00537   <span class="comment">// Set pulse mode</span>
<a name="l00538"></a>00538   <a class="code" href="vmeio_8c.html#a411b07826fc5b2a611b6f4f9b8e4cc9d">vmeio_OutputSet</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>, (<a class="code" href="fevmemodules_8c.html#ad6c3e6f40d580b713afb1d8f4fe92dd7">P_BOE</a>|<a class="code" href="fevmemodules_8c.html#a93d7238f44b662d68192a2091933821e">P_EOE</a>|<a class="code" href="fevmemodules_8c.html#ae4e1fdc925f086a479d7e889dbfaaf9e">P_CLR</a>));
<a name="l00539"></a>00539 <span class="preprocessor">#endif</span>
<a name="l00540"></a>00540 <span class="preprocessor"></span>
<a name="l00541"></a>00541   <span class="comment">//------ FINAL ACTIONS before BOR -----------</span>
<a name="l00542"></a>00542   <span class="comment">// Send Clear pulse </span>
<a name="l00543"></a>00543   <span class="comment">//  vmeio_SyncWrite(myvme, VMEIO_BASE, P_CLR);</span>
<a name="l00544"></a>00544 
<a name="l00545"></a>00545   <span class="comment">/* Reset Latch */</span>
<a name="l00546"></a>00546 
<a name="l00547"></a>00547   <span class="comment">/********* commented out for other test purpose</span>
<a name="l00548"></a>00548 <span class="comment">  vmeio_SyncWrite(myvme, VMEIO_BASE, P_EOE);</span>
<a name="l00549"></a>00549 <span class="comment">  </span>
<a name="l00550"></a>00550 <span class="comment">  // Open run gate</span>
<a name="l00551"></a>00551 <span class="comment">  vmeio_AsyncWrite(myvme, VMEIO_BASE, S_RUNGATE);</span>
<a name="l00552"></a>00552 <span class="comment">  </span>
<a name="l00553"></a>00553 <span class="comment">  // Disable interrupt</span>
<a name="l00554"></a>00554 <span class="comment">  mvme_write_value(myvme, VLAM_BASE+4, 0x0);</span>
<a name="l00555"></a>00555 <span class="comment">  </span>
<a name="l00556"></a>00556 <span class="comment">  // Reset Latch</span>
<a name="l00557"></a>00557 <span class="comment">  mvme_write_value(myvme, VLAM_BASE, 0x1);</span>
<a name="l00558"></a>00558 <span class="comment">  </span>
<a name="l00559"></a>00559 <span class="comment">  // Clear pending interrupts</span>
<a name="l00560"></a>00560 <span class="comment">  mvme_write_value(myvme, VLAM_BASE+8, 0x0);</span>
<a name="l00561"></a>00561 <span class="comment">  //  printf(&quot;Vector:0x%lx\n&quot;, (mvme_read_value(myvme, VLAM_BASE+0x8) &amp; 0xFF));</span>
<a name="l00562"></a>00562 <span class="comment">  </span>
<a name="l00563"></a>00563 <span class="comment">  // Enable interrupt</span>
<a name="l00564"></a>00564 <span class="comment">  inRun = 1;</span>
<a name="l00565"></a>00565 <span class="comment">  mvme_write_value(myvme, VLAM_BASE+4, inRun);</span>
<a name="l00566"></a>00566 <span class="comment">  */</span>
<a name="l00567"></a>00567   
<a name="l00568"></a>00568   <a class="code" href="fevmemodules_8c.html#a6cde1377f6c51796f78ef647404f396a">missed</a> = 0; <span class="comment">// for the v1729 missed trigger</span>
<a name="l00569"></a>00569   printf(<span class="stringliteral">&quot;End of BOR\n&quot;</span>);
<a name="l00570"></a>00570   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="comment">/*-- End of Run ----------------------------------------------------*/</span>
<a name="l00574"></a><a class="code" href="fevmemodules_8c.html#ae6d798649008b7523c77222bae2d4187">00574</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ae6d798649008b7523c77222bae2d4187">end_of_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error)
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576   <span class="comment">// Stop DAQ for seting up the parameters</span>
<a name="l00577"></a>00577   vf48_AcqStop(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>);
<a name="l00578"></a>00578     
<a name="l00579"></a>00579   <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> = 0;
<a name="l00580"></a>00580   <a class="code" href="fevmemodules_8c.html#a25a07c1f75f0b67144cbdc264ffdb09c">stop_req</a> = 0;
<a name="l00581"></a>00581   <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a> = 0;
<a name="l00582"></a>00582   <span class="comment">// Disable interrupt</span>
<a name="l00583"></a>00583   <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>);
<a name="l00584"></a>00584   <a class="code" href="fevmemodules_8c.html#ad8650f66958ab0805468d3ed83722cd6">trig_level</a> = 0;
<a name="l00585"></a>00585   <span class="comment">// Close run gate</span>
<a name="l00586"></a>00586   <a class="code" href="vmeio_8c.html#a55bfbc8acc81f96641ce87521deb9f53">vmeio_AsyncWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>, 0x0);
<a name="l00587"></a>00587   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 <span class="comment">/*-- Pause Run -----------------------------------------------------*/</span>
<a name="l00591"></a><a class="code" href="fevmemodules_8c.html#a164db20cf6c8c81e8c8ca50a590de436">00591</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a164db20cf6c8c81e8c8ca50a590de436">pause_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error)
<a name="l00592"></a>00592 {
<a name="l00593"></a>00593   <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a> = 0;
<a name="l00594"></a>00594   <span class="comment">// Disable interrupt</span>
<a name="l00595"></a>00595   <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>);
<a name="l00596"></a>00596   <a class="code" href="fevmemodules_8c.html#ad8650f66958ab0805468d3ed83722cd6">trig_level</a> = 0;
<a name="l00597"></a>00597   <span class="comment">// Close run gate</span>
<a name="l00598"></a>00598   <a class="code" href="vmeio_8c.html#a55bfbc8acc81f96641ce87521deb9f53">vmeio_AsyncWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>, 0x0);
<a name="l00599"></a>00599    
<a name="l00600"></a>00600   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 <span class="comment">/*-- Resume Run ----------------------------------------------------*/</span>
<a name="l00604"></a><a class="code" href="fevmemodules_8c.html#a6cada7e3f07b9fc2b9886263223661d4">00604</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a6cada7e3f07b9fc2b9886263223661d4">resume_run</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keywordtype">char</span> *error)
<a name="l00605"></a>00605 {
<a name="l00606"></a>00606   <a class="code" href="fevmemodules_8c.html#ad8650f66958ab0805468d3ed83722cd6">trig_level</a> = <a class="code" href="fevmemodules_8c.html#a90a84f3ea9d75594c6cde52a179b5e88">TRIG_LEVEL</a>;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608   <span class="comment">// EOB Pulse</span>
<a name="l00609"></a>00609   <a class="code" href="vmeio_8c.html#a703cba2e78c649e71061f29f56aea517">vmeio_SyncWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>, <a class="code" href="fevmemodules_8c.html#a93d7238f44b662d68192a2091933821e">P_EOE</a>);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   <span class="comment">// Open run gate</span>
<a name="l00612"></a>00612   <a class="code" href="vmeio_8c.html#a55bfbc8acc81f96641ce87521deb9f53">vmeio_AsyncWrite</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>, <a class="code" href="fevmemodules_8c.html#a1218cb0e8300322e213dcc9e94677c13">S_RUNGATE</a>);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614   <span class="comment">// Enable interrupt</span>
<a name="l00615"></a>00615   <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a> = 1;
<a name="l00616"></a>00616   <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>);
<a name="l00617"></a>00617   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="comment">/*-- Frontend Loop -------------------------------------------------*/</span>
<a name="l00621"></a><a class="code" href="fevmemodules_8c.html#ada66837c3c3d263974ad717921145e0a">00621</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#ad902740ed5577f2f940454359ec1df1c">frontend_loop</a>()
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623   <span class="comment">/* if frontend_call_loop is true, this routine gets called when</span>
<a name="l00624"></a>00624 <span class="comment">     the frontend is idle or once between every event */</span>
<a name="l00625"></a>00625   <span class="keywordtype">char</span> str[128];
<a name="l00626"></a>00626 
<a name="l00627"></a>00627   <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a25a07c1f75f0b67144cbdc264ffdb09c">stop_req</a> &amp;&amp; <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>==0) {
<a name="l00628"></a>00628     <a class="code" href="group__odbfunctionc.html#gaf0b052657ba1d4f4a8b6d47dbc70008c">db_set_value</a>(<a class="code" href="mfe_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>,0,<span class="stringliteral">&quot;/logger/channels/0/Settings/Event limit&quot;</span>, &amp;<a class="code" href="fevmemodules_8c.html#adb65a4e8d1413f7d40cc16e7118899ce">evlimit</a>, <span class="keyword">sizeof</span>(<a class="code" href="fevmemodules_8c.html#adb65a4e8d1413f7d40cc16e7118899ce">evlimit</a>), 1, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>); 
<a name="l00629"></a>00629     <span class="keywordflow">if</span> (<a class="code" href="group__cmfunctionc.html#ga376defd443d6bdfcca3830b99986a48d">cm_transition</a>(<a class="code" href="group__mdefineh.html#gadd7d0605113ff6e1b4e705d31332a1a0">TR_STOP</a>, 0, str, <span class="keyword">sizeof</span>(str), <a class="code" href="group__mdefineh.html#gad28b60868b6548c43e7a18f30c9b2022">ASYNC</a>, FALSE) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l00630"></a>00630       <a class="code" href="group__msgfunctionc.html#gaac032ca2438c47466bfc9722de6746ea">cm_msg</a>(<a class="code" href="group__mdefineh.html#gac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;VF48 Timeout&quot;</span>, <span class="stringliteral">&quot;cannot stop run: %s&quot;</span>, str);
<a name="l00631"></a>00631     }
<a name="l00632"></a>00632     <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a> = 0;
<a name="l00633"></a>00633     <span class="comment">// Disable interrupt</span>
<a name="l00634"></a>00634     <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, <a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>);
<a name="l00635"></a>00635     <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> = 1;
<a name="l00636"></a>00636     <a class="code" href="group__msgfunctionc.html#gaac032ca2438c47466bfc9722de6746ea">cm_msg</a>(<a class="code" href="group__mdefineh.html#gac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;VF48 Timeout&quot;</span>,<span class="stringliteral">&quot;VF48 Stop requested&quot;</span>);
<a name="l00637"></a>00637   }
<a name="l00638"></a>00638   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="comment">/*------------------------------------------------------------------*/</span>
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 <span class="comment">/********************************************************************\</span>
<a name="l00644"></a>00644 <span class="comment"></span>
<a name="l00645"></a>00645 <span class="comment">  Readout routines for different events</span>
<a name="l00646"></a>00646 <span class="comment"></span>
<a name="l00647"></a>00647 <span class="comment">\********************************************************************/</span>
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 <span class="comment">/*-- Trigger event routines ----------------------------------------*/</span>
<a name="l00650"></a><a class="code" href="fevmemodules_8c.html#a98cc3257284af91fa0e8da10ddf227c8">00650</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a98cc3257284af91fa0e8da10ddf227c8">poll_event</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> source, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> count, <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a> <a class="code" href="sis3803_8c.html#a8fa8e4c8bef10b038f6a033f736d5bce">test</a>)
<a name="l00651"></a>00651      <span class="comment">/* Polling routine for events. Returns TRUE if event</span>
<a name="l00652"></a>00652 <span class="comment">        is available. If test equals TRUE, don&apos;t return. The test</span>
<a name="l00653"></a>00653 <span class="comment">        flag is used to time the polling */</span>
<a name="l00654"></a>00654     <span class="comment">//    if (vmeio_CsrRead(myvme, VMEIO_BASE))</span>
<a name="l00655"></a>00655     <span class="comment">//    if (lam &gt; 10)</span>
<a name="l00656"></a>00656 {
<a name="l00657"></a>00657   <span class="keywordtype">int</span> i;
<a name="l00658"></a>00658   <span class="keywordtype">int</span> lam = 0;
<a name="l00659"></a>00659   
<a name="l00660"></a>00660   <span class="keywordflow">for</span> (i = 0; i &lt; count; i++, lam++) {
<a name="l00661"></a>00661     lam = <a class="code" href="vmeio_8c.html#af6e6d51d02e674a8a2f313c12bf98a1b">vmeio_CsrRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aa914897ada170e3d2b39940ef62467cf">VMEIO_BASE</a>);
<a name="l00662"></a>00662     <span class="keywordflow">if</span> (lam)
<a name="l00663"></a>00663       <span class="keywordflow">if</span> (!test)
<a name="l00664"></a>00664         <span class="keywordflow">return</span> lam;
<a name="l00665"></a>00665   }
<a name="l00666"></a>00666   
<a name="l00667"></a>00667   <span class="keywordflow">return</span> 0;
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="comment">/*-- Interrupt configuration ---------------------------------------*/</span>
<a name="l00671"></a><a class="code" href="fevmemodules_8c.html#a55dc1ffa15566edfd2ad2249aae97c77">00671</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="mfe_8c.html#a681a5d1fe2e8a4735bcf03824ffb3e81">interrupt_configure</a>(<a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> cmd, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> source, PTYPE adr)
<a name="l00672"></a>00672 {
<a name="l00673"></a>00673   <span class="keywordtype">int</span> vec = 0;
<a name="l00674"></a>00674   <span class="keywordflow">switch</span> (cmd) {
<a name="l00675"></a>00675   <span class="keywordflow">case</span> <a class="code" href="group__err26.html#gaab5043b2fd69a86d3bcecfb3fd8f7af3">CMD_INTERRUPT_ENABLE</a>:
<a name="l00676"></a>00676     <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>) <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, 0x1);
<a name="l00677"></a>00677     <span class="keywordflow">break</span>;
<a name="l00678"></a>00678   <span class="keywordflow">case</span> <a class="code" href="group__err26.html#gaa12884ae2e3cbffa489d7c5074a029f7">CMD_INTERRUPT_DISABLE</a>:
<a name="l00679"></a>00679     <span class="keywordflow">if</span> (<a class="code" href="fevmemodules_8c.html#a0f9c151f98b81e4a46f88f47a37cffb1">inRun</a>) <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+4, 0x0);
<a name="l00680"></a>00680     <span class="keywordflow">break</span>;
<a name="l00681"></a>00681   <span class="keywordflow">case</span> <a class="code" href="group__err26.html#ga8a891110d186a3a4b02f6dfde253efb2">CMD_INTERRUPT_ATTACH</a>:
<a name="l00682"></a>00682     <a class="code" href="group__mvmestdfunctionh.html#gaaed1e33d2affe73c5afea1ce30b6c25b">mvme_set_dmode</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="group__mvmestdinclude.html#ga1106eeff8cdbd2cfb5516f7feea8c1ff">MVME_DMODE_D32</a>);
<a name="l00683"></a>00683     <a class="code" href="group__mvmestdfunctionh.html#gae1e6cd30960647ba33cb1fc2e8d8cba8">mvme_interrupt_attach</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aed01298d37e73ed9737c8a6b70e67caa">INT_LEVEL</a>, <a class="code" href="fevmemodules_8c.html#aa992c6e0d30eebad60b642ec25681bcb">INT_VECTOR</a>, (<span class="keywordtype">void</span> *)adr, &amp;<a class="code" href="fevmemodules_8c.html#a078c7a09da85e54e060ec80b7f9e2649">myinfo</a>);
<a name="l00684"></a>00684     <a class="code" href="group__mvmestdfunctionh.html#ga901e510ac4c207e424e944ee92c5ea65">mvme_write_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+0x10, <a class="code" href="fevmemodules_8c.html#aa992c6e0d30eebad60b642ec25681bcb">INT_VECTOR</a>);
<a name="l00685"></a>00685     vec = <a class="code" href="group__mvmestdfunctionh.html#ga5cab05257f96039738eec34ec330e0d8">mvme_read_value</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#af9e70d396f8271dc89a6ca33f9b540bc">VLAM_BASE</a>+0x10);
<a name="l00686"></a>00686     printf(<span class="stringliteral">&quot;Interrupt Attached to 0x%x for vector:0x%x\n&quot;</span>, adr, vec&amp;0xFF);
<a name="l00687"></a>00687     <span class="keywordflow">break</span>;
<a name="l00688"></a>00688   <span class="keywordflow">case</span> <a class="code" href="group__err26.html#gae055008eb0238aaf491eda741abcd26d">CMD_INTERRUPT_DETACH</a>:
<a name="l00689"></a>00689     printf(<span class="stringliteral">&quot;Interrupt Detach\n&quot;</span>);
<a name="l00690"></a>00690     <span class="keywordflow">break</span>;
<a name="l00691"></a>00691   }
<a name="l00692"></a>00692   <span class="keywordflow">return</span> <a class="code" href="group__err21.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00693"></a>00693 }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="comment">/*-- Event readout -------------------------------------------------*/</span>
<a name="l00696"></a><a class="code" href="fevmemodules_8c.html#a8883ccfed3c0d566cf3e4cf5637fd70d">00696</a> <span class="keywordtype">int</span> <a class="code" href="fevmemodules_8c.html#a8883ccfed3c0d566cf3e4cf5637fd70d">vf48_error</a> = 0;
<a name="l00697"></a><a class="code" href="fevmemodules_8c.html#a9c54bafa1af403e5e4737f9d8d5aba07">00697</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="fevmemodules_8c.html#a9c54bafa1af403e5e4737f9d8d5aba07">read_trigger_event</a>(<span class="keywordtype">char</span> *pevent, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> off)
<a name="l00698"></a>00698 {
<a name="l00699"></a>00699 <span class="preprocessor">#if defined VADC0_CODE</span>
<a name="l00700"></a>00700 <span class="preprocessor"></span>  <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>  *pdata;
<a name="l00701"></a>00701 <span class="preprocessor">#endif</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span><span class="preprocessor">#if defined VTDC0_CODE</span>
<a name="l00703"></a>00703 <span class="preprocessor"></span>  <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>  *pdata;
<a name="l00704"></a>00704 <span class="preprocessor">#endif</span>
<a name="l00705"></a>00705 <span class="preprocessor"></span><span class="preprocessor">#if defined VF48_CODE</span>
<a name="l00706"></a>00706 <span class="preprocessor"></span>  <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>  *pdata;
<a name="l00707"></a>00707   <span class="keywordtype">int</span> status, evtlength;
<a name="l00708"></a>00708 <span class="preprocessor">#endif</span>
<a name="l00709"></a>00709 <span class="preprocessor"></span><span class="preprocessor">#if defined V1729_CODE</span>
<a name="l00710"></a>00710 <span class="preprocessor"></span>  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>   *pidata, timeout;
<a name="l00711"></a>00711   <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>   data[20000];
<a name="l00712"></a>00712   <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>    nch, npt, nentry;
<a name="l00713"></a>00713 <span class="preprocessor">#endif</span>
<a name="l00714"></a>00714 <span class="preprocessor"></span>
<a name="l00715"></a>00715   <a class="code" href="fevmemodules_8c.html#adb65a4e8d1413f7d40cc16e7118899ce">evlimit</a> = <a class="code" href="group__mbufferh.html#gadbb75a9d81e264e357bc5fc73dd4ebb8">SERIAL_NUMBER</a>(pevent);
<a name="l00716"></a>00716   <span class="comment">// Timing Begin of Event</span>
<a name="l00717"></a>00717   <span class="comment">//  vmeio_SyncWrite(myvme, VMEIO_BASE, P_BOE);</span>
<a name="l00718"></a>00718   <span class="comment">// Open READOUT State</span>
<a name="l00719"></a>00719   <span class="comment">//  vmeio_AsyncWrite(myvme, VMEIO_BASE, (S_READOUT|S_RUNGATE));</span>
<a name="l00720"></a>00720 
<a name="l00721"></a>00721   <span class="comment">// &gt; THE LINE BELOW SHOULD BE HERE AND NOWHERE ELSE &lt; !</span>
<a name="l00722"></a>00722   <a class="code" href="group__bkfunctionc.html#gae7cbf587db63fcdf66dd18b29f08b6d2">bk_init32</a>(pevent);
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="preprocessor">#if defined VADC0_CODE</span><span class="comment"></span>
<a name="l00725"></a>00725 <span class="comment">  ///------------------------------</span>
<a name="l00726"></a>00726 <span class="comment">  ///------------------------------</span>
<a name="l00727"></a>00727 <span class="comment">  ///------------------------------</span>
<a name="l00728"></a>00728 <span class="comment"></span>  <span class="comment">/* create structured ADC0 bank */</span>
<a name="l00729"></a>00729   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;ADC0&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00730"></a>00730   <a class="code" href="v792_8c.html#a93c9ec6788ab26b8dc1ca782761f91ac">v792_EvtCntRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>, &amp;evtcnt);
<a name="l00731"></a>00731   <span class="comment">/* Read Event */</span>
<a name="l00732"></a>00732   <a class="code" href="v792_8c.html#a723985757a28f135d0b1224a85accb62">v792_EventRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>, pdata, &amp;nentry);
<a name="l00733"></a>00733   pdata += nentry;
<a name="l00734"></a>00734   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00735"></a>00735   <a class="code" href="v792_8c.html#a526dbfe955e68a6e982bb5a3345b74e3">v792_DataClear</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a3ae5fa9db7b26822330dc4ecd93bced4">VADC0_BASE</a>);
<a name="l00736"></a>00736 <span class="preprocessor">#endif</span>
<a name="l00737"></a>00737 <span class="preprocessor"></span>
<a name="l00738"></a>00738 <span class="preprocessor">#if defined VADC1_CODE</span><span class="comment"></span>
<a name="l00739"></a>00739 <span class="comment">  ///------------------------------</span>
<a name="l00740"></a>00740 <span class="comment"></span>  <span class="comment">/* create structured ADC1 bank */</span>
<a name="l00741"></a>00741   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;ADC1&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00742"></a>00742   <span class="comment">/* Read Event */</span>
<a name="l00743"></a>00743   <a class="code" href="v792_8c.html#a723985757a28f135d0b1224a85accb62">v792_EventRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aadd77a29826b8161d9b96c579eb2d263">VADC1_BASE</a>, pdata, &amp;nentry);
<a name="l00744"></a>00744   pdata += nentry;
<a name="l00745"></a>00745   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00746"></a>00746   <span class="comment">//    v792_EvtCntReset(myvme, VADC1_BASE);</span>
<a name="l00747"></a>00747 <span class="preprocessor">#endif</span>
<a name="l00748"></a>00748 <span class="preprocessor"></span>
<a name="l00749"></a>00749 <span class="preprocessor">#if defined VADC2_CODE</span><span class="comment"></span>
<a name="l00750"></a>00750 <span class="comment">  ///------------------------------</span>
<a name="l00751"></a>00751 <span class="comment"></span>  <span class="comment">/* create structured ADC2 bank */</span>
<a name="l00752"></a>00752   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;ADC2&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00753"></a>00753   <span class="comment">/* Read Event */</span>
<a name="l00754"></a>00754   <a class="code" href="v792_8c.html#a723985757a28f135d0b1224a85accb62">v792_EventRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a041d0b7085ddc2d50f0c554de93ab39d">VADC2_BASE</a>, pdata, &amp;nentry);
<a name="l00755"></a>00755   pdata += nentry;
<a name="l00756"></a>00756   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00757"></a>00757 <span class="preprocessor">#endif</span>
<a name="l00758"></a>00758 <span class="preprocessor"></span>
<a name="l00759"></a>00759 <span class="preprocessor">#if defined VADC3_CODE</span><span class="comment"></span>
<a name="l00760"></a>00760 <span class="comment">  ///------------------------------</span>
<a name="l00761"></a>00761 <span class="comment"></span>  <span class="comment">/* create structured ADC3 bank */</span>
<a name="l00762"></a>00762   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;ADC3&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00763"></a>00763   <span class="comment">/* Read Event */</span>
<a name="l00764"></a>00764   <a class="code" href="v792_8c.html#a723985757a28f135d0b1224a85accb62">v792_EventRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a37ab9af0533e181c4729f7705c4a993e">VADC3_BASE</a>, pdata, &amp;nentry);
<a name="l00765"></a>00765   pdata += nentry;
<a name="l00766"></a>00766   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00767"></a>00767 <span class="preprocessor">#endif</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>
<a name="l00769"></a>00769 <span class="preprocessor">#if defined VTDC0_CODE</span><span class="comment"></span>
<a name="l00770"></a>00770 <span class="comment">  ///-------------------------------</span>
<a name="l00771"></a>00771 <span class="comment"></span>  <span class="comment">/* create variable length TDC bank */</span>
<a name="l00772"></a>00772   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;TDC0&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00773"></a>00773   <span class="comment">/* Read Event */</span>
<a name="l00774"></a>00774   <a class="code" href="v1190B_8c.html#a2e170ba3dc7d7492affdfad8fbc6338b">v1190_EventRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a72f046e5198d0a8f6f8a18ec0c142b07">VTDC0_BASE</a>, pdata, &amp;nentry);
<a name="l00775"></a>00775   pdata += nentry;
<a name="l00776"></a>00776   <span class="comment">/* clear TDC */</span>
<a name="l00777"></a>00777   <span class="comment">//  v1190_SoftClear(myvme, VTDC0_BASE);</span>
<a name="l00778"></a>00778   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00779"></a>00779 <span class="preprocessor">#endif</span>
<a name="l00780"></a>00780 <span class="preprocessor"></span>
<a name="l00781"></a>00781 <span class="preprocessor">#if defined VF48_CODE</span><span class="comment"></span>
<a name="l00782"></a>00782 <span class="comment">  ///-------------------------------</span>
<a name="l00783"></a>00783 <span class="comment"></span>  <span class="comment">/* create variable length WAVE bank */</span>
<a name="l00784"></a>00784   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;WAVE&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00785"></a>00785   status = vf48_EventRead64(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#a7675505ab96ded09e577ea510c2900e0">VF48_BASE</a>, pdata, &amp;evtlength);
<a name="l00786"></a>00786   <span class="comment">//  printf(&quot;read vf48 evtlength:%d\n&quot;, evtlength);</span>
<a name="l00787"></a>00787   pdata += (<a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>) evtlength;
<a name="l00788"></a>00788   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00789"></a>00789 <span class="preprocessor">#endif</span>
<a name="l00790"></a>00790 <span class="preprocessor"></span>
<a name="l00791"></a>00791 <span class="preprocessor">#if defined V1729_CODE</span><span class="comment"></span>
<a name="l00792"></a>00792 <span class="comment">  ///-------------------------------</span>
<a name="l00793"></a>00793 <span class="comment"></span>  timeout=20;
<a name="l00794"></a>00794   <span class="keywordflow">while</span>(!<a class="code" href="v1729_8c.html#a22cff544a108b4a9504b02997c086158">v1729_isTrigger</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>) &amp;&amp; timeout) {
<a name="l00795"></a>00795     timeout--;
<a name="l00796"></a>00796     <a class="code" href="group__msfunctionc.html#gaf877acb3de6be606dd427a84aa7b6dda">ss_sleep</a>(1);
<a name="l00797"></a>00797   };
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (timeout == 0) {
<a name="l00799"></a>00799     printf(<span class="stringliteral">&quot;No Trigger evt#:%d missed:%d (%6.2f%%)\n&quot;</span>, <a class="code" href="group__mbufferh.html#gadbb75a9d81e264e357bc5fc73dd4ebb8">SERIAL_NUMBER</a>(pevent)
<a name="l00800"></a>00800            , ++<a class="code" href="fevmemodules_8c.html#a6cde1377f6c51796f78ef647404f396a">missed</a>
<a name="l00801"></a>00801            , 100.*((<span class="keywordtype">float</span>)<a class="code" href="fevmemodules_8c.html#a6cde1377f6c51796f78ef647404f396a">missed</a>/(<span class="keywordtype">float</span>)<a class="code" href="group__mbufferh.html#gadbb75a9d81e264e357bc5fc73dd4ebb8">SERIAL_NUMBER</a>(pevent)));
<a name="l00802"></a>00802   }
<a name="l00803"></a>00803   npt = 2560;
<a name="l00804"></a>00804   nch =    4;
<a name="l00805"></a>00805   <a class="code" href="v1729_8c.html#ad2cf5338fac61553fb64ee8538e34dac">v1729_DataRead</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, data, nch, npt);
<a name="l00806"></a>00806   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;FWAV&quot;</span>, <a class="code" href="group__mdefineh.html#gad950d5fde6dd3ea7eba59fb6760a38cb">TID_INT</a>, &amp;pidata);
<a name="l00807"></a>00807   *pidata++ = npt; 
<a name="l00808"></a>00808   *pidata++ = data[7];
<a name="l00809"></a>00809   <a class="code" href="v1729_8c.html#a16527915223d5ba500133a7773990d57">v1729_OrderData</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>, data, pidata, nch, 0, npt);
<a name="l00810"></a>00810   pidata += npt;
<a name="l00811"></a>00811   <span class="comment">/*</span>
<a name="l00812"></a>00812 <span class="comment">   *pidata++ = 0x10000 | npt;</span>
<a name="l00813"></a>00813 <span class="comment">   v1729_OrderData(myvme, V1729_BASE, data, pidata, nch, 1, npt);</span>
<a name="l00814"></a>00814 <span class="comment">   pidata += npt;</span>
<a name="l00815"></a>00815 <span class="comment">  */</span>
<a name="l00816"></a>00816   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pidata);
<a name="l00817"></a>00817   
<a name="l00818"></a>00818   <span class="comment">// Start acquisition</span>
<a name="l00819"></a>00819   <a class="code" href="v1729_8c.html#ada0344e2f7a00d26cc500f480fb47e4c">v1729_AcqStart</a>(<a class="code" href="fevmemodules_8c.html#aeab89db2ad759342a32dcd50a0a0156c">myvme</a>, <a class="code" href="fevmemodules_8c.html#aaea9e4342e75a4567348965a0aad8fc7">V1729_BASE</a>);
<a name="l00820"></a>00820 <span class="preprocessor">#endif</span>
<a name="l00821"></a>00821 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00822"></a>00822 <span class="comment">  ///-------------------------------</span>
<a name="l00823"></a>00823 <span class="comment"></span>  <span class="comment">// EOB  </span>
<a name="l00824"></a>00824   <span class="comment">/*</span>
<a name="l00825"></a>00825 <span class="comment">    vmeio_AsyncWrite(myvme, VMEIO_BASE, S_RUNGATE);</span>
<a name="l00826"></a>00826 <span class="comment">    vmeio_SyncWrite(myvme, VMEIO_BASE, P_EOE);</span>
<a name="l00827"></a>00827 <span class="comment">    </span>
<a name="l00828"></a>00828 <span class="comment">    // Reset Latch EOB</span>
<a name="l00829"></a>00829 <span class="comment">    mvme_write_value(myvme, VLAM_BASE, 0x0);  // Nim out </span>
<a name="l00830"></a>00830 <span class="comment">  */</span>
<a name="l00831"></a>00831   
<a name="l00832"></a>00832   <span class="keywordflow">if</span> (evtlength) {
<a name="l00833"></a>00833     <span class="comment">//    printf(&quot;evtlength: %d  bk_size:%d\n&quot;, evtlength, bk_size(pevent));</span>
<a name="l00834"></a>00834     <span class="keywordflow">return</span> <a class="code" href="group__bkfunctionc.html#ga8fc93de36e62c4328cb6581be7f42a0f">bk_size</a>(pevent);
<a name="l00835"></a>00835   }
<a name="l00836"></a>00836   <span class="keywordflow">else</span>
<a name="l00837"></a>00837     <span class="keywordflow">return</span> 0;
<a name="l00838"></a>00838 }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 <span class="comment">/*-- Scaler event --------------------------------------------------*/</span>
<a name="l00841"></a><a class="code" href="ebuser_8c.html#af3ad062393c1437922bae26841d8927c">00841</a> <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> <a class="code" href="fevmemodules_8c.html#af3ad062393c1437922bae26841d8927c">read_scaler_event</a>(<span class="keywordtype">char</span> *pevent, <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> off)
<a name="l00842"></a>00842 {
<a name="l00843"></a>00843   <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> *pdata;
<a name="l00844"></a>00844   
<a name="l00845"></a>00845   <span class="comment">/* init bank structure */</span>
<a name="l00846"></a>00846   <a class="code" href="group__bkfunctionc.html#gac6fadde40824dbf7bd70abedd29be2bd">bk_init</a>(pevent);
<a name="l00847"></a>00847   
<a name="l00848"></a>00848   <span class="comment">/* create SCLR bank */</span>
<a name="l00849"></a>00849   <a class="code" href="group__bkfunctionc.html#ga4bb781187e18834136ed8ac368d53413">bk_create</a>(pevent, <span class="stringliteral">&quot;SCLR&quot;</span>, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, &amp;pdata);
<a name="l00850"></a>00850   
<a name="l00851"></a>00851   <span class="comment">/* read scaler bank */</span>
<a name="l00852"></a>00852   <a class="code" href="group__bkfunctionc.html#ga132dc71c8f74b478cdcc59bc1d9f6a26">bk_close</a>(pevent, pdata);
<a name="l00853"></a>00853   
<a name="l00854"></a>00854   <span class="comment">//   return bk_size(pevent);</span>
<a name="l00855"></a>00855   <span class="comment">// Nothing to send for now</span>
<a name="l00856"></a>00856   <span class="keywordflow">return</span> 0;
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859 
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

