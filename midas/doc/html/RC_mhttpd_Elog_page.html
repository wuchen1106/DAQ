<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Elog page</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="RunControl.html">SECTION 5: Run Control</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_run_control.html">Run Control Programs</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd.html">mhttpd: the MIDAS Web-based Run Control utility</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="RC_mhttpd_Elog_page">Elog page </a></h1><p><a class="anchor" id="idx_mhttpd_page_elog"></a> <br/>
</p>
 
<script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_Message_page", "RunControl", "RC_mhttpd_Program_page", "RC_mhttpd_Elog_page", "end" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
<p><br/>
</p>
<p><a class="anchor" id="Elog_200"></a></p>
<h2><a class="anchor" id="RC_mhttpd_Elog_intro">
Introduction</a></h2>
<p>The ELOG page (accessed by clicking the <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_Page_buttons">Elog button</a> <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_menu_buttons">if present</a> on the <a class="el" href="RC_mhttpd_Main_Status_page.html#RC_mhttpd_main_status">main status page</a> ) provides access to an electronic logbook. This tool can replace the experimental logbook for daily entries. The main advantage of the Elog over a paper logbook is the possiblity to access it remotely, and provide a general knowledge of the experiment. On the other hand, the Elog is not limited strictly to experiments. Worldwide Elog implementations can be found on the internet.</p>
<p>Two different implementations of the Elog are available i.e</p>
<ul>
<li><a class="el" href="RC_mhttpd_Elog_page.html#RC_mhttpd_Internal_Elog">Internal Elog</a> where the Elog is built in the mhttpd MIDAS web interface, or</li>
<li><a class="el" href="RC_mhttpd_Elog_page.html#RC_mhttpd_External_Elog">External Elog</a> where the Elog runs independently from the experiment and mhttpd as well.</li>
</ul>
<p>While the Internal implementation doesn't requires any setup, the External implementation requires a proper Elog installation which is fully described on the <a href="http://midas.psi.ch/elog/">Elog</a> web site. The External Elog implementation also requires a dedicated entry in the ODB as shown in the code below. It also requires the package <b>Elog</b> to be already installed, and properly configured. Once the ODB entry is present, the internal ELOG is disabled. <br/>
 The Elog is <a class="el" href="F_Elog.html#F_Elog_Custom">customized</a> through the ODB <span class="odb">/Elog</span> tree.</p>
<hr/>
 <a class="anchor" id="idx_Elog_internal"></a> </p>
<h3><a class="anchor" id="RC_mhttpd_Internal_Elog">
Internal Elog</a></h3>
<p>By default the mhttpd provides the internal Elog. The entry destination directory is established by the logger key in ODB (see <a class="el" href="F_Elog.html#F_Logger_Elog_Dir">Elog Dir</a>). The Electronic Log page shows the most recent Log message recorded in the system. The top buttons allows you to either <b>Create/Edit/Reply/Query/Show</b> a message</p>
<p><br/>
<br/>
<br/>
 </p>
<center> <span class="image"> main Elog page. <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="mhelog.gif" alt="mhelog.gif"/>
</div>
<p> </span></center><p> <br/>
<br/>
<br/>
</p>
<p>The format of the message log can be written in HTML format.</p>
<p><br/>
<br/>
<br/>
 </p>
<center> <span class="image"> HTML Elog message. <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="mheloghtml.gif" alt="mheloghtml.gif"/>
</div>
<p> </span></center><p> <br/>
<br/>
<br/>
</p>
<h4><a class="anchor" id="RC_mhttpd_Internal_Elog_shift_check">
The Shift Check button</a></h4>
<p><a class="anchor" id="idx_elog_shift-check-form"></a></p>
<ul>
<li>A feature of the Elog entry page is the optional <b>Shift Check</b> button, which permits the experimenter on shift to go through a checklist and record his/her findings in the Elog system. The checklist is user-defined and can be found in the ODB under the <a class="el" href="F_Elog.html#F_ODB_Elog_Tree">/Elog tree</a>. In the following example, a Shift Check button labelled <em>"Gas Handling"</em> has been created:</li>
</ul>
<p><br/>
<br/>
<br/>
 </p>
<center> <span class="image"> HTML Elog message. <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="melogforms.png" alt="melogforms.png"/>
</div>
<p> </span></center><p> <br/>
<br/>
<br/>
</p>
<ul>
<li>The code below generates the above screen. The key <em>Gas Handling</em> contains all the information for a given form. There is no limit to the number of entries. By specifying an entry with the name <em>Attachment0</em>,<em>Attachment1</em>,... and filling it with a fixed file name, its content will be attached to the Elog entry for every shift report.</li>
</ul>
<div class="fragment"><pre class="fragment">[local:myexpt:Running]/&gt;cd /Elog/
[local:myexpt:Running]/Elog&gt;mkdir Forms
[local:myexpt:Running]/Elog&gt;cd Forms/
[local:myexpt:Running]Forms&gt;mkdir <span class="stringliteral">&quot;Gas Handling&quot;</span>
[local:myexpt:Running]Forms&gt;cd <span class="stringliteral">&quot;Gas Handling&quot;</span>
[local:myexpt:Running]Gas Handling&gt;create <span class="keywordtype">string</span> <span class="stringliteral">&quot;N2 Pressure&quot;</span>
String length [32]: 
[local:myexpt:Running]Gas Handling&gt;create <span class="keywordtype">string</span> <span class="stringliteral">&quot;Vessel Temperature&quot;</span>
String length [32]: 
[local:myexpt:Running]Gas Handling&gt;ls
N2 pressure              
Vessel Temperature              
[local:myexpt:Running]Gas Handling&gt;
[local:xenon:Running]Gas Handling&gt;create <span class="keywordtype">string</span> Attachment0 
String length [32]: 64
[local:xenon:Running]Gas Handling&gt;<span class="keyword">set</span> Attachment0 Gaslog.txt
</pre></div><h4><a class="anchor" id="RC_mhttpd_Internal_Elog_runlog">
Runlog Button</a></h4>
<ul>
<li>The <b>runlog</b> button display the content of the file <b>runlog.txt</b> which is expected to be in the data directory specified by the ODB key <b>/Logger/Data Dir</b>. Regardless of its content, it will be displayed in the web page. Its common use is to <b>append</b> <b>lines</b> after every run. The client appending this run information can be any of the MIDAS applications. An <b> example </b> is available in the <em><a class="el" href="analyzer_8c.html">examples/experiment/analyzer.c</a></em> which will write some statistical information at end-of-run to the file runlog.txt</li>
</ul>
<p><br/>
<br/>
<br/>
 </p>
<center> <span class="image"> Elog page, Runlog display. <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="mhelogrun.gif" alt="mhelogrun.gif"/>
</div>
<p> </span></center><p> * <br/>
<br/>
<br/>
</p>
<ul>
<li>When composing a new entry into the Elog, several fields are available to specify the nature of the message i.e: Author, Type, System, Subject. Under Type and System a pulldown menu provides a choice of categories. These categories are user definable through the <span class="odb">/Elog</span> ODB tree under the keys <a class="el" href="F_Elog.html#F_Types">Types</a> and $ref F_Systems "Systems". The number of categories is limited to 20 maximum. Any usused fields can be left empty.</li>
</ul>
<p><br/>
<br/>
<br/>
 </p>
<center> <span class="image"> Elog page, New Elog entry form. <br/>
<br/>
<br/>
 </p>
<div align="center">
<img src="mhelognew.gif" alt="mhelognew.gif"/>
</div>
<p> </span></center><p> <br/>
<br/>
<br/>
</p>
<hr/>
 <a class="anchor" id="idx_Elog_external"></a> </p>
<h3><a class="anchor" id="RC_mhttpd_External_Elog">
External Elog</a></h3>
<p>The advantage of using the external Elog over the built-in version is its flexibility. This package is used worldwide and improvements are constantly being made. A full-features documentation and standalone installation can be found at the <a href="http://midas.psi.ch/elog/">Elog</a> web site.</p>
<p>Installation requires requires several steps described below.</p>
<ul>
<li>
Download the Elog package from the web site mentioned above. <ul>
<li>
<p class="startli">Windows, Linux, Mac version can be found there. Simple installation procedures are also described. Its installation can be done at the system level or at the user level. The Elog can service multiple Electronic logbooks in parallel and therefore an extra entry in its configuration file can provide specific experimental elog in a similar fashion as the internal one.</p>
<p class="endli"></p>
</li>
<li>
You need to take note of several consideration for its installation. Several locations are required for the different files that elog deals with. <ul>
<li>
elog resource directory ( e.g. /elog_installation_dir where elog is installed) </li>
<li>
logbook directory (ex: /myexpt/logbook where the pwd and elog entries are stored). </li>
</ul>
</li>
<li>
The pwd file uses encryption for the user password. </li>
<li>
As this Elog installation is tailored towards an experiment, a restriction applies i.e. <em> ensure that the mhttpd and elog applications shares at least the same file system.</em> <br/>
This means that either <ul>
<li>
both applications runs on the same machine or </li>
<li>
a nsf mount provides file sharing. </li>
</ul>
</li>
<li>
<p class="startli">You need to know the node and ports for both applications. Like mhttpd, elogd also requires a port number for communication through the web (e.g. NodeA:mhttpd -p 8080, NodeB:elogd -p 8081).</p>
<ol type="1">
<li>copy the default midas/src/elogd.cfg from the MIDAS distrbution to your operating directory.</li>
<li>modify the elogd.cfg to reflect your configuration <div class="fragment"><pre class="fragment"><span class="preprocessor">  # This is a simple elogd configuration file to work with MIDAS</span>
<span class="preprocessor"></span><span class="preprocessor">  # $Id: mhttpd.dox 4032 2007-11-02 17:13:52Z amaudruz $ </span>
<span class="preprocessor"></span>
  [global]
  ; port under which elogd should run
  port = 8081                             
  ; password file, created under <span class="stringliteral">&apos;logbook dir&apos;</span>
  password file = elog.pwd                
  ; directory under which elog was installed (themes etc.)
  resource dir = /elog_installation_dir     
  ; directory where the password file will end up
  logbook dir = /myexpt/logbook     
  ; anyone can create it&apos;s own account
  self register = 1                       
  ; URL under which elogd is accessible
  url = http:<span class="comment">//ladd00.triumf.ca:8081      </span>
  ; the &quot;<a class="code" href="mfe_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>&quot; tab will bring you back to mhttpd
  <a class="code" href="mfe_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> tab = Xenon                        
  ; this is the URL of mhttpd which must run on a different port
  <a class="code" href="mfe_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> tab url = http:<span class="comment">//NodeA:8080</span>
  ; only needed for email notifications
  smtp host = your.smtp.host              
  ; Define one logbook for online use. Severl logbooks can be defined here
  [MyOnline]
  ; directory where the logfiles will be written to
  Data dir = /myexpt/logbook            
  Comment = My MIDAS Experiment Electronic Logbook
  ; mimic old mhttpd behaviour
  Attributes = Run number, Author, Type, System, Subject     
  Options Type = Routine, Shift Summary, Minor Error, Severe Error, Fix, Question, Info, Modification, Alarm, Test, Other, 
  Options System = General, DAQ, Detector, Electronics, Target, Beamline
  Extendable Options = Type, System
  ; This substitution will enter the current run number
  Preset Run number = $shell(odbedit -e myexpt -h NodeA -d Runinfo -c &apos;ls -v \&quot;run number\&quot;&apos;)    
  Preset Author = $long_name
  Required Attributes = Type, Subject
  ; Run number and Author cannot be changed
  Locked Attributes = Run number, Author  
  Page Title = ELOG - $subject
  Reverse sort = 1
  Quick filter = Date, Type, Author
  ; Don&apos;t send any emails
  Suppress email to users = 1             
</pre></div></li>
<li>start the elog daemon. <b>-x</b> is for the shell substitution of the command <em>Preset Run number = $shell(...)</em> The argument invokes the odbedit remotely if needed to retrieve the current run number. You will have to ensure the proper path to the odbedit and the proper -e, -h argments for the experiment and host. You may want to verify this command from the console. <div class="fragment"><pre class="fragment">  NodeB:~&gt;/installation_elog_dir/elogd -c elogd.cfg -x
</pre></div></li>
<li>start the mhttpd at its correct port and possibly in the daemon form. <div class="fragment"><pre class="fragment">  NodeA:~&gt;mhttpd -p 8080 -D 
</pre></div></li>
<li>At this point the Elog from the MIDAS web page is accessing the internal Elog. To activate the external Elog, include in the ODB two entries such as: <div class="fragment"><pre class="fragment">   NodeX:&gt; odbedit -e myexpt -h NodeA
   [NodeX:myexpt:Running]/&gt;cd elog
   [NodeX:myexpt:Running]/Elog&gt;create <span class="keywordtype">string</span> Url
   String length [32]: 64
   [NodeX:myexpt:Running]/Elog&gt;<span class="keyword">set</span> Url http:<span class="comment">//NodeB:8081/MyOnline</span>
   [NodeX:myexpt:Running]
   [NodeX:myexpt:Running]/Elog&gt;create <span class="keywordtype">string</span> <span class="stringliteral">&quot;Logbook Dir&quot;</span>
   String length [32]: 64
   [NodeX:myexpt:Running]/Elog&gt;<span class="keyword">set</span> <span class="stringliteral">&quot;Logbook Dir&quot;</span> /myexpt/logbook

   [NodeX:myexpt:Running]/Elog&gt;ls
Logbook Dir                     /home/myexpt/ElogBook
Url                             http:<span class="comment">//NodeB:8081/MyOnline</span>
</pre></div></li>
<li>Confirm proper operation of the external Elog by creating an entry. You will be prompted for a username and password. Click on New registration. Full control of these features are described in the Elog documentation.</li>
<li>Stop and restart the Elogd in the background. <div class="fragment"><pre class="fragment">   NodeB:~&gt;/installation_elog_dir/elogd -c elogd.cfg -x -D
</pre></div></li>
<li>In the event you had a previous entry under the internal elog, you can convert the internal to external using the elconv tool. <div class="fragment"><pre class="fragment">   NodeB:~&gt; cp <span class="keyword">internal</span>/elog_logbook<span class="comment">/*.log /myexpt/logbook/.</span>
<span class="comment">   NodeB:~&gt; cd /myexpt/logbook</span>
<span class="comment">   NodeB:~&gt; /installation_elog_dir/elconv</span>
</pre></div></li>
</ol>
<p class="endli"></p>
</li>
</ul>
</li>
</ul>
<p><br/>
</p>
 
<script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_Message_page", "RunControl", "RC_mhttpd_Program_page", "RC_mhttpd_Elog_page", "" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
<p><br/>
 <a class="anchor" id="end"></a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

