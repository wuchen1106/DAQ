<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Makefile Source File</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>Makefile</h1><a href="Makefile.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#####################################################################</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#  Name:         Makefile</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#  Created by:   Stefan Ritt</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span><span class="preprocessor">#  Contents:     Makefile for MIDAS binaries and examples under unix</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#  $Id: Makefile 5241 2012-01-30 23:46:10Z amaudruz $</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#####################################################################</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor"># Usage:</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#        gmake             To compile the MIDAS library and binaries</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">#        gmake install     To install the library and binaries</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#        gmake examples    To compile low-level examples (not necessary)</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor">#        gmake static      To make static executables for debugging</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor"># This makefile contains conditional code to determine the operating</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor"># system it is running under by evaluating the OSTYPE environment</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor"># variable. In case this does not work or if the GNU make is not</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor"># available, the conditional code has to be evaluated manually.</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor"># Remove all ifeq - endif blocks except the one belonging to the</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor"># current operating system. From this block remove only the first</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor"># and the last line (the one with the ifeq and endif statement).</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor"># &quot;gmake install&quot; will copy MIDAS binaries, the midas library and</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor"># the midas include files to specific directories for each version.</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor"># You may change these directories to match your preferences.</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#####################################################################</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor"># get OS type from shell</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>OSTYPE = $(shell uname)
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 #
<a name="l00036"></a>00036 # System direcotries <span class="keywordflow">for</span> installation, modify <span class="keywordflow">if</span> needed
<a name="l00037"></a>00037 #
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 ifndef PREFIX
<a name="l00040"></a>00040 PREFIX     = /usr/local
<a name="l00041"></a>00041 endif
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 SYSBIN_DIR = $(PREFIX)/bin
<a name="l00044"></a>00044 SYSLIB_DIR = $(PREFIX)/lib
<a name="l00045"></a>00045 SYSINC_DIR = $(PREFIX)/include
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor"># Option to set the shared library path on MIDAS executables</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>NEED_RPATH=1
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span><span class="preprocessor"># Option to use the static ROOT library libRoot.a</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor"># To link midas with the static ROOT library, say &quot;make ... NEED_LIBROOTA=1&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>NEED_LIBROOTA=
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="preprocessor">#</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span><span class="preprocessor"># Optional libmysqlclient library for mlogger</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="preprocessor"># To add mySQL support to the logger, say &quot;make ... NEED_MYSQL=1&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor"># Here we try to figure out automatically if mySQL is installed</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>MYSQL_CONFIG := $(shell which mysql_config 2&gt; /dev/null)
<a name="l00066"></a>00066 ifdef MYSQL_CONFIG
<a name="l00067"></a>00067   MYSQLINCDIR := $(shell mysql_config --cflags | sed -e <span class="stringliteral">&apos;s,^.*-I\([^ ]*\).*$$,\1,&apos;</span> -e s/\<span class="stringliteral">&apos;//g)</span>
<a name="l00068"></a>00068 <span class="stringliteral">  NEED_MYSQL := $(shell if [ -e $(MYSQLINCDIR)/mysql.h ]; then echo 1; fi)</span>
<a name="l00069"></a>00069 <span class="stringliteral">endif</span>
<a name="l00070"></a>00070 <span class="stringliteral"></span>
<a name="l00071"></a>00071 <span class="stringliteral">#</span>
<a name="l00072"></a>00072 <span class="stringliteral"># Optional ODBC history support</span>
<a name="l00073"></a>00073 <span class="stringliteral">#</span>
<a name="l00074"></a>00074 <span class="stringliteral">HAVE_ODBC := $(shell if [ -e /usr/include/sql.h ]; then echo 1; fi)</span>
<a name="l00075"></a>00075 <span class="stringliteral"></span>
<a name="l00076"></a>00076 <span class="stringliteral">#</span>
<a name="l00077"></a>00077 <span class="stringliteral"># Option to use our own implementation of strlcat, strlcpy</span>
<a name="l00078"></a>00078 <span class="stringliteral">#</span>
<a name="l00079"></a>00079 <span class="stringliteral">NEED_STRLCPY=1</span>
<a name="l00080"></a>00080 <span class="stringliteral"></span>
<a name="l00081"></a>00081 <span class="stringliteral">#</span>
<a name="l00082"></a>00082 <span class="stringliteral"># Directory in which mxml.c/h resides. This library has to be checked</span>
<a name="l00083"></a>00083 <span class="stringliteral"># out separately from the midas CVS since it&apos;</span>s used in several projects
<a name="l00084"></a>00084 #
<a name="l00085"></a>00085 MXML_DIR=../mxml
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 #
<a name="l00088"></a>00088 # Directory in which mscb.c/h resides. These files are necessary <span class="keywordflow">for</span>
<a name="l00089"></a>00089 # the optional MSCB support in mhttpd
<a name="l00090"></a>00090 #
<a name="l00091"></a>00091 MSCB_DIR=./mscb
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 #
<a name="l00094"></a>00094 # Optional zlib support <span class="keywordflow">for</span> data compression in the mlogger and in the analyzer
<a name="l00095"></a>00095 #
<a name="l00096"></a>00096 NEED_ZLIB=
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 #
<a name="l00099"></a>00099 # Optional MSCB support <span class="keywordflow">for</span> mhttpd
<a name="l00100"></a>00100 #
<a name="l00101"></a>00101 NEED_MSCB=1
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 #####################################################################
<a name="l00104"></a>00104 # Nothing needs to be modified after <span class="keyword">this</span> line 
<a name="l00105"></a>00105 #####################################################################
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 #-----------------------
<a name="l00108"></a>00108 # Common flags
<a name="l00109"></a>00109 #
<a name="l00110"></a>00110 CC = gcc $(USERFLAGS)
<a name="l00111"></a>00111 CXX = g++ $(USERFLAGS)
<a name="l00112"></a>00112 CFLAGS = -g -O2 -Wall -Wno-strict-aliasing -Wuninitialized -I$(INC_DIR) -I$(DRV_DIR) -I$(MXML_DIR) -I$(MSCB_DIR) -L$(LIB_DIR) -DHAVE_FTPLIB
<a name="l00113"></a>00113 <span class="preprocessor">#CFLAGS = -g  -Wall -Wno-strict-aliasing -Wuninitialized -I$(INC_DIR) -I$(DRV_DIR) -I$(MXML_DIR) -I$(MSCB_DIR) -L$(LIB_DIR) -DHAVE_FTPLIB</span>
<a name="l00114"></a>00114 <span class="preprocessor"></span>
<a name="l00115"></a>00115 <span class="preprocessor">#-----------------------</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span><span class="preprocessor"># Ovevwrite MAX_EVENT_SIZE with environment variable</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>ifdef MIDAS_MAX_EVENT_SIZE
<a name="l00119"></a>00119 CFLAGS += -DMAX_EVENT_SIZE=$(MIDAS_MAX_EVENT_SIZE)
<a name="l00120"></a>00120 endif
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 #-----------------------
<a name="l00123"></a>00123 # Cross-compilation, change GCC_PREFIX
<a name="l00124"></a>00124 #
<a name="l00125"></a>00125 ifeq ($(OSTYPE),crosscompile)
<a name="l00126"></a>00126 GCC_PREFIX=$(HOME)/linuxdcc/Cross-Compiler/gcc-4.0.2/build/gcc-4.0.2-glibc-2.3.6/powerpc-405-linux-gnu
<a name="l00127"></a>00127 GCC_BIN=$(GCC_PREFIX)/bin/powerpc-405-linux-gnu-
<a name="l00128"></a>00128 LIBS=-L$(HOME)/linuxdcc/userland/lib -pthread -lutil -lrt
<a name="l00129"></a>00129 CC  = $(GCC_BIN)gcc
<a name="l00130"></a>00130 CXX = $(GCC_BIN)g++
<a name="l00131"></a>00131 OSTYPE = cross-ppc405
<a name="l00132"></a>00132 OS_DIR = $(OSTYPE)
<a name="l00133"></a>00133 CFLAGS += -DOS_LINUX
<a name="l00134"></a>00134 NEED_MYSQL=
<a name="l00135"></a>00135 HAVE_ODBC=
<a name="l00136"></a>00136 endif
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 #-----------------------
<a name="l00139"></a>00139 # OSF/1 (DEC UNIX)
<a name="l00140"></a>00140 <span class="preprocessor">#</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>ifeq ($(HOSTTYPE),alpha)
<a name="l00142"></a>00142 OSTYPE = osf1
<a name="l00143"></a>00143 endif
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 ifeq ($(OSTYPE),osf1)
<a name="l00146"></a>00146 OS_DIR = osf1
<a name="l00147"></a>00147 OSFLAGS = -DOS_OSF1
<a name="l00148"></a>00148 FFLAGS = -nofor_main -D 40000000 -T 20000000
<a name="l00149"></a>00149 LIBS = -lc -lbsd
<a name="l00150"></a>00150 SPECIFIC_OS_PRG = 
<a name="l00151"></a>00151 endif
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="preprocessor">#-----------------------</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span><span class="preprocessor"># Ultrix</span>
<a name="l00155"></a>00155 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>ifeq ($(HOSTTYPE),mips)
<a name="l00157"></a>00157 OSTYPE = ultrix
<a name="l00158"></a>00158 endif
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 ifeq ($(OSTYPE),ultrix)
<a name="l00161"></a>00161 OS_DIR = ultrix
<a name="l00162"></a>00162 OSFLAGS = -DOS_ULTRIX -DNO_PTY
<a name="l00163"></a>00163 LIBS =
<a name="l00164"></a>00164 SPECIFIC_OS_PRG = 
<a name="l00165"></a>00165 endif
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="preprocessor">#-----------------------</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span><span class="preprocessor"># FreeBSD</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>ifeq ($(OSTYPE), FreeBSD)
<a name="l00171"></a>00171 OS_DIR = freeBSD
<a name="l00172"></a>00172 OSFLAGS = -DOS_FREEBSD
<a name="l00173"></a>00173 LIBS = -lbsd -lcompat
<a name="l00174"></a>00174 SPECIFIC_OS_PRG = 
<a name="l00175"></a>00175 endif
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="preprocessor">#-----------------------</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span><span class="preprocessor"># MacOSX/Darwin is just a funny Linux</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>ifeq ($(OSTYPE),Darwin)
<a name="l00181"></a>00181 OSTYPE = darwin
<a name="l00182"></a>00182 endif
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 ifeq ($(OSTYPE),darwin)
<a name="l00185"></a>00185 OS_DIR = darwin
<a name="l00186"></a>00186 OSFLAGS = -DOS_LINUX -DOS_DARWIN -DHAVE_STRLCPY -fPIC -Wno-unused-function
<a name="l00187"></a>00187 LIBS = -lpthread
<a name="l00188"></a>00188 SPECIFIC_OS_PRG = $(BIN_DIR)/mlxspeaker
<a name="l00189"></a>00189 NEED_ZLIB=1
<a name="l00190"></a>00190 NEED_STRLCPY=
<a name="l00191"></a>00191 NEED_RANLIB=1
<a name="l00192"></a>00192 NEED_RPATH=
<a name="l00193"></a>00193 SHLIB+=$(LIB_DIR)/libmidas-shared.dylib
<a name="l00194"></a>00194 SHLIB+=$(LIB_DIR)/libmidas-shared.so
<a name="l00195"></a>00195 endif
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="preprocessor">#-----------------------</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor"># This is for Cygwin</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>ifeq ($(OSTYPE),CYGWIN_NT-5.1)
<a name="l00201"></a>00201 OSTYPE = cygwin
<a name="l00202"></a>00202 endif
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 ifeq ($(OSTYPE),cygwin)
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 OS_DIR = cygwin
<a name="l00207"></a>00207 OSFLAGS = -DOS_LINUX -DOS_CYGWIN -Wno-unused-function
<a name="l00208"></a>00208 LIBS = -lutil -lpthread
<a name="l00209"></a>00209 endif
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="preprocessor">#-----------------------</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span><span class="preprocessor"># This is for Linux</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span>ifeq ($(OSTYPE),Linux)
<a name="l00215"></a>00215 OSTYPE = linux
<a name="l00216"></a>00216 endif
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 ifeq ($(OSTYPE),linux)
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="preprocessor"># &gt;2GB file support</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span>CFLAGS += -D_LARGEFILE64_SOURCE
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="preprocessor"># include ZLIB support</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>NEED_ZLIB=1
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 OS_DIR = linux
<a name="l00227"></a>00227 OSFLAGS += -DOS_LINUX -fPIC -Wno-unused-function
<a name="l00228"></a>00228 LIBS = -lutil -lpthread -lrt
<a name="l00229"></a>00229 SPECIFIC_OS_PRG = $(BIN_DIR)/mlxspeaker $(BIN_DIR)/dio
<a name="l00230"></a>00230 endif
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="preprocessor">#-----------------------</span>
<a name="l00233"></a>00233 <span class="preprocessor"></span><span class="preprocessor"># This is for Solaris</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span>ifeq ($(OSTYPE),solaris)
<a name="l00236"></a>00236 CC = gcc
<a name="l00237"></a>00237 OS_DIR = solaris
<a name="l00238"></a>00238 OSFLAGS = -DOS_SOLARIS
<a name="l00239"></a>00239 LIBS = -lsocket -lnsl
<a name="l00240"></a>00240 SPECIFIC_OS_PRG = 
<a name="l00241"></a>00241 endif
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="preprocessor">#####################################################################</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span><span class="preprocessor"># end of conditional code</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span><span class="preprocessor">#####################################################################</span>
<a name="l00246"></a>00246 <span class="preprocessor"></span>
<a name="l00247"></a>00247 <span class="preprocessor">#</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span><span class="preprocessor"># Midas directories</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00250"></a>00250 <span class="preprocessor"></span>INC_DIR  = include
<a name="l00251"></a>00251 SRC_DIR  = src
<a name="l00252"></a>00252 UTL_DIR  = utils
<a name="l00253"></a>00253 DRV_DIR  = drivers
<a name="l00254"></a>00254 EXAM_DIR = examples
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 <span class="preprocessor">#</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span><span class="preprocessor"># Midas operating system dependent directories</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>LIB_DIR  = $(OS_DIR)/lib
<a name="l00260"></a>00260 BIN_DIR  = $(OS_DIR)/bin
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span><span class="preprocessor"># targets</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>EXAMPLES = $(BIN_DIR)/consume $(BIN_DIR)/produce \
<a name="l00266"></a>00266         $(BIN_DIR)/rpc_test $(BIN_DIR)/msgdump $(BIN_DIR)/minife \
<a name="l00267"></a>00267         $(BIN_DIR)/minirc $(BIN_DIR)/odb_test
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 PROGS = $(BIN_DIR)/mserver $(BIN_DIR)/mhttpd \
<a name="l00270"></a>00270         $(BIN_DIR)/mlogger $(BIN_DIR)/odbedit \
<a name="l00271"></a>00271         $(BIN_DIR)/mtape $(BIN_DIR)/mhist \
<a name="l00272"></a>00272         $(BIN_DIR)/mstat $(BIN_DIR)/mdump \
<a name="l00273"></a>00273         $(BIN_DIR)/lazylogger \
<a name="l00274"></a>00274         $(BIN_DIR)/mtransition \
<a name="l00275"></a>00275         $(BIN_DIR)/mhdump \
<a name="l00276"></a>00276         $(BIN_DIR)/mchart $(BIN_DIR)/stripchart.tcl \
<a name="l00277"></a>00277         $(BIN_DIR)/webpaw $(BIN_DIR)/odbhist \
<a name="l00278"></a>00278         $(BIN_DIR)/melog \
<a name="l00279"></a>00279         $(BIN_DIR)/mfe_link_test \
<a name="l00280"></a>00280         $(BIN_DIR)/mana_link_test \
<a name="l00281"></a>00281         $(SPECIFIC_OS_PRG)
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 ANALYZER = $(LIB_DIR)/mana.o
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 ifdef CERNLIB
<a name="l00286"></a>00286 ANALYZER += $(LIB_DIR)/hmana.o
<a name="l00287"></a>00287 endif
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 ifdef ROOTSYS
<a name="l00290"></a>00290 ANALYZER += $(LIB_DIR)/rmana.o
<a name="l00291"></a>00291 endif
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 ifdef HAVE_ODBC
<a name="l00294"></a>00294 PROGS += $(BIN_DIR)/mh2sql
<a name="l00295"></a>00295 endif
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 OBJS =  $(LIB_DIR)/midas.o $(LIB_DIR)/system.o $(LIB_DIR)/mrpc.o \
<a name="l00298"></a>00298         $(LIB_DIR)/odb.o $(LIB_DIR)/ftplib.o \
<a name="l00299"></a>00299         $(LIB_DIR)/mxml.o \
<a name="l00300"></a>00300         $(LIB_DIR)/dm_eb.o \
<a name="l00301"></a>00301         $(LIB_DIR)/history_midas.o \
<a name="l00302"></a>00302         $(LIB_DIR)/history_sql.o \
<a name="l00303"></a>00303         $(LIB_DIR)/history.o $(LIB_DIR)/alarm.o $(LIB_DIR)/elog.o
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 ifdef NEED_STRLCPY
<a name="l00306"></a>00306 OBJS += $(LIB_DIR)/strlcpy.o
<a name="l00307"></a>00307 endif
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 LIBNAME = $(LIB_DIR)/libmidas.a
<a name="l00310"></a>00310 LIB     = $(LIBNAME)
<a name="l00311"></a>00311 SHLIB   = $(LIB_DIR)/libmidas-shared.so
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 VPATH = $(LIB_DIR):$(INC_DIR)
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 all: check-mxml \
<a name="l00316"></a>00316         $(OS_DIR) $(LIB_DIR) $(BIN_DIR) \
<a name="l00317"></a>00317         $(LIBNAME) $(SHLIB) \
<a name="l00318"></a>00318         $(ANALYZER) \
<a name="l00319"></a>00319         $(LIB_DIR)/<a class="code" href="cnaf__callback_8c.html#a2e79e874780c7bf4355f940ac18c7bfa">cnaf_callback</a>.o \
<a name="l00320"></a>00320         $(LIB_DIR)/mfe.o \
<a name="l00321"></a>00321         $(LIB_DIR)/fal.o $(PROGS)
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 dox:
<a name="l00324"></a>00324         cd doc; make
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 linux32:
<a name="l00327"></a>00327         $(MAKE) ROOTSYS= OS_DIR=linux-m32 USERFLAGS=-m32
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 linux64:
<a name="l00330"></a>00330         $(MAKE) ROOTSYS= OS_DIR=linux-m64 USERFLAGS=-m64
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 clean32:
<a name="l00333"></a>00333         $(MAKE) ROOTSYS= OS_DIR=linux-m32 USERFLAGS=-m32 clean
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 clean64:
<a name="l00336"></a>00336         $(MAKE) ROOTSYS= OS_DIR=linux-m64 USERFLAGS=-m64 clean
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 crosscompile:
<a name="l00339"></a>00339         echo OSTYPE=$(OSTYPE)
<a name="l00340"></a>00340         $(MAKE) ROOTSYS= OS_DIR=$(OSTYPE)-crosscompile OSTYPE=crosscompile
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 examples: $(EXAMPLES)
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="preprocessor">#####################################################################</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span>
<a name="l00346"></a>00346 <span class="preprocessor">#</span>
<a name="l00347"></a>00347 <span class="preprocessor"></span><span class="preprocessor"># create library and binary directories</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span>
<a name="l00350"></a>00350 $(OS_DIR):
<a name="l00351"></a>00351         @<span class="keywordflow">if</span> [ ! -d  $(OS_DIR) ] ; then \
<a name="l00352"></a>00352            echo <span class="stringliteral">&quot;Making directory $(OS_DIR)&quot;</span> ; \
<a name="l00353"></a>00353            mkdir $(OS_DIR); \
<a name="l00354"></a>00354         fi;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 $(LIB_DIR):
<a name="l00357"></a>00357         @<span class="keywordflow">if</span> [ ! -d  $(LIB_DIR) ] ; then \
<a name="l00358"></a>00358            echo <span class="stringliteral">&quot;Making directory $(LIB_DIR)&quot;</span> ; \
<a name="l00359"></a>00359            mkdir $(LIB_DIR); \
<a name="l00360"></a>00360         fi;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 $(BIN_DIR):
<a name="l00363"></a>00363         @<span class="keywordflow">if</span> [ ! -d  $(BIN_DIR) ] ; then \
<a name="l00364"></a>00364            echo <span class="stringliteral">&quot;Making directory $(BIN_DIR)&quot;</span> ; \
<a name="l00365"></a>00365            mkdir $(BIN_DIR); \
<a name="l00366"></a>00366         fi;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 <span class="preprocessor">#</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span><span class="preprocessor"># main binaries</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00371"></a>00371 <span class="preprocessor"></span>
<a name="l00372"></a>00372 ifeq ($(NEED_MYSQL),1)
<a name="l00373"></a>00373 CFLAGS      += -DHAVE_MYSQL $(shell mysql_config --include)
<a name="l00374"></a>00374 MYSQL_LIBS  := -L/usr/lib/mysql $(shell mysql_config --libs)
<a name="l00375"></a>00375 <span class="preprocessor"># only for mlogger LIBS        += $(MYSQL_LIBS)</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span>NEED_ZLIB = 1
<a name="l00377"></a>00377 endif
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 ifdef HAVE_ODBC
<a name="l00380"></a>00380 CFLAGS      += -DHAVE_ODBC
<a name="l00381"></a>00381 ODBC_LIBS   += -lodbc
<a name="l00382"></a>00382 ifeq ($(OSTYPE),darwin)
<a name="l00383"></a>00383 ODBC_LIBS   += /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation
<a name="l00384"></a>00384 endif
<a name="l00385"></a>00385 endif
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 ifdef ROOTSYS
<a name="l00388"></a>00388 ROOTLIBS    := $(shell $(ROOTSYS)/bin/root-config --libs)
<a name="l00389"></a>00389 ROOTGLIBS   := $(shell $(ROOTSYS)/bin/root-config --glibs)
<a name="l00390"></a>00390 ROOTCFLAGS  := $(shell $(ROOTSYS)/bin/root-config --cflags)
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 ifdef NEED_RPATH
<a name="l00393"></a>00393 ROOTLIBS   += -Wl,-rpath,$(ROOTSYS)/lib
<a name="l00394"></a>00394 ROOTGLIBS  += -Wl,-rpath,$(ROOTSYS)/lib
<a name="l00395"></a>00395 endif
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 ifdef NEED_LIBROOTA
<a name="l00398"></a>00398 ROOTLIBS    := $(ROOTSYS)/lib/libRoot.a -lssl -ldl -lcrypt
<a name="l00399"></a>00399 ROOTGLIBS   := $(ROOTLIBS) -lfreetype
<a name="l00400"></a>00400 endif
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 CFLAGS     += -DHAVE_ROOT $(ROOTCFLAGS)
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 endif <span class="preprocessor"># ROOTSYS</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
<a name="l00406"></a>00406 ifdef NEED_ZLIB
<a name="l00407"></a>00407 CFLAGS     += -DHAVE_ZLIB
<a name="l00408"></a>00408 LIBS       += -lz
<a name="l00409"></a>00409 endif
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 ifdef NEED_MSCB
<a name="l00412"></a>00412 CFLAGS     += -DHAVE_MSCB
<a name="l00413"></a>00413 endif
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 $(BIN_DIR)/mlogger: $(BIN_DIR)/%: $(SRC_DIR)/%.cxx
<a name="l00416"></a>00416         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(ROOTLIBS) $(ODBC_LIBS) $(MYSQL_LIBS) $(LIBS)
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 $(BIN_DIR)/%:$(SRC_DIR)/%.c
<a name="l00419"></a>00419         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(LIBS)
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 $(BIN_DIR)/odbedit: $(SRC_DIR)/odbedit.c $(SRC_DIR)/cmdedit.c
<a name="l00422"></a>00422         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $(SRC_DIR)/odbedit.c $(SRC_DIR)/cmdedit.c $(LIB) $(LIBS)
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 ifdef NEED_MSCB
<a name="l00426"></a>00426 $(BIN_DIR)/mhttpd: $(LIB_DIR)/mhttpd.o $(LIB_DIR)/mgd.o $(LIB_DIR)/mscb.o $(LIB_DIR)/sequencer.o
<a name="l00427"></a>00427         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $^ $(LIB) $(ODBC_LIBS) $(LIBS) -lm
<a name="l00428"></a>00428 <span class="keywordflow">else</span>
<a name="l00429"></a>00429 $(BIN_DIR)/mhttpd: $(LIB_DIR)/mhttpd.o $(LIB_DIR)/mgd.o $(LIB_DIR)/sequencer.o
<a name="l00430"></a>00430         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $^ $(LIB) $(ODBC_LIBS) $(LIBS) -lm
<a name="l00431"></a>00431 endif
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 $(PROGS): $(LIBNAME)
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 #
<a name="l00436"></a>00436 # examples
<a name="l00437"></a>00437 #
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 $(BIN_DIR)/%:$(EXAM_DIR)/lowlevel/%.c
<a name="l00440"></a>00440         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(LIBS)
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 $(BIN_DIR)/%:$(EXAM_DIR)/basic/%.c
<a name="l00443"></a>00443         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(LIBS)
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 $(EXAMPLES): $(LIBNAME)
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 #
<a name="l00448"></a>00448 # midas library
<a name="l00449"></a>00449 #
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 $(LIBNAME): $(OBJS)
<a name="l00452"></a>00452         rm -f $@
<a name="l00453"></a>00453         ar -crv $@ $^
<a name="l00454"></a>00454 ifdef NEED_RANLIB
<a name="l00455"></a>00455         ranlib $@
<a name="l00456"></a>00456 endif
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 ifeq ($(OSTYPE),crosscompile)
<a name="l00459"></a>00459 %.so: $(OBJS)
<a name="l00460"></a>00460         rm -f $@
<a name="l00461"></a>00461         $(CXX) -shared -o $@ $^ $(LIBS) -lc
<a name="l00462"></a>00462 endif
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 ifeq ($(OSTYPE),linux)
<a name="l00465"></a>00465 %.so: $(OBJS)
<a name="l00466"></a>00466         rm -f $@
<a name="l00467"></a>00467         $(CXX) -shared -o $@ $^ $(LIBS) -lc
<a name="l00468"></a>00468 endif
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 ifeq ($(OSTYPE),darwin)
<a name="l00471"></a>00471 %.dylib: $(OBJS)
<a name="l00472"></a>00472         rm -f $@
<a name="l00473"></a>00473         g++ -dynamiclib -dylib -o $@ $^ $(LIBS) -lc
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 %.so: $(OBJS)
<a name="l00476"></a>00476         rm -f $@
<a name="l00477"></a>00477         g++ -bundle -flat_namespace -undefined suppress -o $@ $^ $(LIBS) -lc
<a name="l00478"></a>00478 endif
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="preprocessor">#</span>
<a name="l00481"></a>00481 <span class="preprocessor"></span><span class="preprocessor"># frontend and backend framework</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00483"></a>00483 <span class="preprocessor"></span>
<a name="l00484"></a>00484 $(LIB_DIR)/history_sql.o $(LIB_DIR)/history_midas.o $(LIB_DIR)/mhttpd.o $(LIB_DIR)/mlogger.o: history.h
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 $(LIB_DIR)/mfe.o: msystem.h midas.h midasinc.h mrpc.h
<a name="l00487"></a>00487 $(LIB_DIR)/fal.o: $(SRC_DIR)/fal.c msystem.h midas.h midasinc.h mrpc.h
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 $(LIB_DIR)/fal.o: $(SRC_DIR)/fal.c msystem.h midas.h midasinc.h mrpc.h
<a name="l00490"></a>00490         $(CXX) -Dextname -DMANA_LITE -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00491"></a>00491 $(LIB_DIR)/mana.o: $(SRC_DIR)/mana.c msystem.h midas.h midasinc.h mrpc.h
<a name="l00492"></a>00492         $(CC) -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00493"></a>00493 $(LIB_DIR)/hmana.o: $(SRC_DIR)/mana.c msystem.h midas.h midasinc.h mrpc.h
<a name="l00494"></a>00494         $(CC) -Dextname -DHAVE_HBOOK -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00495"></a>00495 ifdef ROOTSYS
<a name="l00496"></a>00496 $(LIB_DIR)/rmana.o: $(SRC_DIR)/mana.c msystem.h midas.h midasinc.h mrpc.h
<a name="l00497"></a>00497         $(CXX) -DUSE_ROOT -c $(CFLAGS) $(OSFLAGS) $(ROOTCFLAGS) -o $@ $&lt;
<a name="l00498"></a>00498 endif
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="preprocessor">#</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span><span class="preprocessor"># library objects</span>
<a name="l00502"></a>00502 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>
<a name="l00504"></a>00504 $(LIB_DIR)/mhttpd.o: $(LIB_DIR)/%.o: $(SRC_DIR)/%.cxx
<a name="l00505"></a>00505         $(CXX) -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 $(LIB_DIR)/%.o:$(SRC_DIR)/%.c
<a name="l00508"></a>00508         $(CC) -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 $(LIB_DIR)/%.o:$(SRC_DIR)/%.cxx
<a name="l00511"></a>00511         $(CXX) -c $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 $(LIB_DIR)/mxml.o:$(MXML_DIR)/mxml.c
<a name="l00514"></a>00514         $(CC) -c $(CFLAGS) $(OSFLAGS) -o $@ $(MXML_DIR)/mxml.c
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 $(LIB_DIR)/strlcpy.o:$(MXML_DIR)/strlcpy.c
<a name="l00517"></a>00517         $(CC) -c $(CFLAGS) $(OSFLAGS) -o $@ $(MXML_DIR)/strlcpy.c
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 ifdef NEED_MSCB
<a name="l00520"></a>00520 $(LIB_DIR)/mscb.o:$(MSCB_DIR)/mscb.c $(MSCB_DIR)/mscb.h
<a name="l00521"></a>00521         $(CXX) -c $(CFLAGS) $(OSFLAGS) -o $@ $(MSCB_DIR)/mscb.c
<a name="l00522"></a>00522 endif
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 $(LIB_DIR)/midas.o: msystem.h midas.h midasinc.h mrpc.h
<a name="l00525"></a>00525 $(LIB_DIR)/system.o: msystem.h midas.h midasinc.h mrpc.h
<a name="l00526"></a>00526 $(LIB_DIR)/mrpc.o: msystem.h midas.h mrpc.h
<a name="l00527"></a>00527 $(LIB_DIR)/odb.o: msystem.h midas.h midasinc.h mrpc.h
<a name="l00528"></a>00528 $(LIB_DIR)/mdsupport.o: msystem.h midas.h midasinc.h
<a name="l00529"></a>00529 $(LIB_DIR)/ftplib.o: msystem.h midas.h midasinc.h
<a name="l00530"></a>00530 $(LIB_DIR)/mxml.o: msystem.h midas.h midasinc.h $(MXML_DIR)/mxml.h
<a name="l00531"></a>00531 $(LIB_DIR)/alarm.o: msystem.h midas.h midasinc.h
<a name="l00532"></a>00532 
<a name="l00533"></a>00533 <span class="preprocessor">#</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span><span class="preprocessor"># utilities</span>
<a name="l00535"></a>00535 <span class="preprocessor"></span><span class="preprocessor">#</span>
<a name="l00536"></a>00536 <span class="preprocessor"></span>$(BIN_DIR)/%:$(UTL_DIR)/%.c
<a name="l00537"></a>00537         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(LIBS)
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 
<a name="l00540"></a>00540 $(BIN_DIR)/mcnaf: $(UTL_DIR)/mcnaf.c $(DRV_DIR)/camac/camacrpc.c
<a name="l00541"></a>00541         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $(UTL_DIR)/mcnaf.c $(DRV_DIR)/camac/camacrpc.c $(LIB) $(LIBS)
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 $(BIN_DIR)/mdump: $(UTL_DIR)/mdump.c $(SRC_DIR)/mdsupport.c
<a name="l00544"></a>00544         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $(UTL_DIR)/mdump.c $(SRC_DIR)/mdsupport.c $(LIB) $(LIBS)
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 $(BIN_DIR)/mfe_link_test: $(SRC_DIR)/mfe.c
<a name="l00547"></a>00547         $(CC) $(CFLAGS) $(OSFLAGS) -DLINK_TEST -o $@ $(SRC_DIR)/mfe.c $(LIB) $(LIBS)
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 $(BIN_DIR)/mana_link_test: $(SRC_DIR)/mana.c
<a name="l00550"></a>00550         $(CC) $(CFLAGS) $(OSFLAGS) -DLINK_TEST -o $@ $(SRC_DIR)/mana.c $(LIB) $(LIBS)
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 $(BIN_DIR)/mhdump: $(UTL_DIR)/mhdump.cxx
<a name="l00553"></a>00553         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $&lt;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555 $(BIN_DIR)/mtransition: $(SRC_DIR)/mtransition.cxx
<a name="l00556"></a>00556         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $&lt; $(LIB) $(LIBS)
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 $(BIN_DIR)/mh2sql: $(UTL_DIR)/mh2sql.cxx
<a name="l00559"></a>00559         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $^ $(ODBC_LIBS) $(LIBS)
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 $(BIN_DIR)/lazylogger: $(SRC_DIR)/lazylogger.cxx $(SRC_DIR)/mdsupport.c
<a name="l00562"></a>00562         $(CXX) $(CFLAGS) $(OSFLAGS) -o $@ $&lt;  $(SRC_DIR)/mdsupport.c $(LIB) $(LIBS)
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 $(BIN_DIR)/dio: $(UTL_DIR)/dio.c
<a name="l00565"></a>00565         $(CC) $(CFLAGS) $(OSFLAGS) -o $@ $(UTL_DIR)/dio.c
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 $(BIN_DIR)/stripchart.tcl: $(UTL_DIR)/stripchart.tcl
<a name="l00568"></a>00568         cp -f $(UTL_DIR)/stripchart.tcl $(BIN_DIR)/. 
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 #####################################################################
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="keyword">static</span>:
<a name="l00574"></a>00574         rm -f $(PROGS)
<a name="l00575"></a>00575         make USERFLAGS=-<span class="keyword">static</span>
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 <span class="preprocessor">#####################################################################</span>
<a name="l00578"></a>00578 <span class="preprocessor"></span>
<a name="l00579"></a>00579 install:
<a name="l00580"></a>00580 <span class="preprocessor"># system programs and utilities</span>
<a name="l00581"></a>00581 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00582"></a>00582         @echo <span class="stringliteral">&quot;... Installing programs and utilities to $(SYSBIN_DIR)&quot;</span>
<a name="l00583"></a>00583         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00584"></a>00584 
<a name="l00585"></a>00585         @<span class="keywordflow">for</span> file in `find $(BIN_DIR) -type f | grep -v .svn` ; \
<a name="l00586"></a>00586           <span class="keywordflow">do</span> \
<a name="l00587"></a>00587           install -v -D -m 755 $$file $(SYSBIN_DIR)/`basename $$file` ; \
<a name="l00588"></a>00588           <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>
<a name="l00589"></a>00589 
<a name="l00590"></a>00590         install -v -m 755 $(UTL_DIR)/mcleanup $(SYSBIN_DIR)
<a name="l00591"></a>00591         if [ -f $(SYSBIN_DIR)/dio ]; then chmod +s $(SYSBIN_DIR)/dio ; fi
<a name="l00592"></a>00592         if [ -f $(SYSBIN_DIR)/mhttpd ]; then chmod +s $(SYSBIN_DIR)/mhttpd; fi
<a name="l00593"></a>00593         if [ -f $(SYSBIN_DIR)/webpaw ]; then chmod +s $(SYSBIN_DIR)/webpaw; fi
<a name="l00594"></a>00594         ln -fs $(SYSBIN_DIR)/stripchart.tcl $(SYSBIN_DIR)/stripchart
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="preprocessor"># include</span>
<a name="l00597"></a>00597 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00598"></a>00598         @echo <span class="stringliteral">&quot;... Installing include files to $(SYSINC_DIR)&quot;</span>
<a name="l00599"></a>00599         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00600"></a>00600 
<a name="l00601"></a>00601         @<span class="keywordflow">for</span> file in `find $(INC_DIR) -type f | grep -v .svn` ; \
<a name="l00602"></a>00602           <span class="keywordflow">do</span> \
<a name="l00603"></a>00603           install -v -D -m 644 $$file $(SYSINC_DIR)/`basename $$file` ; \
<a name="l00604"></a>00604           <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="preprocessor"># library + objects</span>
<a name="l00607"></a>00607 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00608"></a>00608         @echo <span class="stringliteral">&quot;... Installing library and objects to $(SYSLIB_DIR)&quot;</span>
<a name="l00609"></a>00609         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00610"></a>00610 
<a name="l00611"></a>00611         @<span class="keywordflow">for</span> i in libmidas.a mana.o mfe.o fal.o ; \
<a name="l00612"></a>00612           <span class="keywordflow">do</span> \
<a name="l00613"></a>00613           install -v -D -m 644 $(LIB_DIR)/$$i $(SYSLIB_DIR)/$$i ; \
<a name="l00614"></a>00614           <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 ifdef CERNLIB
<a name="l00617"></a>00617         install -v -m 644 $(LIB_DIR)/hmana.o $(SYSLIB_DIR)/hmana.o
<a name="l00618"></a>00618 <span class="keywordflow">else</span>
<a name="l00619"></a>00619         rm -fv $(SYSLIB_DIR)/hmana.o
<a name="l00620"></a>00620         chmod +s $(SYSBIN_DIR)/mhttpd
<a name="l00621"></a>00621 endif
<a name="l00622"></a>00622 ifdef ROOTSYS
<a name="l00623"></a>00623         install -v -m 644 $(LIB_DIR)/rmana.o $(SYSLIB_DIR)/rmana.o
<a name="l00624"></a>00624 <span class="keywordflow">else</span>
<a name="l00625"></a>00625         rm -fv $(SYSLIB_DIR)/rmana.o
<a name="l00626"></a>00626 endif
<a name="l00627"></a>00627         -rm -fv $(SYSLIB_DIR)/libmidas.so
<a name="l00628"></a>00628         -install -v -m 644 $(LIB_DIR)/libmidas-shared.so $(SYSLIB_DIR)
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="preprocessor"># drivers</span>
<a name="l00631"></a>00631 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00632"></a>00632         @echo <span class="stringliteral">&quot;... Installing drivers to $(PREFIX)/drivers&quot;</span>
<a name="l00633"></a>00633         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00634"></a>00634 
<a name="l00635"></a>00635         @<span class="keywordflow">for</span> file in `find $(DRV_DIR) -type f | grep -v .svn` ; \
<a name="l00636"></a>00636           <span class="keywordflow">do</span> \
<a name="l00637"></a>00637           install -v -D -m 644 $$file $(PREFIX)/$$file ;\
<a name="l00638"></a>00638           <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 <span class="preprocessor">#--------------------------------------------------------------</span>
<a name="l00641"></a>00641 <span class="preprocessor"></span><span class="preprocessor"># minimal_install</span>
<a name="l00642"></a>00642 <span class="preprocessor"></span>minimal_install:
<a name="l00643"></a>00643 <span class="preprocessor"># system programs</span>
<a name="l00644"></a>00644 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00645"></a>00645         @echo <span class="stringliteral">&quot;... Minimal Install for programs to $(SYSBIN_DIR)&quot;</span>
<a name="l00646"></a>00646         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00647"></a>00647 
<a name="l00648"></a>00648         @<span class="keywordflow">for</span> i in mserver mhttpd; \
<a name="l00649"></a>00649           <span class="keywordflow">do</span> \
<a name="l00650"></a>00650           install -v -m 755 $(BIN_DIR)/$$i $(SYSBIN_DIR) ; \
<a name="l00651"></a>00651           <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 ifeq ($(OSTYPE),linux)
<a name="l00654"></a>00654         install -v -m 755 $(BIN_DIR)/dio $(SYSBIN_DIR)
<a name="l00655"></a>00655 endif
<a name="l00656"></a>00656         install -v -m 755 $(UTL_DIR)/mcleanup $(SYSBIN_DIR)
<a name="l00657"></a>00657         if [ -f $(SYSBIN_DIR)/dio ]; then chmod +s $(SYSBIN_DIR)/dio; fi
<a name="l00658"></a>00658         if [ -f $(SYSBIN_DIR)/mhttpd ]; then chmod +s $(SYSBIN_DIR)/mhttpd; fi
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 <span class="preprocessor"># utilities</span>
<a name="l00661"></a>00661 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00662"></a>00662         @echo <span class="stringliteral">&quot;... No utilities install to $(SYSBIN_DIR)&quot;</span>
<a name="l00663"></a>00663         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 <span class="preprocessor"># include</span>
<a name="l00666"></a>00666 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00667"></a>00667         @echo <span class="stringliteral">&quot;... No include install to $(SYSINC_DIR)&quot;</span>
<a name="l00668"></a>00668         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="preprocessor"># library + objects</span>
<a name="l00671"></a>00671 <span class="preprocessor"></span>        @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00672"></a>00672         @echo <span class="stringliteral">&quot;... No library Install to $(SYSLIB_DIR)&quot;</span>
<a name="l00673"></a>00673         @echo <span class="stringliteral">&quot;... &quot;</span>
<a name="l00674"></a>00674 
<a name="l00675"></a>00675 indent:
<a name="l00676"></a>00676         find . -name <span class="stringliteral">&quot;*.[hc]&quot;</span> -exec indent -kr -nut -i3 -l90 {} \;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678 clean:
<a name="l00679"></a>00679         -rm -f $(LIB_DIR)<span class="comment">/*.o $(LIB_DIR)/*.a $(LIB_DIR)/*.so $(LIB_DIR)/*.dylib</span>
<a name="l00680"></a>00680 <span class="comment"></span>
<a name="l00681"></a>00681 <span class="comment">mrproper : clean</span>
<a name="l00682"></a>00682 <span class="comment">        rm -rf $(OS_DIR)</span>
<a name="l00683"></a>00683 <span class="comment">        rm -rf vxworks/68kobj vxworks/ppcobj</span>
<a name="l00684"></a>00684 <span class="comment"></span>
<a name="l00685"></a>00685 <span class="comment">check-mxml :</span>
<a name="l00686"></a>00686 <span class="comment">ifeq ($(NEED_STRLCPY), 1)</span>
<a name="l00687"></a>00687 <span class="comment">        @if [ ! -e $(MXML_DIR)/strlcpy.h ]; then \</span>
<a name="l00688"></a>00688 <span class="comment">          echo &quot;please download mxml.&quot;; \</span>
<a name="l00689"></a>00689 <span class="comment">          echo &quot;http://midas.psi.ch/htmldoc/quickstart.html&quot;; \</span>
<a name="l00690"></a>00690 <span class="comment">          exit 1; \</span>
<a name="l00691"></a>00691 <span class="comment">        fi</span>
<a name="l00692"></a>00692 <span class="comment">endif</span>
<a name="l00693"></a>00693 <span class="comment">        @if [ ! -e $(MXML_DIR)/mxml.h ]; then \</span>
<a name="l00694"></a>00694 <span class="comment">          echo &quot;please download mxml.&quot;; \</span>
<a name="l00695"></a>00695 <span class="comment">          echo &quot;http://midas.psi.ch/htmldoc/quickstart.html&quot;; \</span>
<a name="l00696"></a>00696 <span class="comment">          exit 1; \</span>
<a name="l00697"></a>00697 <span class="comment">        fi</span>
<a name="l00698"></a>00698 <span class="comment"></span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

