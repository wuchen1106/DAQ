<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Javascript Built-In library</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="RunControl.html">SECTION 5: Run Control</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_run_control.html">Run Control Programs</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd.html">mhttpd: the MIDAS Web-based Run Control utility</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_Custom_page.html">Custom pages</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_custom_js_lib.html">JavaScript built-in library mhttpd.js</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="RC_mhttpd_js">Javascript Built-In library </a></h1> 
<script type="text/javascript">
// pages parameters: back index next {top bottom}
// this is an extra page inserted in, so both previous and next go to the same place
pages( "RC_mhttpd_custom_js_lib", "RunControl",  "RC_mhttpd_custom_js_lib","RC_mhttpd_js",  "end" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
 <br/>
</p>
<p>The following code is the Javascript Built-in library <b>mhttpd.js</b> (version 4505)</p>
<div class="fragment"><pre class="fragment">document.onmousemove = getMouseXY;

function getMouseXY(e)
{
   var x = e.pageX;
   var y = e.pageY;
   var p = <span class="stringliteral">&apos;abs: &apos;</span> + x + <span class="charliteral">&apos;/&apos;</span> + y;
   i = document.getElementById(<span class="stringliteral">&apos;refimg&apos;</span>);
   <span class="keywordflow">if</span> (i == null)
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
   document.body.style.cursor = <span class="stringliteral">&apos;crosshair&apos;</span>;
   x -= i.offsetLeft;
   y -= i.offsetTop;
   <span class="keywordflow">while</span> (i = i.offsetParent) {
      x -= i.offsetLeft;
      y -= i.offsetTop;
   }
   p += <span class="stringliteral">&apos;   rel: &apos;</span> + x + <span class="charliteral">&apos;/&apos;</span> + y;
   window.status = p;
   <span class="keywordflow">return</span> <span class="keyword">true</span>;
}

function XMLHttpRequestGeneric()
{
   var request;
   <span class="keywordflow">try</span> {
      request = <span class="keyword">new</span> XMLHttpRequest(); <span class="comment">// Firefox, Opera 8.0+, Safari</span>
   }
   <span class="keywordflow">catch</span> (e) {
      <span class="keywordflow">try</span> {
         request = <span class="keyword">new</span> ActiveXObject(<span class="stringliteral">&apos;Msxml2.XMLHTTP&apos;</span>); <span class="comment">// Internet Explorer</span>
      }
      <span class="keywordflow">catch</span> (e) {
         <span class="keywordflow">try</span> {
            request = <span class="keyword">new</span> ActiveXObject(<span class="stringliteral">&apos;Microsoft.XMLHTTP&apos;</span>);
         }
         <span class="keywordflow">catch</span> (e) {
           alert(<span class="stringliteral">&apos;Your browser does not support AJAX!&apos;</span>);
           <span class="keywordflow">return</span> undefined;
         }
      }
   }
  <span class="keywordflow">return</span> request;
}

function ODBSet(path, value, pwdname)
{
   var value, request, url;

   <span class="keywordflow">if</span> (pwdname != undefined)
      pwd = prompt(<span class="stringliteral">&apos;Please enter password&apos;</span>, <span class="stringliteral">&apos;&apos;</span>);
   <span class="keywordflow">else</span>
      pwd = <span class="stringliteral">&apos;&apos;</span>;

   request = XMLHttpRequestGeneric();

   url = <span class="stringliteral">&apos;?cmd=jset&amp;odb=&apos;</span> + path + <span class="stringliteral">&apos;&amp;value=&apos;</span> + value;

   <span class="keywordflow">if</span> (pwdname != undefined)
      url += <span class="stringliteral">&apos;&amp;pnam=&apos;</span> + pwdname;

   request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);

   <span class="keywordflow">if</span> (pwdname != undefined)
     request.setRequestHeader(<span class="stringliteral">&apos;Cookie&apos;</span>, <span class="stringliteral">&apos;cpwd=&apos;</span>+pwd);

   request.send(null);

   <span class="keywordflow">if</span> (request.status != 200 || request.responseText != <span class="stringliteral">&apos;OK&apos;</span>)
      alert(<span class="stringliteral">&apos;ODBSet error:\nPath: &apos;</span>+path+<span class="stringliteral">&apos;\nHTTP Status: &apos;</span>+request.status+<span class="stringliteral">&apos;\nMe</span>
<span class="stringliteral">ssage: &apos;</span>+request.responseText+<span class="charliteral">&apos;\n&apos;</span>+document.location) ;
}

function ODBGet(path, format, defval, len, type)
{
   request = XMLHttpRequestGeneric();

   var url = <span class="stringliteral">&apos;?cmd=jget&amp;odb=&apos;</span> + path;
   <span class="keywordflow">if</span> (format != undefined &amp;&amp; format != <span class="stringliteral">&apos;&apos;</span>)
      url += <span class="stringliteral">&apos;&amp;format=&apos;</span> + format;
   request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
   request.send(null);

   <span class="keywordflow">if</span> (path.match(/[*]/)) {
      <span class="keywordflow">if</span> (request.responseText == null)
         <span class="keywordflow">return</span> null;
     <span class="keywordflow">if</span> (request.responseText == <span class="stringliteral">&apos;&lt;DB_NO_KEY&gt;&apos;</span>) {
         url = <span class="stringliteral">&apos;?cmd=jset&amp;odb=&apos;</span> + path + <span class="stringliteral">&apos;&amp;value=&apos;</span> + defval + <span class="stringliteral">&apos;&amp;len=&apos;</span> + len + <span class="stringliteral">&apos;</span>
<span class="stringliteral">&amp;type=&apos;</span> + type;

         request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
         request.send(null);
         <span class="keywordflow">return</span> defval;
      } <span class="keywordflow">else</span> {
         var array = request.responseText.split(<span class="charliteral">&apos;\n&apos;</span>);
         <span class="keywordflow">return</span> array;
      }
   } <span class="keywordflow">else</span> {
      <span class="keywordflow">if</span> ((request.responseText == <span class="stringliteral">&apos;&lt;DB_NO_KEY&gt;&apos;</span> ||
           request.responseText == <span class="stringliteral">&apos;&lt;DB_OUT_OF_RANGE&gt;&apos;</span>) &amp;&amp; defval != undefined)
 {
         url = <span class="stringliteral">&apos;?cmd=jset&amp;odb=&apos;</span> + path + <span class="stringliteral">&apos;&amp;value=&apos;</span> + defval + <span class="stringliteral">&apos;&amp;len=&apos;</span> + len + <span class="stringliteral">&apos;</span>
<span class="stringliteral">&amp;type=&apos;</span> + type;

         request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
         request.send(null);
         <span class="keywordflow">return</span> defval;
      }
      <span class="keywordflow">return</span> request.responseText;
   }
}

function ODBKey(path)
{
   request = XMLHttpRequestGeneric();

   var url = <span class="stringliteral">&apos;?cmd=jkey&amp;odb=&apos;</span> + path;
   request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
   request.send(null);
   <span class="keywordflow">if</span> (request.responseText == null)
      <span class="keywordflow">return</span> null;
   var key = request.responseText.split(<span class="charliteral">&apos;\n&apos;</span>);
   this.name = key[0];
   this.type = key[1];
   this.num_values = key[2];
   this.item_size = key[3];
}

function ODBRpc_rev0(name, rpc, args)
{
   request = XMLHttpRequestGeneric();

   var url = <span class="stringliteral">&apos;?cmd=jrpc_rev0&amp;name=&apos;</span> + name + <span class="stringliteral">&apos;&amp;rpc=&apos;</span> + rpc;
   <span class="keywordflow">for</span> (var i = 2; i &lt; arguments.length; i++) {
     url += <span class="stringliteral">&apos;&amp;arg&apos;</span>+(i-2)+<span class="charliteral">&apos;=&apos;</span>+arguments[i];
   };
   request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
   request.send(null);
   <span class="keywordflow">if</span> (request.responseText == null)
      <span class="keywordflow">return</span> null;
   this.reply = request.responseText.split(<span class="charliteral">&apos;\n&apos;</span>);
}

function ODBGetMsg(n)
{
   request = XMLHttpRequestGeneric();

   var url = <span class="stringliteral">&apos;?cmd=jmsg&amp;n=&apos;</span> + n;
   request.open(<span class="stringliteral">&apos;GET&apos;</span>, url, <span class="keyword">false</span>);
   request.send(null);

   <span class="keywordflow">if</span> (n &gt; 1) {
     var array = request.responseText.split(<span class="charliteral">&apos;\n&apos;</span>);
      <span class="keywordflow">return</span> array;
   } <span class="keywordflow">else</span>
      <span class="keywordflow">return</span> request.responseText;
}

function ODBEdit(path)
{
   var value = ODBGet(path);
   var new_value = prompt(<span class="stringliteral">&apos;Please enter new value&apos;</span>, value);
   <span class="keywordflow">if</span> (new_value != undefined) {
      ODBSet(path, new_value);
      window.location.reload();
   }
}

<span class="comment">/* MIDAS type definitions */</span>
var TID_BYTE = 1;
var TID_SBYTE = 2;
var TID_CHAR = 3;
var TID_WORD = 4;
var TID_SHORT = 5;
var TID_DWORD = 6;
var TID_INT = 7;
var TID_BOOL = 8;
var TID_FLOAT = 9;
var TID_DOUBLE = 10;
var TID_BITFIELD = 11;
var TID_STRING = 12;
var TID_ARRAY = 13;
var TID_STRUCT = 14;
var TID_KEY = 15;
var TID_LINK = 16;
</pre></div><p> <a class="anchor" id="end"></a>  
<script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_custom_features", "RunControl", "RC_mhttpd_custom_features","RC_mhttpd_js",  "" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
 <br/>
 </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

