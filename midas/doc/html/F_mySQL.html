<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Logging information to a mySQL database</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="Features.html">SECTION 4: Features</a>&nbsp;&raquo&nbsp;<a class="el" href="F_Logging.html">Logging in MIDAS</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="F_mySQL">Logging information to a mySQL database </a></h1><p><a class="anchor" id="idx_Logging_mySQL"></a> <a class="anchor" id="idx_mySQL"></a>  
<script type="text/javascript">
pages( "F_Messaging",  "Features","F_History_logging","F_mySQL","end"); // back index next {top bottom}
// sections params:   last section; top of this section; next section
sections("Quickstart", "Features", "RunControl");
</script>
<p><br/>
 <a class="anchor" id="idx_mySQL_database"></a> </p>
<h2><a class="anchor" id="F_Logger_mySQL">
mySQL</a></h2>
<p>The logger is able to store information in a <b>mySQL</b> database. This option is an alternative to the <a class="el" href="DataAnalysis.html#DA_run_log_file">runlog.txt</a> file handled by the <a class="el" href="DataAnalysis.html#DA_Midas_Analyzer">MIDAS Analyzer</a> . The two main advantages using the SQL are:</p>
<ul>
<li>The recording is done by the logger and therefore is independent of the user analyzer.</li>
<li>The definition of the <a class="el" href="structparameters.html">parameters</a> to be recorded in the database is entirely setup in the ODB under the <span class="odb">/Logger/SQL</span> tree.</li>
</ul>
<p>The SQL option is enabled by the preprocessor flag <a class="el" href="BuildingOptions.html#BO_NEED_MYSQL">NEED_MYSQL</a> at <a class="el" href="BuildingOptions.html#BO_building_option">build time</a>. This option, when enabled, will cause <a class="el" href="F_Logging.html#F_mlogger_utility">mlogger</a> to create a subtree <span class="odb">SQL</span> under the <a class="el" href="F_Logging_Data.html#F_Logger_tree">/Logger ODB tree</a> . This tree contains information for mySQL access with the predefined mySQL database name <em>"Midas"</em> and table <em>"Runlog"</em>. Under two dedicated subdirectories <b>Link_BOR</b> and <b>Link_EOR</b>, predefined links exists which will be used at BOR and EOR respectively for storing parameter values into the database. These elements are ODB links allowing the user to extend the list with any parameter in the ODB database. This logger mySQL option may replace or complement the <a class="el" href="DataAnalysis.html#DA_run_log_file">runlog.txt</a> functionality of the <a class="el" href="analyzer_8c.html#a8e03cbe2637bd6f4488a659c9f23d29e">ana_end_of_run()</a> function from the <a class="el" href="analyzer_8c.html">analyzer.c</a>.</p>
<p><a class="anchor" id="F_Logger_SQL_tree"></a> The following example shows a <span class="odb">/Logger/SQL</span> tree as created by <a class="el" href="F_Logging.html#F_mlogger_utility">mlogger</a> See <a class="el" href="F_mySQL.html#F_Logger_SQL_keys">below</a> for an explanation of the meaning of each key. </p>
<div class="fragment"><pre class="fragment">[local:midas:S]/Logger&gt;ls -lr SQL
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
SQL                         DIR
    Create database             <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>    1     4     27s  0   RWD  n
    Write data                  <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>    1     4     27s  0   RWD  n
    Hostname                    STRING  1     80    27s  0   RWD  localhost
    Username                    STRING  1     80    27s  0   RWD  root
    Password                    STRING  1     80    27s  0   RWD
    Database                    STRING  1     32    27s  0   RWD  midas
    Table                       STRING  1     80    27s  0   RWD  Runlog
    Logfile                     STRING  1     80    27s  0   RWD  sql.log
    Links BOR                   DIR
        Run number              LINK    1     20    58s  0   RWD  /Runinfo/Run number
        Start <a class="code" href="structHIST__RECORD.html#a82235a34fe6b068c106c608b3893aff7">time</a>              LINK    1     20    58s  0   RWD  /Runinfo/Start <a class="code" href="structHIST__RECORD.html#a82235a34fe6b068c106c608b3893aff7">time</a>
    Links EOR                   DIR
        Stop <a class="code" href="structHIST__RECORD.html#a82235a34fe6b068c106c608b3893aff7">time</a>               LINK    1     19    4m   0   RWD  /Runinfo/Stop <a class="code" href="structHIST__RECORD.html#a82235a34fe6b068c106c608b3893aff7">time</a>
</pre></div><h2><a class="anchor" id="F_Logger_SQL_keys">
Explanation of the keys in the ODB /Logger/SQL tree</a></h2>
<p>An example of a <span class="odb">/Logger/SQL</span> tree is shown <a class="el" href="F_mySQL.html#F_Logger_SQL_tree">above</a>. The table below serves as an index to the explanation of each key in this tree.</p>
<p><br/>
 </p>
<table style="text-align: left; width: 30%;" border="0" cellpadding="0" cellspacing="0">
<caption align="bottom">The ODB /Logger/SQL tree. Click on a key for explanation. </caption>
<tr>
<td style="vertical-align: top;"><p><a class="el" href="F_Logging_Data.html#F_Logger_tree">/Logger</a> <br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><b>/SQL</b>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Create_Database">Create Database</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Write_data">Write data</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Hostname">Hostname</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Username">Username</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Password">Password</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Database">Database</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Table">Table</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_SQL_Links_BOR">Links BOR</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><a class="el" href="F_mySQL.html#F_Logger_Links_EOR">Links EOR</a>  </p>
</td><td style="vertical-align: top;"><p><br/>
  </p>
</td><td style="vertical-align: top;"><p><br/>
   </p>
</td></tr>
</table>
<p><br/>
</p>
<p><br/>
 </p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2" cellspacing="2">
<caption align="bottom">Above: meaning of keys in the /Logger/SQL ODB tree </caption>
<tr>
<td colspan="2" style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>Keys in the ODB tree <span class="odb">/Logger/SQL</span>   </p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>ODB Key  </p>
</td><td style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>Explanation  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Create_Database"></a> Create Database  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>BOOL value. If this flag is set, the SQL database will be created.  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Write_data"></a> Write data  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>BOOL value. If this flag is set , the data will be written to the SQL database. (provided the logger is also set to <a class="el" href="F_Logging_Data.html#F_Logger_Write_Data">write the data</a>).  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Hostname"></a> Hostname  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>The name of the host where the SQL database is located.  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Username"></a> Username  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>Username for access to the SQL Database.  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Password"></a> Password  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>(Encoded) Password for access to the SQL Database.  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Database"></a> Database  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>Name of the SQL Database (predefined as "midas").  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Table"></a> Table  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>Name of the Table in the SQL Database (predefined as "Runlog").  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_SQL_Links_BOR"></a> Links BOR  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>This directory contains links to <a class="el" href="structparameters.html">parameters</a> in the ODB that are to be saved in the SQL Database at Begin-of-run. The links</p>
<ul>
<li>Run number</li>
<li>Start time are created automatically by the logger the first time it runs. The user may add other links as desired.  </li>
</ul>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: lightyellow; font-weight: bold; text-align: left;"><p><a class="anchor" id="F_Logger_Links_EOR"></a> Links EOR  </p>
</td><td style="vertical-align: top; font-weight: normal; text-align: left;"><p>This directory contains links to <a class="el" href="structparameters.html">parameters</a> in the ODB that are to be saved in the SQL Database at End-of-run. The link</p>
<ul>
<li>Stop time is created automatically by the logger the first time it runs. The user may add other links as desired.   </li>
</ul>
</td></tr>
</table>
<p><br/>
  
<script type="text/javascript">
pages( "F_Messaging",  "Features","F_History_logging","F_mySQL",""); // back index next {top bottom}
// sections params:   last section; top of this section; next section
sections("Quickstart", "Features", "RunControl");
</script>
<p><a class="anchor" id="end"></a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

