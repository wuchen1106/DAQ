<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Using odbedit</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="RunControl.html">SECTION 5: Run Control</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_run_control.html">Run Control Programs</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_odbedit.html">odbedit: The ODB Editor and Run Control utility</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="RC_odbedit_examples">Using odbedit </a></h1><p><a class="anchor" id="idx_odbedit-utility_examples"></a> <br/>
  
<script type="text/javascript">
pages( "RC_odbedit_utility",  "RunControl","RC_mhttpd","RC_odbedit_examples",  "end" ); // back index next {top bottom}
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
<ul>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_prompt">Setting odbedit's prompt</a> <ul>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_prompt_examples">Examples of changing the odbedit prompt:</a> </li>
</ul>
</li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_create_ODB">ODB Creation</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_keynames">ODB Key names: UPPER/lower case, spaces in key names</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_corrupted">Corrupted ODB</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_extcommand">Using the external command (the -c argument)</a> <ul>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_script_examples">Examples of scripts sending odbedit commands</a> <ul>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_example_script_1">Shell script run at end-of-run</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_example_script_2">Shell script run at beginning of run</a> </li>
</ul>
</li>
</ul>
</li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_cmd_examples">Examples using odbedit commands</a> <ul>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_cd">cd - change current directory</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_chat">chat - enter chat mode</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_chmod">chmod - change access mode</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_cr">create - create a key of a certain type</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_export">export - export ASCII file</a> </li>
<li>
<a class="el" href="RC_odbedit_utility.html#RC_odbedit_help">help - list of commands</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_import">import - import ASCII file</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_ln">ln - create a link</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_load">load - load database from a saved file</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_ls">ls - list the database entries</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_make">make - create experim.h</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_mkdir">mkdir - make new subdirectory</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_move">move - move a key to a new position</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_msg">msg - send a user message</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_old">old - display old messages</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_passwd">passwd - change/set up the MIDAS password</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_pwd">pwd - show current directory</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_rename">rename - rename a key</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_rm">rm/del - delete a key and its subkeys</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_set">set - set the value of a key</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_sor">sor - show open records</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_save">save - save database at current position</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_scl">scl - show active clients</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_sh">sh - shutdown a client</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_start">start - start a run</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_stop">stop - stop a run</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_trunc">trunc - truncate a key</a> </li>
<li>
<a class="el" href="RC_odbedit_examples.html#RC_odbedit_webpasswd">webpasswd - change/set up the web password for mhttpd</a> </li>
</ul>
</li>
</ul>
<hr/>
<h2><a class="anchor" id="RC_odbedit_prompt">
Setting odbedit's prompt</a></h2>
<p>When "odbedit" is entered on the command line, it returns a prompt, e.g. </p>
<div class="fragment"><pre class="fragment">odbedit
[local:midas:S]/&gt;
</pre></div><p> The format of the <b>prompt</b> (in the above example <b> [local:midas:S]/&gt; </b> ) is controlled in the ODB by the key <b> /System/Prompt </b>. The default value is shown below: </p>
<div class="fragment"><pre class="fragment">odbedit
[local:midas:S]/&gt;cd /System/
[local:midas:S]/System&gt;ls
Clients                         
Tmp                             
Client Notify                   0
Prompt                          [%h:%e:%s]%p&gt;
</pre></div><p> <br/>
 where the meanings of the Prompt symbols are shown below:</p>
<table style="text-align: center; width: 25%;" border="1" cellpadding="2" cellspacing="2">
<caption align="bottom">Above: Meaning of Prompt symbols </caption>
<tr>
<td style="vertical-align: top;   background-color: rgb(255, 255, 153);"><p><b>Symbol</b>  </p>
</td><td style="vertical-align: top;   background-color: rgb(255, 255, 153); "><p><b>Substitute</b>   </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>h</b> </p>
</td><td style="vertical-align: top;"><p>Host name  </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>e</b>  </p>
</td><td style="vertical-align: top;"><p>Experiment name  </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>s</b>  </p>
</td><td style="vertical-align: top;"><p>Run state symbols (U,S,P,R)  </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>S</b>  </p>
</td><td style="vertical-align: top;"><p>Run state long form (Unknown,Stopped,Pause,Running)  </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>p</b>  </p>
</td><td style="vertical-align: top;"><p>Current ODB Path  </p>
</td></tr>
<tr>
<td style="vertical-align: top;"><p>%<b>t</b>  </p>
</td><td style="vertical-align: top;"><p>Current time  </p>
</td></tr>
</table>
<h3><a class="anchor" id="RC_odbedit_prompt_examples">
Examples of changing the odbedit prompt:</a></h3>
<ol>
<li>
Set the prompt to show the <b> long-form of the run state </b> <div class="fragment"><pre class="fragment">  [local:midas:S]/System&gt;<span class="keyword">set</span> Prompt <span class="stringliteral">&quot;[%h:%e:%S]%p&gt;&quot;</span>
  [local:midas:Stopped]/System&gt;
</pre></div> </li>
<li>
<p class="startli">Set the prompt to the phrase <b>my_prompt</b> </p>
<div class="fragment"><pre class="fragment">    [local:midas:Stopped]/System&gt;<span class="keyword">set</span> Prompt my_prompt&gt;
    my_prompt&gt;
</pre></div><p class="endli"></p>
</li>
<li>
<p class="startli">Set the prompt to <b> name the fields </b> (i.e. Host, Expt, State, Path) </p>
<div class="fragment"><pre class="fragment">    my_prompt&gt;<span class="keyword">set</span> Prompt [Host:%h-Expt:%e:State:%s]Path:%p&gt;
    [Host:local-Expt:midas-State:S]Path:/System&gt;
</pre></div><p class="endli"></p>
</li>
<li>
<p class="startli">Set the prompt to the <b>current</b> <b>time</b> </p>
<div class="fragment"><pre class="fragment">    [Host:local-Expt:midas-State:S]Path:/System&gt;<span class="keyword">set</span> Prompt <span class="stringliteral">&quot;%t&gt;&quot;</span>
    13:29:08&gt;
</pre></div><hr/>
<p class="endli"><a class="anchor" id="idx_ODB_create"></a> </p>
</li>
</ol>
<h2><a class="anchor" id="RC_odbedit_create_ODB">
ODB Creation</a></h2>
<p>After installation of MIDAS, before any other tasks are started, the ODB is created for the first time by starting the <a class="el" href="RC_odbedit_utility.html">odbedit utility</a>. This automatically creates all the shared-memory files needed for the experiment. By default, these files will be created in the area indicated in the <a class="el" href="Q_Linux.html#Q_Linux_Exptab">exptab file</a> for your experiment. <br/>
 If MIDAS_EXPT_NAME is defined, this experiment will be used, unless superceded by the -e option (see <a class="el" href="RC_odbedit_utility.html">odbedit</a>). <br/>
 </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online]$ ls .*.SHM
ls: No match.
[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;quit
[mpet@titan01 ~/online]$ ls .*.SHM
.ALARM.SHM  .ELOG.SHM  .HISTORY.SHM  .MSG.SHM  .ODB.SHM  .SYSMSG.SHM  .SYSTEM.SHM
</pre></div><p>The default size of the ODB is 128KB. A different size can be specified by using the -s option (see <a class="el" href="RC_odbedit_utility.html">odbedit utility</a>) e.g. </p>
<div class="fragment"><pre class="fragment">odbedit -s 204000
</pre></div><p>The other shared memory files created are the system buffer .SYSTEM.SHM, the <a class="el" href="F_Messaging.html">system messaging</a> buffer .SYSMSG.SHM, the message buffer .MSG.SHM, </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000016">Todo:</a></b></dt><dd>( MSG.SHM what for? )</dd></dl>
<p>the <a class="el" href="F_History_logging.html">history</a> buffer .HISTORY.SHM, the <a class="el" href="F_Elog.html">Elog</a> buffer .ELOG.SHM, the alarm buffer .ALARM.SHM . <br/>
</p>
<p><b>Note:</b> <br/>
to change the size of the event buffer(s) (e.g. SYSTEM buffer) see <a class="el" href="FE_event_buffer_size.html">Increase the Event Buffer Size(s)</a> . <br/>
 </p>
<div style="color: green; font-size: 125%;"> Running odbedit for the first time creates the trees /Runinfo, /Experiment, /System in the ODB. </div><p> Each application will then add its own set of <a class="el" href="structparameters.html">parameters</a> to the database depending on its requirements. For example, starting the <a class="el" href="F_Logging.html#F_mlogger_utility">MIDAS logger</a> will cause the tree /Logger to be created.</p>
<hr/>
 <br/>
 <a class="anchor" id="idx_ODB_key_names"></a> </p>
<h2><a class="anchor" id="RC_odbedit_keynames">
ODB Key names: UPPER/lower case, spaces in key names</a></h2>
<p><b>ODB Key names are case-independent,</b> </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;ls
PerlRC
[local:mpet:Stopped]/&gt;ls perlrc
ControlVariables
RunControl
Tunes
[local:mpet:Stopped]/&gt;ls PERLRC
ControlVariables
RunControl
Tunes
</pre></div><p> <b>Key names containing spaces must be enclosed in quotes</b> </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls <span class="stringliteral">&quot;/Equipment/TITAN_ACQ/ppg cycle/&quot;</span>
transition_HV
stdpulse_START
begin_scan
stdpulse_3
</pre></div><p> If the quotes are omitted </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls /Equipment/TITAN_ACQ/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a> cycle
key /Equipment/TITAN_ACQ/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a> not found
</pre></div><p> Using <b>TAB completion,</b> one could write </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls /Equipment/TITAN_ACQ/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>  
</pre></div><p> then pressing the TAB key would replace the line above with that below </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls <span class="stringliteral">&quot;/Equipment/TITAN_ACQ/ppg cycle/ </span>
</pre></div><p> then press ENTER key to see the list </p>
<div class="fragment"><pre class="fragment">transition_HV
stdpulse_START
begin_scan
stdpulse_3
</pre></div><p><a class="anchor" id="idx_ODB_corrupted"></a> <hr/>
<h2><a class="anchor" id="RC_odbedit_corrupted">
Corrupted ODB</a></h2>
<p>If the <a class="el" href="F_MainElements.html#F_Online_Database_overview">Online Database</a> becomes corrupted, <a class="el" href="RC_odbedit_utility.html">odbedit</a> may no longer work, and other clients will also fail to open the database. In this case, the old ODB should be deleted and a new one created. The contents of the ODB can be reloaded from a <a class="el" href="RC_odbedit_examples.html#RC_odbedit_save">saved file</a>. Since the ODB may become corrupted, it is advisable to <a class="el" href="F_Logging_Data.html#F_Logger_ODB_Dump">save a copy automatically</a> at the end of each run. <br/>
 To delete the corrupted ODB, delete the *.SHM files created in the area indicated in the <a class="el" href="Q_Linux.html#Q_Linux_Exptab">exptab file</a> for your experiment. </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online]$ ls .*.SHM
.ALARM.SHM  .ELOG.SHM  .HISTORY.SHM  .MSG.SHM  .ODB.SHM  .SYSMSG.SHM  .SYSTEM.SHM
[mpet@titan01 ~/online]$ rm .*.SHM
</pre></div><p> Create new *.SHM files by running odbedit (see <a class="el" href="RC_odbedit_examples.html#RC_odbedit_create_ODB">ODB Creation</a>), then load a <a class="el" href="RC_odbedit_examples.html#RC_odbedit_save">saved file</a> containing the latest copy of the odb contents. </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;load mpet.odb
</pre></div><p><br/>
 <hr/>
 <br/>
</p>
<p><a class="anchor" id="idx_script_odbedit"></a> <a class="anchor" id="idx_odbedit_scripts"></a></p>
<h3><a class="anchor" id="RC_odbedit_extcommand">
Using the external command (the  -c argument)</a></h3>
<p><a class="el" href="RC_odbedit_utility.html">odbedit - ODB Editor and run control utility</a> -c argument In the simplest case, a single odbedit command can be entered on the command line, </p>
<div class="fragment"><pre class="fragment">[pol@isdaq01 src]$ odbedit -c start
Starting run #401
Run #401 started
[pol@isdaq01 src]$ odbedit -c stop
Run #401 stopped
</pre></div><p> or a value can be set (note the use of the <a class="el" href="RC_odbedit_utility.html">odbedit</a> <b>-d</b> argument) </p>
<div class="fragment"><pre class="fragment">[pol@isdaq01 pol]$ odbedit -d /test -c <span class="stringliteral">&quot;set testval 3&quot;</span>
[pol@isdaq01 pol]$ odb
[local:pol:S]/&gt;ls test
testval                         3

[pol@isdaq01 pol]$ odbedit -d /test -c <span class="stringliteral">&quot;ls testval&quot;</span>
testval 
</pre></div><p>Note that the syntax to create an ODB STRING array using the "-c" command is </p>
<div class="fragment"><pre class="fragment">odbedit -c <span class="stringliteral">&quot;create STRING Test[1][40]&quot;</span>
odbedit -c <span class="stringliteral">&quot;create STRING Test[8][40]&quot;</span>
</pre></div><p>A filename containing a number of odbedit commands can also be entered, using the <a class="el" href="RC_odbedit_utility.html">odbedit</a> -c @commandfile argument e.g. </p>
<div class="fragment"><pre class="fragment">[pol@isdaq01 pol]$ odbedit -d /test &lt;b&gt; -c @testfile.com &lt;/b&gt;
testval                         4
Starting run #403
Run #403 started
Run #403 paused
Run #403 stopped
[pol@isdaq01 pol]$ 
</pre></div><p> where the file "testfile" contains odbedit commands, such as </p>
<div class="fragment"><pre class="fragment"><span class="keyword">set</span> testval 4
ls testval
start
stop
</pre></div><p> This external command feature of odbedit allows for sophisticated scripts to be created that can manipulate the odb. <br/>
Such scripts can for example</p>
<ul>
<li>check ODB <a class="el" href="structparameters.html">parameters</a> prior to beginning of run</li>
<li>send run <a class="el" href="structparameters.html">parameters</a> to the electronic logbook</li>
<li>act as a run controller, starting and stopping a series of runs with varying <a class="el" href="structparameters.html">parameters</a></li>
</ul>
<p>Some examples are shown below.</p>
<h3><a class="anchor" id="RC_odbedit_script_examples">
Examples of scripts sending odbedit commands</a></h3>
<ul>
<li><a class="el" href="RC_odbedit_examples.html#RC_example_script_1">Shell script run at end-of-run</a></li>
<li><a class="el" href="RC_odbedit_examples.html#RC_example_script_2">Shell script run at beginning of run</a></li>
</ul>
<p>See also <a class="el" href="RC_mhttpd_defining_script_buttons.html#RC_odb_script_ex2_perlscript">MPET perlscripts to perform run control</a> .</p>
<p><a class="anchor" id="idx_script_end-of-run"></a> </p>
<h4><a class="anchor" id="RC_example_script_1">
Shell script run at end-of-run</a></h4>
<p>This script runs at the end of run, and reads some <a class="el" href="structparameters.html">parameters</a> from the odb and sends them to the elog by using the <a class="el" href="F_Elog.html#F_melog_utility">melog - submits an entry to the Elog</a>. To make the script run at end of run, the name of the script is entered in the "Execute on stop run" key in the <a class="el" href="RC_customize_ODB.html#RC_ODB_Programs_Tree">The ODB /Programs tree</a> .</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#!/bin/tcsh</span>
<span class="preprocessor"></span>
<span class="preprocessor"># This script is started at the end of each run. It takes some parameters</span>
<span class="preprocessor"></span><span class="preprocessor"># from the odb and creates an entry in the elog </span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor"># Match to at_start_run.csh script</span>
<span class="preprocessor"></span><span class="preprocessor"># Check for input files</span>
<span class="preprocessor"></span><span class="keywordflow">if</span> ($#argv == 1) then
  <span class="keywordflow">if</span> (-e $1) then
    echo <span class="stringliteral">&quot;Processing from file&quot;</span>
    <span class="keyword">set</span> cmd = `echo <span class="stringliteral">&apos;load &apos;</span>$1`
    odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;$cmd&quot;</span>
  endif
endif
echo <span class="stringliteral">&quot;exp:   $MIDAS_EXPT_NAME&quot;</span>

<span class="preprocessor"># This is the file where the elog entry is saved temporarily</span>
<span class="preprocessor"></span><span class="keyword">set</span> fin = <span class="stringliteral">&quot;/home/$MIDAS_EXPT_NAME/tmp/info_for_elog.txt&quot;</span>
<span class="keywordflow">if</span> (-e $fin) then
  rm -f $fin
endif
touch $fin

<span class="preprocessor"># set port for mhttpd</span>
<span class="preprocessor"></span><span class="keyword">set</span> port=<span class="stringliteral">&apos;8080&apos;</span>

<span class="preprocessor"># Start collecting information from ODB first</span>
<span class="preprocessor"></span><span class="keyword">set</span> Run_number = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Runinfo/Run number&quot;&apos;</span>`
<span class="keyword">set</span> number = `echo $Run_number | awk <span class="stringliteral">&apos;{print $3}&apos;</span>`
<span class="keyword">set</span> sample = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/sample&quot;&apos;</span>`
<span class="keyword">set</span> Sample = `echo $sample | awk <span class="stringliteral">&apos;{print $2}&apos;</span>`
<span class="keyword">set</span> temperature = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/temperature&quot;&apos;</span>`
<span class="keyword">set</span> T = `echo $temperature | awk <span class="stringliteral">&apos;{print $2}&apos;</span>`
<span class="keyword">set</span> field = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/field&quot;&apos;</span>`
<span class="keyword">set</span> H = `echo $field | awk <span class="stringliteral">&apos;{print $2}&apos;</span>`
<span class="keyword">set</span> RF = <span class="stringliteral">&apos;??&apos;</span>
<span class="keyword">set</span> experimenter = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/experimenter&quot;&apos;</span>`
<span class="keyword">set</span> author = `echo $experimenter | awk <span class="stringliteral">&apos;{print $2}&apos;</span>`
<span class="keyword">set</span> run_title = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/run_title&quot;&apos;</span>`
<span class="keyword">set</span> title = `echo $run_title | awk -F<span class="stringliteral">&apos;run_title&apos;</span> <span class="stringliteral">&apos;{print $2}&apos;</span>`
<span class="keyword">set</span> experiment_number = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Experiment/Edit on Start/experiment number&quot;&apos;</span>`
<span class="keyword">set</span> exp_num = `echo $experiment_number | awk <span class="stringliteral">&apos;{print $3}&apos;</span>`
<span class="keyword">set</span> Experiment_name = `odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Equipment/FIFO_acq/sis mcs/Input/Experiment name&quot;&apos;</span>`
<span class="keyword">set</span> type = `echo $Experiment_name | awk <span class="stringliteral">&apos;{print $3}&apos;</span>`
<span class="keyword">set</span> type_dir = `echo <span class="stringliteral">&apos;ls -r /PPG/PPG&apos;</span>$type`

<span class="preprocessor"># Now create the temporary file to be sent to the elog</span>
<span class="preprocessor"></span>echo <span class="stringliteral">&quot;Run # $number&quot;</span> &gt;&gt; $fin
odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Runinfo/Start time&quot;&apos;</span> &gt;&gt; $fin
odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;ls &quot;/Runinfo/Stop time&quot;&apos;</span> &gt;&gt; $fin
echo <span class="stringliteral">&quot;$Sample at T = $T K, H = $H T and RF = $RF mW&quot;</span>&gt;&gt; $fin
echo <span class="stringliteral">&quot;Run Title   : $title&quot;</span> &gt;&gt; $fin
echo <span class="stringliteral">&quot;Experimenter: $author&quot;</span> &gt;&gt; $fin
echo <span class="stringliteral">&quot;Experiment #: $exp_num&quot;</span> &gt;&gt; $fin
echo <span class="stringliteral">&quot;-------------------------------------------------------------&quot;</span> &gt;&gt;$fin
odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;$type_dir&quot;</span> &gt;&gt; $fin
echo <span class="stringliteral">&quot;-------------------------------------------------------------&quot;</span> &gt;&gt;$fin

<span class="keywordflow">if</span> (<span class="stringliteral">&quot;x$Sample&quot;</span> == <span class="stringliteral">&quot;x&quot;</span>) then 
   <span class="keyword">set</span> Sample = <span class="stringliteral">&apos;none&apos;</span>
endif

<span class="keywordflow">if</span> (<span class="stringliteral">&quot;x$author&quot;</span> == <span class="stringliteral">&quot;x&quot;</span>) then 
   <span class="keyword">set</span> author = <span class="stringliteral">&apos;Auto&apos;</span>
endif

<span class="preprocessor"># Send information to the elog</span>
<span class="preprocessor"></span>
echo <span class="stringliteral">&quot;about to send elog (expt $MIDAS_EXPT_NAME, port $port)&quot;</span>
melog -h isdaq01 -p $port -l $MIDAS_EXPT_NAME -a author=$author -a Type=<span class="stringliteral">&quot;Automatic Elog&quot;</span> -a System=<span class="stringliteral">&quot;Elog&quot;</span> -a Subject=<span class="stringliteral">&quot;$Sample&quot;</span>  -m $fin
cat $fin

<span class="preprocessor"># done</span>
</pre></div><p> <a class="anchor" id="idx_script_start-of-run"></a> <hr/>
<h4><a class="anchor" id="RC_example_script_2">
Shell script run at beginning of run</a></h4>
<p>The following example is part of a shell script run at the beginning of run for the TRIUMF BNMR experiment to check the status of various slow controls required for logging during the run. To make the script run at beginning of run, the name of the script is entered in the "Execute on start run" key in the <a class="el" href="RC_customize_ODB.html#RC_ODB_Programs_Tree">The ODB /Programs tree</a> .</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#!/bin/csh</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span>
<span class="preprocessor"># Add an input parameter</span>
<span class="preprocessor"></span><span class="preprocessor">#  0 default</span>
<span class="preprocessor"></span><span class="preprocessor">#  1 (for redo camp slow controls from custom page) to stop statistics being zeroed</span>
<span class="preprocessor"></span><span class="preprocessor">#  2 (redo epics slow controls from custom page)</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor"># NOTE: msg [type] [user] &lt;msg&gt; - compose user message</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#  odb msg 1 -&gt; error msg  (in black/red)</span>
<span class="preprocessor"></span><span class="preprocessor">#  odb msg 2 -&gt; info msg   (in black/white)</span>
<span class="preprocessor"></span>
<span class="preprocessor">#echo &quot;argv: $argv ; number of args: $#argv&quot;</span>
<span class="preprocessor"></span><span class="keyword">set</span> param = 0
<span class="keywordflow">if</span>  ($#argv &gt; 0) then
    <span class="keyword">set</span> param = $argv[1];
   endif
<span class="preprocessor">#echo &quot;param: $param ;  $MIDAS_EXPT_NAME&quot;</span>
<span class="preprocessor"></span>
<span class="keyword">set</span> my_path = <span class="stringliteral">&quot;/home/$MIDAS_EXPT_NAME/online/$MIDAS_EXPT_NAME/bin&quot;</span>
<span class="preprocessor">#echo &quot;my_path:$my_path&quot;</span>
<span class="preprocessor"></span>
odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos;  &apos;(at start) starting with param= $param&apos; &quot;</span>

<span class="preprocessor"># clear elog (camp log) alarm flag</span>
<span class="preprocessor"></span>odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;set &quot;/equipment/fifo_acq/client flags/elog alarm&quot; 0&apos;</span>
<span class="preprocessor"># clear epicslog alarm flag</span>
<span class="preprocessor"></span>odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&apos;set &quot;/equipment/fifo_acq/client flags/epicslog alarm&quot; 0&apos;</span>

<span class="keywordflow">if</span> ($param == 1) then
<span class="preprocessor"># redo CAMP only</span>
<span class="preprocessor"></span>   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos;  &apos;(at start) sets camp ok to 4&apos;&quot;</span>
   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/camp/settings/camp ok&apos; 4&quot;</span> # camp_ok = 4 indicates redoing CAMP only
<span class="keywordflow">else</span> <span class="keywordflow">if</span>  ($param == 2) then
<span class="preprocessor"># redo EPICS only</span>
<span class="preprocessor"></span>   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos;  &apos;(at start) sets epics ok to4&apos;&quot;</span>
   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/epicslog/settings/epics ok&apos; 4&quot;</span> #epics_ok =4 indicates redoing EPICS only
<span class="keywordflow">else</span>
<span class="preprocessor"># run start - redo EPICS and CAMP</span>
<span class="preprocessor"></span>   odb -e $MIDAS_EXPT_NAME  -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos;  &apos;(at start) sets epics ok and camp ok to 2&apos; &quot;</span>
   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/camp/settings/camp ok&apos; 2&quot;</span>      #camp_ok=2 indicates redoing CAMP
   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/epicslog/settings/epics ok&apos; 2&quot;</span> #epics_ok=2 indicates redoing EPICS
endif

<span class="keywordflow">if</span> ($param == 0 || $param == 2) then
<span class="preprocessor">#</span>
<span class="preprocessor"></span><span class="preprocessor">#  Check epics logged variables</span>
<span class="preprocessor"></span><span class="preprocessor">#</span>
<span class="preprocessor"></span>   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos; &apos;calling check_epics.csh&apos; &quot;</span>
   $my_path/check_epics.csh
    <span class="keyword">set</span> stat = $status
    <span class="keywordflow">if</span> ($stat != 0) then
       echo <span class="stringliteral">&quot;error return from check_epics.csh&quot;</span>
       odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;1&apos; &apos;at_start_run&apos; &apos;error return from check_epics.csh&apos; &quot;</span>
       odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/epicslog/settings/epics ok&apos; 0</span>
<span class="stringliteral">&quot;</span> # EPICS failure
    <span class="keywordflow">else</span>
       odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos; &apos;after check_epics.csh (success)&apos; &quot;</span>
       odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;set &apos;/equipment/epicslog/settings/epics ok&apos; 1&quot;</span> # EPICS success
    endif

<span class="keywordflow">else</span>
   odb -e $MIDAS_EXPT_NAME -c <span class="stringliteral">&quot;msg &apos;at_start_run&apos; &apos;(at start) NOT calling check_epics.csh ($param)&apos; &quot;</span>
endif

<span class="keywordflow">if</span> ($param == 2) then  # checks epics only ; no camp
  exit
endif

 ..............
    etc.
</pre></div><hr/>
<h2><a class="anchor" id="RC_odbedit_cmd_examples">
Examples using odbedit commands</a></h2>
<p>Here are some examples of the most commonly used <a class="el" href="RC_odbedit_utility.html">odbedit</a> commands:</p>
<h3><a class="anchor" id="RC_odbedit_pwd">
pwd - show current directory</a></h3>
<p><small> One of the <a class="el" href="RC_odbedit_utility.html">odbedit</a> <a class="el" href="RC_odbedit_utility.html#RC_odbedit_help">commands</a> </small><br/>
<br/>
 </p>
<div class="fragment"><pre class="fragment">$ odbedit
[local:mpet:Stopped]/&gt;
[local:mpet:Stopped]/&gt;pwd
/
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_cd">
cd - change current directory</a></h3>
<p><small> One of the <a class="el" href="RC_odbedit_utility.html">odbedit</a> <a class="el" href="RC_odbedit_utility.html#RC_odbedit_help">commands</a> </small><br/>
<br/>
</p>
<div class="fragment"><pre class="fragment">cd &lt;dir&gt;                - change current directory
</pre></div><p> For example, </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;cd system
[local:mpet:Stopped]/&gt;pwd
/System
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_chat">
chat  - enter chat mode</a></h3>
<p>This mode is used to communicate with another person also running odbedit on the same experiment. It is useful where a telephone connection is not available. e.g. <br/>
 </p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="1" cellspacing="1">
<caption align="bottom">Two users communicate using <b>chat</b> mode</caption>
<tr>
<td style="font-weight: bold; text-align: center;"><p>Anna's console </p>
</td><td style="font-weight: bold; text-align: center;"><p>Fred's console </p>
</td></tr>
<tr>
<td><div class="fragment"><pre class="fragment">[anna@isdaq01 ~]$ odb -e bnmr -h dasdevpc
[dasdevpc:bnmr:S]/&gt;chat
Your name&gt; anna
Exit chat mode with empty line.
&gt; hi
12:46:12 [anna] hi
12:46:51 [ODBEdit2] Program ODBEdit on host dasdevpc started
12:47:21 [fred] hi
&gt; hi
12:47:34 [anna] hi fred
12:48:12 [fred] please cycle crate power now
&gt; <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> - all lights green
12:48:21 [anna] <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> - all lights green
&gt; bye
12:50:27 [anna] bye
&gt;
[dasdevpc:bnmr:S]/&gt;
</pre></div>  </td><td><div class="fragment"><pre class="fragment">odbedit -e bnmr
[fred@dasdevpc ~]$ odb -e bnmr
[local:bnmr:S]/&gt;chat
Your name&gt; fred
Exit chat mode with empty line.
&gt; hi
12:47:21 [fred] hi
12:47:34 [anna] hi fred
&gt; please cycle crate power now
12:48:12 [fred] please cycle crate power now
12:48:21 [anna] <a class="code" href="fevmemodules_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> - all lights green
12:50:27 [anna] bye
&gt;
[local:bnmr:S]/&gt;  
</pre></div>   </td></tr>
</table>
<p>The chat conversation can also be heard over the speakers if <a class="el" href="F_Messaging.html#F_mspeaker_utility">m[lx]speaker - audible messaging</a> is running.</p>
<p><a class="anchor" id="idx_access-control_ODB_keys"></a> <hr/>
<h3><a class="anchor" id="RC_odbedit_chmod">
chmod - change access mode</a></h3>
<p>The access mode can be changed with the chmod command between</p>
<ul>
<li>1 read R</li>
<li>2 write W</li>
<li>4 delete D</li>
</ul>
<p>By default the access mode of ODB keys are RWD i.e. the permission is to Read, Write or Delete them. To avoid them being inadvertently changed or deleted the mode can be set to read-only, e.g </p>
<div class="fragment"><pre class="fragment">[local:t2kgas:S]GasMain.gif&gt;chmod 1 background
Are you sure to change the mode of key
  /Custom/Images/GasMain.gif/background
and all its subkeys
to mode [R]? (y/[n]) y
[local:t2kgas:S]GasMain.gif&gt;ls -lt
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
refresh time (s)                <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>   1     4     13h  0   RWD  10
background                      STRING  1     256   13h  0   R    /home/suz/online/t2kgas/images/GasMain.gif
labels                          DIR
fills                           DIR
</pre></div><p> After setting the mode to read-only, the key cannot be written to: </p>
<div class="fragment"><pre class="fragment">[local:t2kgas:S]GasMain.gif&gt;<span class="keyword">set</span> background dddd
Write access not allowed
</pre></div><p> or deleted </p>
<div class="fragment"><pre class="fragment">[local:t2kgas:S]GasMain.gif&gt;rm background
Are you sure to <span class="keyword">delete</span> the key
<span class="stringliteral">&quot;/Custom/Images/GasMain.gif/background&quot;</span>
(y/[n]) y
deletion of key not allowed
[local:t2kgas:S]GasMain.gif&gt; 
</pre></div><p>To restore the key to mode RWD, </p>
<div class="fragment"><pre class="fragment">[local:t2kgas:S]GasMain.gif&gt;chmod 7 background
Are you sure to change the mode of key
  /Custom/Images/GasMain.gif/background
and all its subkeys
to mode [RWD]? (y/[n]) y
[local:t2kgas:S]GasMain.gif&gt;ls -lt
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
refresh time (s)                <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>   1     4     13h  0   RWD  10
background                      STRING  1     256   13h  0   RWD  /home/suz/online/t2kgas/images/GasMain.gif
labels                          DIR
fills                           DIR
[local:t2kgas:S]GasMain.gif&gt;
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_ls">
ls - list the database entries</a></h3>
<div class="fragment"><pre class="fragment">ls/dir [-lhvrp] [&lt;pat&gt;] - show database entries which match pattern
  -l                      detailed info
  -h                      hex format
  -v                      only value
  -r                      show database entries recursively
  -p                      pause between screens
</pre></div><p> <br/>
List the keys ("dir" is an alternative to "ls"). </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/System&gt;ls
Clients
Tmp
Client Notify                   0
Prompt                          [%h:%e:%S]%p&gt;
[local:mpet:Stopped]/System&gt;     
</pre></div><p> <br/>
The "-l" option gives detailed information, such as the key type and size </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls /experiment
Name                            mpet
Buffer sizes
Variables
Edit on start
[local:mpet:Stopped]/&gt;ls -lt  /experiment
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
Name                            STRING  1     32    3m   0   RWD  mpet
Buffer sizes                    DIR
Variables                       DIR
Edit on start                   DIR
</pre></div><p> <br/>
The recursive option "-r" shows the database entries recursively </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;ls -r <a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>
PPG
    PPGcommon
        Experiment name -&gt; /Equipment/FIFO_acq/sis mcs/Input/Experiment name
                                1h
        CFG path -&gt; /Equipment/FIFO_acq/sis mcs/Input/CFG path
                                /home/pol/online/pol/ppcobj
        PPG path -&gt; /Equipment/FIFO_acq/sis mcs/Input/PPG path
                                /home/pol/online/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>-templates
        Time slice (ms) -&gt; /Equipment/FIFO_acq/sis mcs/Input/Time slice (ms)
                                1e-04
        Minimal delay (ms) -&gt; /Equipment/FIFO_acq/sis mcs/Input/Minimal delay (ms)
                                0.0005
        DAQ service time (ms) -&gt; /Equipment/FIFO_acq/sis mcs/Input/DAQ service time (ms)
                                3000
</pre></div><p> <br/>
The values can be displayed in hexadecimal using the "-h" option </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;ls  <span class="stringliteral">&quot;/Equipment/FIFO_acq/sis mcs/Input/e00 rf frequency (Hz)&quot;</span>
e00 rf frequency (Hz)           22064585
[local:pol:S]/&gt;ls  -h <span class="stringliteral">&quot;/Equipment/FIFO_acq/sis mcs/Input/e00 rf frequency (Hz)&quot;</span>
e00 rf frequency (Hz)           0x150ADC9
</pre></div><p> <br/>
or the value only displayed with the "-v" option </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/test&gt;ls
val                             5
[local:pol:S]/test&gt;ls -v
5
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_mkdir">
mkdir - make new subdirectory</a></h3>
<div class="fragment"><pre class="fragment">mkdir &lt;subdir&gt;          - make new &lt;subdir&gt;
</pre></div><p> <br/>
This example shows how to make a new subdirectory "/custom". </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;ls
System
Programs
Experiment
Runinfo
Alarms

[local:mpet:Stopped]/&gt;mkdir custom
[local:mpet:Stopped]/&gt;ls
System
Programs
Experiment
Runinfo
Alarms
Custom
</pre></div><p>More than one level of subdirectory can be made with one command </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;mkdir /Equipment/test/settings
[local:pol:S]/&gt;ls /Equipment
test
[local:pol:S]/&gt;ls /Equipment/test
[local:pol:S]/&gt;
settings
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_msg">
msg - send a user message</a></h3>
<p>This command can be used to send a message to any client that is receiving MIDAS messages, including the MIDAS message logger, e.g </p>
<div class="fragment"><pre class="fragment">[local:cg:S]/&gt;
16:30:48 [fred] hi
[local:cg:S]/&gt;msg george <span class="stringliteral">&quot;is there a problem?&quot;</span>
[george,USER] is there a problem?
16:30:48 [fred] power supply has failed
</pre></div><p>The messages have gone into the MIDAS log (see <a class="el" href="RC_odbedit_examples.html#RC_odbedit_old">below</a>).</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_old">
old - display old messages</a></h3>
<p>This command displays the last N MIDAS messages, e.g. </p>
<div class="fragment"><pre class="fragment">[local:customgas:S]/&gt;old 9
Fri May 21 13:36:27 2010 [ODBEdit,INFO] Program ODBEdit on host dasdevpc2 started
Fri May 21 13:36:40 2010 [ODBEdit,INFO] Program ODBEdit on host dasdevpc2 stopped
Mon May 31 15:56:28 2010 [ODBEdit,INFO] Program ODBEdit on host dasdevpc2 started
Wed Jun  9 20:49:42 2010 [mhttpd] Program mhttpd on host dasdevpc2 stopped
Wed Jun  9 20:49:42 2010 [mhttpd] Program mhttpd on host dasdevpc2 started
Wed Jun 16 16:27:51 2010 [fred] hi
Wed Jun 16 16:29:15 2010 [fred] hi
Wed Jun 16 16:30:10 2010 [george] is there a problem?
Wed Jun 16 16:30:48 2010 [fred] power supply has failed
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_passwd">
passwd - change/set up the MIDAS password</a></h3>
<p>Example is shown <a class="el" href="RC_customize_ODB.html#RC_Setup_Security">here</a>.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_webpasswd">
webpasswd - change/set up the web password for mhttpd</a></h3>
<p>Example is shown <a class="el" href="RC_customize_ODB.html#RC_Setup_Web_Security">here</a>.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_move">
move - move a key to a new position</a></h3>
<div class="fragment"><pre class="fragment">move &lt;key&gt; [top/bottom/[n]] - move key to position in keylist
</pre></div><p>The "move" command provides a means of re-ordering the keys. </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;ls
System
Programs
Experiment
Runinfo
Alarms
Custom
</pre></div><p>The key "custom" can be moved to the top (or bottom) of the list, e.g. </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;move custom top
[local:mpet:Stopped]/&gt;ls
Custom
System
Programs
Experiment
Runinfo
Alarms
</pre></div><p>or to any position, e.g. </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;move custom 1
[local:mpet:Stopped]/&gt;ls
System
Custom
Programs
Experiment
Runinfo
Alarms
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_rename">
rename - rename a key</a></h3>
<div class="fragment"><pre class="fragment">rename &lt;old&gt; &lt;<span class="keyword">new</span>&gt;      - rename key
</pre></div><p> <br/>
 </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;ls <span class="stringliteral">&quot;my string&quot;</span>
my <span class="keywordtype">string</span>                       <span class="keyword">this</span> is a test <span class="keywordtype">string</span>
[local:pol:S]/&gt;rename <span class="stringliteral">&quot;my string&quot;</span> <span class="stringliteral">&quot;your string&quot;</span>
[local:pol:S]/&gt;ls
your <span class="keywordtype">string</span>                       <span class="keyword">this</span> is a test <span class="keywordtype">string</span>
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_copy">
copy - copy a subtree</a></h3>
<div class="fragment"><pre class="fragment">copy &lt;src&gt; &lt;dest&gt;       - copy a subtree to a <span class="keyword">new</span> location
\code
To make a copy of a subtree:
\code
[local:pol:S]/&gt;ls test
testval                         4
[local:pol:S]/&gt;copy test test1
[local:pol:S]/&gt;ls
test
test1
[local:pol:S]/&gt;ls test1
testval       
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_import">
import -  import ASCII file</a></h3>
<div class="fragment"><pre class="fragment">import  &lt;filename&gt; [key]    - <span class="keyword">import</span> ASCII file into <span class="keywordtype">string</span> key 
</pre></div><p>e.g. import an <a class="el" href="RC_mhttpd_Internal.html">Internal custom page</a> into a key, </p>
<div class="fragment"><pre class="fragment">Tue&gt; odbedit
[local:midas:Stopped]&gt;cd custom
[local:midas:Stopped]/Custom&gt;<span class="keyword">import</span> mcustom.html   &lt;-- <span class="keyword">import</span> an html file
  Key name: Test&amp;  
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_export">
export -  export ASCII file</a></h3>
<div class="fragment"><pre class="fragment">export  &lt;filename&gt; [key]    - <span class="keyword">import</span> ASCII file into <span class="keywordtype">string</span> key 
</pre></div><p>e.g. export an <a class="el" href="RC_mhttpd_Internal.html">Internal custom page</a> into a key,</p>
<div class="fragment"><pre class="fragment">  [local:midas:Stopped]/&gt;cd Custom/
  [local:midas:Stopped]/Custom&gt;export test&amp;
  File name: mcustom.html
  [local:midas:Stopped]/Custom&gt;
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_ln">
ln - create a link</a></h3>
<div class="fragment"><pre class="fragment">ln &lt;source&gt; &lt;linkname&gt;  - create a link to &lt;source&gt; key
</pre></div><p>The <a class="el" href="RC_customize_ODB.html#RC_Edit_On_Start">Edit on start</a> area often contains links to ODB <a class="el" href="structparameters.html">parameters</a> e.g. </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/Experiment&gt;cd <span class="stringliteral">&quot;/Experiment/Edit on start/</span>
<span class="stringliteral">[local:mpet:Stopped]Edit on start&gt;ls</span>
<span class="stringliteral">num ppg cycles                  /Equipment/TITAN_acq/ppg cycle/begin_scan/loop count -&gt; 50</span>
<span class="stringliteral">Pedestals run                   n</span>
<span class="stringliteral">Write Data                      /Logger/Write data -&gt; y</span>
<span class="stringliteral">Capture delay (ms)              /Equipment/TITAN_acq/ppg cycle/evset_2/time offset (ms) -&gt; 0.0955</span>
<span class="stringliteral">PLT pulsedown delay (ms)        /Equipment/TITAN_acq/ppg cycle/pulse_1/time offset (ms) -&gt; 0.0922</span>
<span class="stringliteral">Start Frequency in MHz          /Experiment/Variables/StartFreq (MHz) -&gt; 1.4588775</span>
<span class="stringliteral">End Frequency in MHz            /Experiment/Variables/EndFreq (MHz) -&gt; 1.4588815</span>
<span class="stringliteral">Number of frequency steps       /Experiment/Variables/NFreq -&gt; 41</span>
<span class="stringliteral">Feedbackfilename                /Feedback/fbfilename -&gt; /home/mpet/online/mpetfeedbackfnv1.txt</span>
</pre></div><p>These links were made using the "ln" command, e.g. </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]Edit on start&gt;ln  <span class="stringliteral">&quot;/Equipment/TITAN_acq/ppg cycle/evset_2/time offset (ms)&quot;</span> <span class="stringliteral">&quot;Capture delay (ms)&quot;</span>
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_cr">
create - create a key of a certain type</a></h3>
<div class="fragment"><pre class="fragment">create &lt;type&gt; &lt;key&gt;     - create a key of a certain type
create &lt;type&gt; &lt;key&gt;[n]  - create an array of size [n]
</pre></div><p>Keys can be created of the types supported by MIDAS i.e. <br/>
 INT DWORD BOOL FLOAT DOUBLE STRING</p>
<div class="fragment"><pre class="fragment">[local:pol:S]/test&gt;create dword my_dword
[local:pol:S]/test&gt;create <span class="keywordtype">int</span> my_int
[local:pol:S]/test&gt;create <span class="keywordtype">float</span> my_float
[local:pol:S]/test&gt;create <span class="keywordtype">double</span> my_double
[local:pol:S]/test&gt;create <span class="keywordtype">bool</span> my_bool
[local:pol:S]/&gt;create <span class="keywordtype">string</span> <span class="stringliteral">&quot;my string&quot;</span>
String length [32]: 64

[local:pol:S]/test&gt;ls
my_dword                        0
my_int                          0
my_float                        0
my_double                       0
my_bool                         n
my_string

[local:pol:S]/test&gt;ls -lt
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
my_dword                        <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>   1     4     &gt;99d 0   RWD  0
my_int                          <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>     1     4     &gt;99d 0   RWD  0
my_float                        FLOAT   1     4     &gt;99d 0   RWD  0
my_double                       DOUBLE  1     8     &gt;99d 0   RWD  0
my_bool                         <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>    1     4     &gt;99d 0   RWD  n
my_string                       STRING  1     62    9s   0   RWD
[local:pol:S]/test&gt;
</pre></div><p>Arrays of all these types can also be created, e.g. </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/test&gt;create <span class="keywordtype">int</span> fred[5]
[local:pol:S]/test&gt;ls
fred
                                0
                                0
                                0
                                0
                                0
</pre></div><p>The <a class="el" href="RC_odbedit_examples.html#RC_odbedit_set">set</a> command is used to assign values to the keys.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_set">
set - set the value of a key</a></h3>
<div class="fragment"><pre class="fragment">set &lt;key&gt; &lt;value&gt;       - <span class="keyword">set</span> the value of a key
set &lt;key&gt;[i] &lt;value&gt;    - <span class="keyword">set</span> the value of index i
set &lt;key&gt;[*] &lt;value&gt;    - <span class="keyword">set</span> the value of all indices of a key
set &lt;key&gt;[i..j] &lt;value&gt; - <span class="keyword">set</span> the value of all indices i..j
</pre></div><p>After keys are <a class="el" href="RC_odbedit_examples.html#RC_odbedit_cr">created</a>, they can be assigned values with the <b>set</b> command: </p>
<div class="fragment"><pre class="fragment">[pol@isdaq01 src]$ odb
[local:pol:S]/&gt;create <span class="keywordtype">string</span> <span class="stringliteral">&quot;my string&quot;</span>
String length [32]: 64
[local:pol:S]/&gt;ls -lt <span class="stringliteral">&quot;my string&quot;</span>
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
my <span class="keywordtype">string</span>                       STRING  1     64    9s   0   RWD
[local:pol:S]/&gt;<span class="keyword">set</span> <span class="stringliteral">&quot;my string&quot;</span> <span class="stringliteral">&quot;this is a test string&quot;</span>
[local:pol:S]/&gt;ls <span class="stringliteral">&quot;my string&quot;</span>
my <span class="keywordtype">string</span>                       <span class="keyword">this</span> is a test <span class="keywordtype">string</span>
[local:pol:S]/&gt;create <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> ival
[local:pol:S]/&gt;<span class="keyword">set</span> ival 8
[local:pol:S]/&gt;ls -lt ival
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
ival                            <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>     1     4     3s   0   RWD  8
[local:pol:S]/&gt;ls ival
ival                            8
[local:pol:S]/&gt;   
</pre></div><p>Values of <b>arrays</b> can also be set:</p>
<div class="fragment"><pre class="fragment">[local:pol:S]/test&gt;<span class="keyword">set</span> fred[4] 6
[local:pol:S]/test&gt;ls
fred
                                0
                                0
                                0
                                0
                                6
[local:pol:S]/test&gt;<span class="keyword">set</span> fred 2
[local:pol:S]/test&gt;ls
fred
                                2
                                0
                                0
                                0
                                6
[local:pol:S]/test&gt;<span class="keyword">set</span> fred[*] 5
[local:pol:S]/test&gt;ls
fred
                                5
                                5
                                5
                                5
                                5
[local:pol:S]/test&gt;<span class="keyword">set</span> fred[1..3] 6
[local:pol:S]/test&gt;ls
fred
                                5
                                6
                                6
                                6
                                5
[local:pol:S]/test&gt;           
</pre></div><p>The array can easily be expanded (see also <a class="el" href="RC_odbedit_examples.html#RC_odbedit_trunc">trunc</a>) :</p>
<div class="fragment"><pre class="fragment">[local:pol:S]/test&gt;<span class="keyword">set</span> fred[8] 9
[local:pol:S]/test&gt;ls
fred
                                5
                                6
                                6
                                6
                                5
                                0
                                0
                                0
                                9
</pre></div><p><a class="anchor" id="RC_odbedit_set_wp"></a> <b>NOTE</b> that the "set" command may not work if the ODB parameter is <b>write-protected</b>. See <a class="el" href="RC_odbedit_examples.html#RC_odbedit_chmod">chmod - change access mode</a> and <a class="el" href="RC_customize_ODB.html#RC_Lock_when_Running">Lock when Running</a>.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_chmod">
chmod - change access mode</a></h3>
<div class="fragment"><pre class="fragment">chmod &lt;mode&gt; &lt;key&gt;       change access mode of a key
                          1=read | 2=write | 3=RWD | 4=<span class="keyword">delete</span>
</pre></div><p>By default, a key is created in mode 3 (i.e. RWD read/write/delete). The <b>chmod</b> command may be used to change the protection of the key. </p>
<div class="fragment"><pre class="fragment">[local:bnmr:S]/&gt;create <span class="keywordtype">int</span> my_test
[local:bnmr:S]/&gt;<span class="keyword">set</span> my_test 3
[local:bnmr:S]/&gt;ls -lt my_test
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
my_test                         <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>     1     4     20s  0   RWD  3
[local:bnmr:S]/&gt;chmod 1 my_test
Are you sure to change the mode of key
  /my_test
and all its subkeys
to mode [R]? (y/[n]) y
[local:bnmr:S]/&gt;ls -lt my_test
Key name                        Type    #Val  Size  Last Opn Mode Value
---------------------------------------------------------------------------
my_test                         <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>     1     4     46s  0   R    3
[local:bnmr:S]/&gt;<span class="keyword">set</span> my_test 6
Write access not allowed
[local:bnmr:S]/&gt; 
</pre></div><p><b>NOTE:</b> <br/>
 <br/>
Write protection when running can also be performed - see <a class="el" href="RC_customize_ODB.html#RC_Lock_when_Running">Lock when Running</a>.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_trunc">
trunc  - truncate a key</a></h3>
<div class="fragment"><pre class="fragment">trunc &lt;key&gt; &lt;index&gt;     - truncate key to [index] values
</pre></div><p>This command is used to truncate or expand an array. </p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;ls fred 
fred
                                5
                                6
                                6
                                6
                                5
                                0
                                0
                                0
                                9
[local:pol:S]/&gt;trunc fred 4
[local:pol:S]/&gt;ls fred
fred
                                5
                                6
                                6
                                6
[local:pol:S]/&gt;trunc fred 9
[local:pol:S]/&gt;ls fred
fred
                                5
                                6
                                6
                                6
                                0
                                0
                                0
                                0
                                0
</pre></div><p><br/>
 <hr/>
<h3><a class="anchor" id="RC_odbedit_rm">
rm/del - delete a key and its subkeys</a></h3>
<div class="fragment"><pre class="fragment">del/rm [-l] [-f] &lt;key&gt;  - <span class="keyword">delete</span> a key and its subkeys
  -l                      follow links
  -f                      force deletion without asking
</pre></div><p> <br/>
</p>
<div class="fragment"><pre class="fragment">[local:pol:S]/&gt;rm ival
Are you sure to <span class="keyword">delete</span> the key
<span class="stringliteral">&quot;/ival&quot;</span>
(y/[n]) y
 
[local:pol:S]/&gt;rm test/<span class="keywordflow">try</span>
Are you sure to <span class="keyword">delete</span> the key <span class="stringliteral">&quot;/test/try&quot;</span>
and all its subkeys? (y/[n]) y
[local:pol:S]/&gt; 
</pre></div><p>If you answer "n" the key will not be deleted.</p>
<hr/>
<h3><a class="anchor" id="RC_odbedit_sor">
sor - show open records</a></h3>
<p>This shows which records are open, i.e. <a class="el" href="RC_Hot_Link.html#RC_Hot_Link_Intro">hot-linked</a> . </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;sor
/Runinfo/Requested transition open 1 times by fempet
/Equipment/Trigger/Common open 1 times by fempet
/Equipment/Trigger/Statistics open 1 times by fempet
/Equipment/Trigger/Statistics/Events per sec. open 1 times by Logger
/Equipment/Trigger/Statistics/kBytes per sec. open 1 times by Logger
/Equipment/Trigger/Settings open 1 times by fempet
/Equipment/Scaler/Common open 1 times by fempet
/Equipment/Scaler/Statistics open 1 times by fempet
/Equipment/SlowDac/Variables open 1 times by Logger
/Equipment/SlowDac/Variables/Demand open 1 times by fesdac
/Equipment/SlowDac/Common open 1 times by fesdac
/Equipment/SlowDac/Statistics open 1 times by fesdac
/Equipment/Beamline/Settings/Names open 1 times by scEpics
/Equipment/Beamline/Settings/Update Threshold Measured open 1 times by scEpics
/Equipment/Beamline/Common open 1 times by scEpics
/Equipment/Beamline/Variables open 1 times by Logger
/Equipment/Beamline/Variables/Demand open 1 times by scEpics
/Equipment/Beamline/Statistics open 1 times by scEpics
/Equipment/RF/Variables open 1 times by Logger
/Equipment/TITAN_ACQ/Common open 1 times by fempet
/Equipment/TITAN_ACQ/Statistics open 1 times by fempet
[local:mpet:Stopped]/&gt;    
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_save">
save - save database at current position</a></h3>
<div class="fragment"><pre class="fragment">save [-c -s -x -cs] &lt;file&gt;  - save database at current position
                          in ASCII format
  -c                      as a C structure
  -s                      as a #define<span class="stringliteral">&apos;d string</span>
<span class="stringliteral">  -x                      as a XML file</span>
</pre></div><p> Saving the database regularly is essential in case the database becomes corrupted (see <a class="el" href="RC_odbedit_examples.html#RC_odbedit_corrupted">Corrupted ODB</a>). To save the complete database into an ASCII file, </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;save mpet.odb
</pre></div><p> <br/>
 This example shows how to save part of the database in an <b>ASCII</b> file </p>
<div class="fragment"><pre class="fragment">[local:pol:S]&gt;cd <span class="stringliteral">&quot;/Equipment/Info ODB/&quot;</span>
[local:pol:S]Info ODB&gt;save info.odb
</pre></div><p> <b>Contents</b> of info.odb : </p>
<div class="fragment"><pre class="fragment">[/Equipment/Info ODB/Common]
Event ID = <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> : 10
Trigger mask = <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a> : 0
Buffer = STRING : [32] 
Type = <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> : 1
Source = <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> : 0
Format = STRING : [8] FIXED
Enabled = <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a> : y
Read on = <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> : 273
Period = <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> : 500
Event limit = DOUBLE : 0
Num subevents = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 0
Log history = <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a> : 0
Frontend host = STRING : [32] vwisac2
Frontend name = STRING : [32] fePOL
Frontend file name = STRING : [256] febnmr.c

[/Equipment/Info ODB/Variables]
helicity = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 0
current cycle = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 2
cancelled cycle = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 1
current scan = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 1
Ref P+ thr = DOUBLE : 0
Ref Laser thr = DOUBLE : 10138
Ref Fcup thr = DOUBLE : 0
Current P+ thr = DOUBLE : 0
Current Laser thr = DOUBLE : 10138
Current Fcup thr = DOUBLE : 0
RF state = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 0
Fluor monitor counts = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 50010
EpicsDev Set(V) = FLOAT : 0
EpicsDev Read(V) = FLOAT : 0
Campdev <span class="keyword">set</span> = FLOAT : 0
Campdev read = FLOAT : 0
Pol DAC <span class="keyword">set</span> = DOUBLE : 0
Pol DAC read = DOUBLE : 0
last failed thr test = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 0
cycle when last failed thr = <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a> : 0

[/Equipment/Info ODB/Statistics]
Events sent = DOUBLE : 0
Events per sec. = DOUBLE : 0
kBytes per sec. = DOUBLE : 0
</pre></div><table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
<tr>
<td><p><b>Save as a C structure</b> </p>
<div class="fragment"><pre class="fragment">[local:pol:S]Info ODB&gt;save  -c cfile.c
</pre></div>  </td><td><p><b>Save as a #defined structure </b> </p>
<div class="fragment"><pre class="fragment">[local:pol:S]Info ODB&gt;save  -s cfile.h
</pre></div>  <p></p>
</td></tr>
<tr>
<td><p><b>Contents</b> of cfile.c : </p>
</td><td><p><b>Contents</b> of cfile.h :   </p>
</td></tr>
<tr>
<td><div class="fragment"><pre class="fragment"><span class="keyword">typedef</span> <span class="keyword">struct </span>{
  <span class="keyword">struct </span>{
    <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>      event_id;
    <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>      trigger_mask;
    <span class="keywordtype">char</span>      buffer[32];
    <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       type;
    <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       source;
    <span class="keywordtype">char</span>      format[8];
    <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>      enabled;
    <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       read_on;
    <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       period;
    <span class="keywordtype">double</span>    event_limit;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     num_subevents;
    <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       log_history;
    <span class="keywordtype">char</span>      frontend_host[32];
    <span class="keywordtype">char</span>      frontend_name[32];
    <span class="keywordtype">char</span>      frontend_file_name[256];
  } common;
  <span class="keyword">struct </span>{
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     helicity;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     current_cycle;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     cancelled_cycle;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     current_scan;
    <span class="keywordtype">double</span>    ref_p__thr;
    <span class="keywordtype">double</span>    ref_laser_thr;
    <span class="keywordtype">double</span>    ref_fcup_thr;
    <span class="keywordtype">double</span>    current_p__thr;
 <span class="keywordtype">double</span>    current_laser_thr;
    <span class="keywordtype">double</span>    current_fcup_thr;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     rf_state;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     fluor_monitor_counts;
    <span class="keywordtype">float</span>     epicsdev_set_v_;
    <span class="keywordtype">float</span>     epicsdev_read_v_;
    <span class="keywordtype">float</span>     campdev_set;
    <span class="keywordtype">float</span>     campdev_read;
    <span class="keywordtype">double</span>    pol_dac_set;
    <span class="keywordtype">double</span>    pol_dac_read;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     last_failed_thr_test;
    <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     cycle_when_last_failed_thr;
  } variables;
  <span class="keyword">struct </span>{
    <span class="keywordtype">double</span>    events_sent;
    <span class="keywordtype">double</span>    events_per_sec_;
    <span class="keywordtype">double</span>    kbytes_per_sec_;
  } statistics;
} INFO_ODB;
</pre></div> <p></p>
</td><td><div class="fragment"><pre class="fragment"><span class="preprocessor">#define INFO_ODB(_name) char *_name[] = {\</span>
<span class="preprocessor">&quot;[Common]&quot;,\</span>
<span class="preprocessor">&quot;Event ID = WORD : 10&quot;,\</span>
<span class="preprocessor">&quot;Trigger mask = WORD : 0&quot;,\</span>
<span class="preprocessor">&quot;Buffer = STRING : [32] &quot;,\</span>
<span class="preprocessor">&quot;Type = INT : 1&quot;,\</span>
<span class="preprocessor">&quot;Source = INT : 0&quot;,\</span>
<span class="preprocessor">&quot;Format = STRING : [8] FIXED&quot;,\</span>
<span class="preprocessor">&quot;Enabled = BOOL : y&quot;,\</span>
<span class="preprocessor">&quot;Read on = INT : 273&quot;,\</span>
<span class="preprocessor">&quot;Period = INT : 500&quot;,\</span>
<span class="preprocessor">&quot;Event limit = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Num subevents = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;Log history = INT : 0&quot;,\</span>
<span class="preprocessor">&quot;Frontend host = STRING : [32] vwisac2&quot;,\</span>
<span class="preprocessor">&quot;Frontend name = STRING : [32] fePOL&quot;,\</span>
<span class="preprocessor">&quot;Frontend file name = STRING : [256] febnmr.c&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">&quot;[Variables]&quot;,\</span>
<span class="preprocessor">&quot;helicity = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;current cycle = DWORD : 2&quot;,\</span>
<span class="preprocessor">&quot;cancelled cycle = DWORD : 1&quot;,\</span>
<span class="preprocessor">&quot;current scan = DWORD : 1&quot;,\</span>
<span class="preprocessor">&quot;Ref P+ thr = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Ref Laser thr = DOUBLE : 10138&quot;,\</span>
<span class="preprocessor">&quot;Ref Fcup thr = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Current P+ thr = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Current Laser thr = DOUBLE : 10138&quot;,\</span>
<span class="preprocessor">&quot;Current Fcup thr = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;RF state = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;Fluor monitor counts = DWORD : 50010&quot;,\</span>
<span class="preprocessor">&quot;EpicsDev Set(V) = FLOAT : 0&quot;,\</span>
<span class="preprocessor">&quot;EpicsDev Read(V) = FLOAT : 0&quot;,\</span>
<span class="preprocessor">&quot;Campdev set = FLOAT : 0&quot;,\</span>
<span class="preprocessor">&quot;Campdev read = FLOAT : 0&quot;,\</span>
<span class="preprocessor">&quot;Pol DAC set = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Pol DAC read = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;last failed thr test = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;cycle when last failed thr = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">&quot;[Statistics]&quot;,\</span>
<span class="preprocessor">&quot;Events sent = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Events per sec. = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;kBytes per sec. = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">NULL }</span>
</pre></div>  </td></tr>
</table>
<p><b> Save as an XML structure </b> </p>
<div class="fragment"><pre class="fragment">[local:pol:S]Info ODB&gt;save  -x xinfo.xml
</pre></div><p> <b>Contents</b> of xinfo.xml : </p>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;ISO-8859-1&quot;</span>?&gt;
&lt;!-- created by MXML on Wed Sep 23 13:27:05 2009 --&gt;
&lt;odb root=<span class="stringliteral">&quot;/Equipment/Info ODB&quot;</span> filename=<span class="stringliteral">&quot;xinfo.xml&quot;</span> xmlns:xsi=<span class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> xsi:noNamespaceSchemaLocation=<span class="stringliteral">&quot;/home/pol/packages/midas/odb.xsd&quot;</span>&gt;
  &lt;dir name=<span class="stringliteral">&quot;Common&quot;</span>&gt;
    &lt;key name=<span class="stringliteral">&quot;Event ID&quot;</span> type=<span class="stringliteral">&quot;WORD&quot;</span>&gt;10&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Trigger mask&quot;</span> type=<span class="stringliteral">&quot;WORD&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Buffer&quot;</span> type=<span class="stringliteral">&quot;STRING&quot;</span> size=<span class="stringliteral">&quot;32&quot;</span>&gt;&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Type&quot;</span> type=<span class="stringliteral">&quot;INT&quot;</span>&gt;1&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Source&quot;</span> type=<span class="stringliteral">&quot;INT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Format&quot;</span> type=<span class="stringliteral">&quot;STRING&quot;</span> size=<span class="stringliteral">&quot;8&quot;</span>&gt;FIXED&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Enabled&quot;</span> type=<span class="stringliteral">&quot;BOOL&quot;</span>&gt;y&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Read on&quot;</span> type=<span class="stringliteral">&quot;INT&quot;</span>&gt;273&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Period&quot;</span> type=<span class="stringliteral">&quot;INT&quot;</span>&gt;500&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Event limit&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Num subevents&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Log history&quot;</span> type=<span class="stringliteral">&quot;INT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Frontend host&quot;</span> type=<span class="stringliteral">&quot;STRING&quot;</span> size=<span class="stringliteral">&quot;32&quot;</span>&gt;vwisac2&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Frontend name&quot;</span> type=<span class="stringliteral">&quot;STRING&quot;</span> size=<span class="stringliteral">&quot;32&quot;</span>&gt;fePOL&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Frontend file name&quot;</span> type=<span class="stringliteral">&quot;STRING&quot;</span> size=<span class="stringliteral">&quot;256&quot;</span>&gt;febnmr.c&lt;/key&gt;
  &lt;/dir&gt;
  &lt;dir name=<span class="stringliteral">&quot;Variables&quot;</span>&gt;
    &lt;key name=<span class="stringliteral">&quot;helicity&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;current cycle&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;2&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;cancelled cycle&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;1&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;current scan&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;1&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Ref P+ thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Ref Laser thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;10138&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Ref Fcup thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Current P+ thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Current Laser thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;10138&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Current Fcup thr&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;RF state&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Fluor monitor counts&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;50010&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;EpicsDev Set(V)&quot;</span> type=<span class="stringliteral">&quot;FLOAT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;EpicsDev Read(V)&quot;</span> type=<span class="stringliteral">&quot;FLOAT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Campdev set&quot;</span> type=<span class="stringliteral">&quot;FLOAT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Campdev read&quot;</span> type=<span class="stringliteral">&quot;FLOAT&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Pol DAC set&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Pol DAC read&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;last failed thr test&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;cycle when last failed thr&quot;</span> type=<span class="stringliteral">&quot;DWORD&quot;</span>&gt;0&lt;/key&gt;
  &lt;/dir&gt;
  &lt;dir name=<span class="stringliteral">&quot;Statistics&quot;</span>&gt;
    &lt;key name=<span class="stringliteral">&quot;Events sent&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;Events per sec.&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
    &lt;key name=<span class="stringliteral">&quot;kBytes per sec.&quot;</span> type=<span class="stringliteral">&quot;DOUBLE&quot;</span>&gt;0&lt;/key&gt;
  &lt;/dir&gt;
&lt;/odb&gt;
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_load">
load - load database from a saved file</a></h3>
<div class="fragment"><pre class="fragment">load &lt;file&gt;             - load database from .ODB file at current position
</pre></div><p> To load the <b>complete</b> database from an ASCII file containing a previously <a class="el" href="RC_odbedit_examples.html#RC_odbedit_save">saved</a> database: </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;load mpet.odb
</pre></div><p> The entire database need not be loaded. <a class="el" href="RC_odbedit_examples.html#RC_odbedit_save">Saved ASCII files</a> can be made of just a part of the database, and these can be reloaded into the database. Since the full path is given in the saved file, the file can be loaded from any position in the database. The saved ASCII file may of course be edited prior to loading, if keynames or values need to be changed. If the keys in the load file do not exist, they will be created. If they do exist, the values from the file will be loaded. </p>
<div class="fragment"><pre class="fragment">[mpet@titan01 ~/online] odbedit
[local:mpet:Stopped]/&gt;load awg0.odb
</pre></div><p> <br/>
</p>
<p><a class="anchor" id="idx_experim-dot-h_make"></a> <hr/>
<h3><a class="anchor" id="RC_odbedit_make">
make - create experim.h</a></h3>
<div class="fragment"><pre class="fragment">make [analyzer name]    - create experim.h
</pre></div><p> The <b>make</b> command creates in the current directory <b><a class="el" href="experim_8h.html">experim.h</a></b>, a file containing C structures which can be included into frontend and analyzer code to enable easy access to the odb <a class="el" href="structparameters.html">parameters</a> (see also RC_experim_dot_h "using experim.h with hot-links" <br/>
 In order to include the <a class="el" href="DataAnalysis.html#DA_analyzer_utility">analyzer section</a>, the ODB key <b>/&lt;Analyzer&gt;/Parameters</b> has to be present, where &lt;Analyzer&gt; is the name of the analyzer. The command used is then "make \&lt;Analyzer&gt; " <br/>
 The following example does not have an Analyzer key. </p>
<div class="fragment"><pre class="fragment">[pol@isdaq01 pol]$ odbedit
[local:pol:S]/&gt;make
Analyzer <span class="stringliteral">&quot;Analyzer&quot;</span> not found in ODB, skipping analyzer parameters
<span class="stringliteral">&quot;experim.h&quot;</span> has been written to /home/pol/online/pol
</pre></div><p> Here is an part of <a class="el" href="experim_8h.html">experim.h</a> for an experiment, showing the "Experiment" tree and one of the "Equipment" trees </p>
<div class="fragment"><pre class="fragment"><span class="comment">/********************************************************************\</span>
<span class="comment"></span>
<span class="comment">  Name:         experim.h</span>
<span class="comment">  Created by:   ODBedit program</span>
<span class="comment"></span>
<span class="comment">  Contents:     This file contains C structures for the &quot;Experiment&quot;</span>
<span class="comment">                tree in the ODB and the &quot;/Analyzer/Parameters&quot; tree.</span>
<span class="comment"></span>
<span class="comment"></span>
<span class="comment">                Additionally, it contains the &quot;Settings&quot; subtree for</span>
<span class="comment">                all items listed under &quot;/Equipment&quot; as well as their</span>
<span class="comment">                event definition.</span>
<span class="comment"></span>
<span class="comment">                It can be used by the frontend and analyzer to work</span>
<span class="comment">                with these information.</span>
<span class="comment"></span>
<span class="comment">                All C structures are accompanied with a string represen-</span>
<span class="comment">                tation which can be used in the db_create_record function</span>
<span class="comment">                to setup an ODB structure which matches the C structure.</span>
<span class="comment"></span>
<span class="comment">  Created on:   Wed Sep 23 13:10:52 2009</span>
<span class="comment"></span>
<span class="comment">\********************************************************************/</span>

<span class="preprocessor">#define EXP_EDIT_DEFINED</span>
<span class="preprocessor"></span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>{
  <span class="keywordtype">char</span>      run_title[88];
  <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     experiment_number;
  <span class="keywordtype">char</span>      experimenter[32];
  <span class="keywordtype">char</span>      sample[15];
  <span class="keywordtype">char</span>      orientation[15];
  <span class="keywordtype">char</span>      temperature[15];
  <span class="keywordtype">char</span>      field[15];
  <span class="keywordtype">char</span>      element[24];
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       mass;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       dc_offset_v_;
  <span class="keywordtype">double</span>    ion_source__kv_;
  <span class="keywordtype">double</span>    laser_wavelength__nm_;
  <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>      active;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       num_scans;
  <span class="keywordtype">char</span>      source_hv_bias[12];
  <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>      edit_run_number;
} EXP_EDIT;

<span class="preprocessor">#define EXP_EDIT_STR(_name) char *_name[] = {\</span>
<span class="preprocessor">&quot;[.]&quot;,\</span>
<span class="preprocessor">&quot;run_title = STRING : [88] test&quot;,\</span>
<span class="preprocessor">&quot;experiment number = DWORD : 1&quot;,\</span>
<span class="preprocessor">&quot;experimenter = STRING : [32] Matt &quot;,\</span>
<span class="preprocessor">&quot;sample = STRING : [15] test&quot;,\</span>
<span class="preprocessor">&quot;orientation = STRING : [15] &quot;,\</span>
<span class="preprocessor">&quot;temperature = STRING : [15] &quot;,\</span>
<span class="preprocessor">&quot;field = STRING : [15] &quot;,\</span>
<span class="preprocessor">&quot;Element = STRING : [24] li&quot;,\</span>
<span class="preprocessor">&quot;Mass = INT : 7&quot;,\</span>
<span class="preprocessor">&quot;DC offset(V) = INT : 0&quot;,\</span>
<span class="preprocessor">&quot;Ion source (kV) = DOUBLE : 30&quot;,\</span>
<span class="preprocessor">&quot;Laser wavelength (nm) = DOUBLE : 123456789&quot;,\</span>
<span class="preprocessor">&quot;write data = LINK : [35] /Logger/Channels/0/Settings/Active&quot;,\</span>
<span class="preprocessor">&quot;Number of scans = LINK : [47] /Equipment/FIFO_acq/sis mcs/hardware/num scans&quot;,\</span>
<span class="preprocessor">&quot;Source HV Bias = STRING : [12] OLIS&quot;,\</span>
<span class="preprocessor">&quot;Edit run number = BOOL : y&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">NULL }</span>
<span class="preprocessor"></span>



<span class="preprocessor">#ifndef EXCL_CYCLE_SCALERS</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define CYCLE_SCALERS_COMMON_DEFINED</span>
<span class="preprocessor"></span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>{
  <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>      event_id;
  <a class="code" href="sis3803_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>      trigger_mask;
  <span class="keywordtype">char</span>      buffer[32];
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       type;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       source;
  <span class="keywordtype">char</span>      format[8];
  <a class="code" href="vt2_8h.html#a239c7f0d40651c3e419c5b9651507d14">BOOL</a>      enabled;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       read_on;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       period;
  <span class="keywordtype">double</span>    event_limit;
  <a class="code" href="sis3801_8h.html#a408a2366473807fbe658ba18e75dea66">DWORD</a>     num_subevents;
  <a class="code" href="sis3803_8h.html#a09fddde158a3a20bd2dcadb609de11dc">INT</a>       log_history;
  <span class="keywordtype">char</span>      frontend_host[32];
  <span class="keywordtype">char</span>      frontend_name[32];
  <span class="keywordtype">char</span>      frontend_file_name[256];
} CYCLE_SCALERS_COMMON;

<span class="preprocessor">#define CYCLE_SCALERS_COMMON_STR(_name) char *_name[] = {\</span>
<span class="preprocessor">&quot;[.]&quot;,\</span>
<span class="preprocessor">&quot;Event ID = WORD : 3&quot;,\</span>
<span class="preprocessor">&quot;Trigger mask = WORD : 1&quot;,\</span>
<span class="preprocessor">&quot;Buffer = STRING : [32] SYSTEM&quot;,\</span>
<span class="preprocessor">&quot;Type = INT : 1&quot;,\</span>
<span class="preprocessor">&quot;Source = INT : 0&quot;,\</span>
<span class="preprocessor">&quot;Format = STRING : [8] MIDAS&quot;,\</span>
<span class="preprocessor">&quot;Enabled = BOOL : y&quot;,\</span>
<span class="preprocessor">&quot;Read on = INT : 257&quot;,\</span>
<span class="preprocessor">&quot;Period = INT : 100&quot;,\</span>
<span class="preprocessor">&quot;Event limit = DOUBLE : 0&quot;,\</span>
<span class="preprocessor">&quot;Num subevents = DWORD : 0&quot;,\</span>
<span class="preprocessor">&quot;Log history = INT : 0&quot;,\</span>
<span class="preprocessor">&quot;Frontend host = STRING : [32] vwisac2&quot;,\</span>
<span class="preprocessor">&quot;Frontend name = STRING : [32] fePOL&quot;,\</span>
<span class="preprocessor">&quot;Frontend file name = STRING : [256] febnmr.c&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">NULL }</span>
<span class="preprocessor"></span>
<span class="preprocessor">#define CYCLE_SCALERS_SETTINGS_DEFINED</span>
<span class="preprocessor"></span>
<span class="keyword">typedef</span> <span class="keyword">struct </span>{
  <span class="keywordtype">char</span>      names[6][32];
} CYCLE_SCALERS_SETTINGS;

<span class="preprocessor">#define CYCLE_SCALERS_SETTINGS_STR(_name) char *_name[] = {\</span>
<span class="preprocessor">&quot;[.]&quot;,\</span>
<span class="preprocessor">&quot;Names = STRING[6] :&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%SIS Ref pulse&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%Fluor. mon&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%P+ beam&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%Laser power&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%Faraday Cup 15&quot;,\</span>
<span class="preprocessor">&quot;[32] Scaler_B%Locking Feedback&quot;,\</span>
<span class="preprocessor">&quot;&quot;,\</span>
<span class="preprocessor">NULL }</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
...................

etc.
</pre></div><p><a class="anchor" id="idx_clients_active_odbedit"></a> <hr/>
<h3><a class="anchor" id="RC_odbedit_scl">
scl - show active clients</a></h3>
<div class="fragment"><pre class="fragment">scl [-w]                - show all active clients [with watchdog info]
</pre></div><p> <br/>
 </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;scl
Name                Host
rucompet            titan01.triumf.ca
Logger              titan01.triumf.ca
scEpics             titan01.triumf.ca
fesdac              lxmpet.triumf.ca
fempet              lxmpet.triumf.ca
mhttpd              titan01.triumf.ca
ODBEdit             titan01.triumf.ca
</pre></div><hr/>
<h3><a class="anchor" id="RC_odbedit_sh">
sh - shutdown a client</a></h3>
<div class="fragment"><pre class="fragment">shutdown &lt;client&gt;/all   - shutdown individual or all clients
</pre></div><p> <br/>
 </p>
<div class="fragment"><pre class="fragment">[local:mpet:Stopped]/&gt;sh rucompet
[local:mpet:Stopped]/&gt;scl
Name                Host
Logger              titan01.triumf.ca
scEpics             titan01.triumf.ca
fesdac              lxmpet.triumf.ca
fempet              lxmpet.triumf.ca
mhttpd              titan01.triumf.ca
ODBEdit             titan01.triumf.ca
</pre></div><p><a class="anchor" id="idx_run_start"></a> <hr/>
<h3><a class="anchor" id="RC_odbedit_start">
start - start a run</a></h3>
<div class="fragment"><pre class="fragment">start [number][now][-v] - start a run [with a specific number],
                          [now] w/o asking parameters, [-v] debug output
</pre></div><p> <br/>
</p>
<p>The odbedit <b>start</b> command is used to start a run.</p>
<p><br/>
 </p>
<h4><a class="anchor" id="RC_EOS_example1">
Run start examples</a></h4>
<p>In the following example, the run number of the new run is supplied. </p>
<div class="fragment"><pre class="fragment">[local:Default:S]/Experiment&gt;start 503
</pre></div><p> <br/>
</p>
<p>In the example below, the run number is not specified. The system will start the next consecutive run. </p>
<div class="fragment"><pre class="fragment">[local:Default:S]/Experiment&gt;start
Run number [30004]: 
Are the above parameters correct? ([y]/n/q): y
</pre></div><p> The user may edit the run number before continuing by typing "n". Typing "y" will start the run, and typing "q" will abort the run start. <br/>
</p>
<p>In the above example, there are no <a class="el" href="RC_customize_ODB.html#RC_Edit_On_Start">edit-on-start paramaters</a> defined by the user. If any are defined, the command "start" will display the "edit on start" <a class="el" href="structparameters.html">parameters</a> e.g.</p>
<h4><a class="anchor" id="RC_EOS_example2">
Run Start example with "Edit on Start" parameters</a></h4>
<p>Note that when using odbedit, Parameter comments are NOT visible, and the run number IS editable. </p>
<div class="fragment"><pre class="fragment">[local:bnmr:S]/&gt;start 
run_title : 2e test
experiment number : 9999
experimenter : gdm
sample : NA
orientation : 
temperature : 285.12K
field : 0G
Number of scans : 0
write data : y
Run number [30004]:
</pre></div><p><br/>
 </p>
<h4><a class="anchor" id="RC_EOS_example3">
Run Start Example with "start now"</a></h4>
<p><a class="anchor" id="RC_odbedit_start_now"></a> By entering the command <b>"start now"</b>, all defined <a class="el" href="RC_customize_ODB.html#RC_Edit_On_Start">Edit-on-Start parameters</a> can be skipped. </p>
<div class="fragment"><pre class="fragment">[local:bnmr:S]/&gt;start now
Starting run #30129
Run #30129 started
</pre></div><h4><a class="anchor" id="RC_EOS_example4">
Run Start Example with "-v" verbose option</a></h4>
<p><a class="anchor" id="RC_odbedit_start_v"></a> Using the <b>"-v"</b> (verbose) option is useful for debugging. It prints messages as each client is started. </p>
<div class="fragment"><pre class="fragment">[local:bnmr:S]/&gt;start -v
run_title : test
experiment number : 1165
experimenter : gdm
sample : GaAs
orientation : 100
temperature : 286.01K
field : 0.00G
Number of cycles : 0
write data : y
Run number [30128]:
Are the above parameters correct? ([y]/n/q): y
</pre></div><p> <a class="anchor" id="RC_transition_start"></a> </p>
<div class="fragment"><pre class="fragment">Starting run #30128
Setting run number 30128 in ODB
---- Transition START started ----

==== Found client <span class="stringliteral">&quot;Logger&quot;</span> with sequence number 200
Connecting to client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;mheader&quot;</span> with sequence number 200
Connecting to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;rf_config&quot;</span> with sequence number 350
Connecting to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;rf_config&quot;</span> with sequence number 400
Connecting to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;Mdarc&quot;</span> with sequence number 450
Connecting to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;Epics&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;mheader&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;Mdarc&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;feBNMR&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
Connection established to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw
Executing RPC transition client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
RPC transition finished client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw with status 1
</pre></div><hr/>
 <a class="anchor" id="idx_run_stop"></a> </p>
<h3><a class="anchor" id="RC_odbedit_stop">
stop - stop a run</a></h3>
<div class="fragment"><pre class="fragment">stop [-v]               - stop current run, [-v] debug output
</pre></div><p> <br/>
 </p>
<div class="fragment"><pre class="fragment">[local:pol:R]/&gt;stop
Run #399 stopped
[local:pol:S]/&gt;  
</pre></div><p> <a class="anchor" id="idx_run_stop_immediately"></a> "Stop now" can be used to force a stop if there is a deferred transition. If there is no deferred transition, the "stop now" is the same as "stop". </p>
<div class="fragment"><pre class="fragment">local:bnmr:R]/&gt;stop now
Run #30129 stopped
</pre></div><p> Using the "-v" (verbose) option is useful for debugging. It prints a message as each client is stopped.</p>
<p><a class="anchor" id="RC_transition_stop"></a></p>
<div class="fragment"><pre class="fragment">[local:bnmr:R]/&gt;stop -v
---- Transition STOP started ----

==== Found client <span class="stringliteral">&quot;mheader&quot;</span> with sequence number 200
Connecting to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;Epics&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Epics&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;rf_config&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;rf_config&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;mheader&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;feBNMR&quot;</span> with sequence number 500
Connecting to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
Connection established to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw
Executing RPC transition client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
RPC transition finished client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw with status 1

==== Found client <span class="stringliteral">&quot;mheader&quot;</span> with sequence number 600
Connecting to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;mheader&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;Mdarc&quot;</span> with sequence number 600
Connecting to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Mdarc&quot;</span> on host isdaq01 with status 1

==== Found client <span class="stringliteral">&quot;feBNMR&quot;</span> with sequence number 750
Connecting to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
Connection established to client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw
Executing RPC transition client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw...
RPC transition finished client <span class="stringliteral">&quot;feBNMR&quot;</span> on host bnmrhmvw with status 1

==== Found client <span class="stringliteral">&quot;Logger&quot;</span> with sequence number 800
Connecting to client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01...
Connection established to client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01
Executing RPC transition client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01...
RPC transition finished client <span class="stringliteral">&quot;Logger&quot;</span> on host isdaq01 with status 1

---- Transition STOP finished ----
Run #30128 stopped
</pre></div><p><br/>
  
<script type="text/javascript">
pages( "RC_odbedit_utility",  "RunControl","RC_mhttpd","RC_odbedit_examples",  "" ); // back index next {top bottom}
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
<p><a class="anchor" id="end"></a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

