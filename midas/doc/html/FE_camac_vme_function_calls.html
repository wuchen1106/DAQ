<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: CAMAC and VME access function calls</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="FrontendOperation.html">SECTION 6: Frontend Operation</a>&nbsp;&raquo&nbsp;<a class="el" href="Frontend_code.html">Frontend code</a>&nbsp;&raquo&nbsp;<a class="el" href="FE_Appendices.html">Frontend Appendices</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="FE_camac_vme_function_calls">CAMAC and VME access function calls </a></h1><p><br/>
  
 <script type="text/javascript">
pages("FE_Hardware",  "FrontendOperation", "FE_utils","FE_camac_vme_function_calls","end" ); // back index next {top bottom}
// section parameters: last section; top of this section; next section
sections("RunControl","FrontendOperation","DataAnalysis");
</script>
<p><br/>
 <a class="anchor" id="idx_hardware_standard_interface"></a> MIDAS defines its own set of CAMAC and VME calls in order to unify the different hardware modules that it supports. This interface method permits code to be totally <em> hardware as well as OS independent </em>. For example, the same user code developed on a system can be used as a template for another application on a different operating system.</p>
<p><span class="note">MIDAS provides <b>Standard</b> <b>Interfaces</b> for VME and CAMAC</span></p>
<ul>
<li><b><a class="el" href="mcstd_8h.html">mcstd.h</a></b> for <b>CAMAC</b> access</li>
<li><b><a class="el" href="mvmestd_8h.html">mvmestd.h</a></b> for <b>VME</b> access</li>
</ul>
<p><span class="note">An extra CAMAC interface built on top of <b>mcstd</b> provides the ESONE standard CAMAC calls (<a class="el" href="esone_8c.html">esone.c</a>).</span></p>
<p>Refer to the corresponding directories under $(<a class="el" href="BuildingOptions.html#BO_MIDASSYS">MIDASSYS</a>)<em>/drivers</em> to find out what module of each family is already supported by the current MIDAS distribution. The directory $(<a class="el" href="BuildingOptions.html#BO_MIDASSYS">MIDASSYS</a>)<em>/drivers/divers</em> contains older drivers which have not yet been converted to the latest API.</p>
<p><a class="anchor" id="idx_hardware_standard_interface_CAMAC"></a> <hr/>
 <h2><a class="anchor" id="FE_Midas_CAMAC_standard_functions">
MIDAS CAMAC standard functions</a></h2>
<p>Please refer to <a class="el" href="group__mcstdfunctionh.html">Camac Functions (camxxx)</a> for function description.</p>
<p><a class="anchor" id="idx_hardware_CAMAC_functions_ESONE"></a> <hr/>
 <h2><a class="anchor" id="FE_ESONE_CAMAC_standard_functions">
ESONE CAMAC standard functions</a></h2>
<p><b>Not all the functionality of ESONE standard has been fully tested</b></p>
<p>Please refer to <a class="el" href="group__mesonefunctionc.html">Camac Functions (Esone)</a> for function description.</p>
<p><a class="anchor" id="idx_hardware_standard_interface_VME"></a> <hr/>
 <h2><a class="anchor" id="FE_Midas_VME_standard_functions">
MIDAS VME standard functions</a></h2>
<p>This API provides basic VME access through a <b>simple</b> set of functions. Refer to <a class="el" href="group__mvmestdfunctionh.html">VME Functions (mvme_xxx)</a> for more specific information. <a class="el" href="group__mvmestdfunctionh.html#ga13db7fc7c7c022e46fadd8fc4dc40047">mvme_open()</a> contains a general access code sample summarizing most of the mvme commands.</p>
<p><a class="anchor" id="idx_hardware_computer-busy"></a> <hr/>
 <h2><a class="anchor" id="FE_Compute_Busy_Logic">
Computer Busy Logic</a></h2>
<p>A "computer busy logic" has to be implemented for a front-end to work properly. The reason for this is that some ADC modules can be re-triggered. If they receive more than one gate pulse before being read out, they accumulate the input charge that leads to incorrect results. Therefore only one gate pulse should be sent to the ADCs, and additional pulses must be blocked before the event is read out by the front-end. This operation is usually performed by a latch module, which is set by the trigger signal and reset by the computer after it has read out the event.</p>
<p>The output of this latch is shaped (limited in its pulse width to match the ADC gate width) and distributed to the ADCs. This scheme has two problems. The computer generates the reset signal, usually by two CAMAC output functions to a CAMAC IO unit. Therefore the duration of the pulse is a couple of ms. There is a non-negligible probability that during the reset pulse there is another hardware trigger. If this happens and both inputs of the latch are active, its function is undefined. Usually it generates several output pulses that lead to erroneous ADC values. The second problem lies in the fact that the latch can be just reset when a trigger input is active. This can happen since trigger signals usually have a width of a few tens of nanoseconds. In this case the latch output signal does not carry the timing of the trigger signal, but the timing of the reset signal. The incorrect timing of the output can lead to false ADC and TDC signals. To overcome this problem, a more elaborate scheme is necessary. One possible solution is the use of a latch module with edge-sensitive input and veto input. At PSI, the module "D. TRIGGER / DT102" can be used. The veto input is also connected to the computer:</p>
<center> Latched trigger layout. </p>
<div align="center">
<img src="latch02.gif" alt="latch02.gif"/>
</div>
 </center><p>To reset this latch, the following bit sequence is applied to the computer output (signals are displayed active low):</p>
<center> Improved Latched trigger layout. </p>
<div align="center">
<img src="latch01.gif" alt="latch01.gif"/>
</div>
 </center><p>The active veto signal during the reset pulse avoids the case where the latch can receive a "set" and a "reset" simultaneously. The edge-sensitive input ensures that the latch can only trigger on a leading edge of a trigger signal, and not when the veto signal is removed. This ensures that the timing of the trigger is always carried at the ADC/TDC gate signal.</p>
<center> Veto Timing. </p>
<div align="center">
<img src="timing01.gif" alt="timing01.gif"/>
</div>
 </center><p><br/>
  
<script type="text/javascript">
pages("FE_Hardware",  "FrontendOperation", "FE_utils","FE_camac_vme_function_calls","" ); // back index next {top bottom}
// section parameters: last section; top of this section; next section
sections("RunControl","FrontendOperation","DataAnalysis");
</script>
<p><br/>
 <a class="anchor" id="end"></a> </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

