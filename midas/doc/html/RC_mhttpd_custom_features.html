<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Midas: Features available on custom pages</title>
<link href="midox.css" rel="stylesheet" type="text/css">
<!--
<link href="doxygen.css" rel="stylesheet" type="text/css">
-->
<link href="tabs.css" rel="stylesheet" type="text/css">

<script type="text/javascript"  src="navigation.js">
</script>

</head>

<body>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Midas Documentation</a>&nbsp;&raquo&nbsp;<a class="el" href="RunControl.html">SECTION 5: Run Control</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_run_control.html">Run Control Programs</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd.html">mhttpd: the MIDAS Web-based Run Control utility</a>&nbsp;&raquo&nbsp;<a class="el" href="RC_mhttpd_Custom_page.html">Custom pages</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="RC_mhttpd_custom_features">Features available on custom pages </a></h1><p><br/>
  
<script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_custom_js_lib", "RunControl","RC_mhttpd_custom_ODB_access", "RC_mhttpd_custom_features", "end" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
<p><a class="anchor" id="mhttpd_page_custom_create"></a> </p>
<h2><a class="anchor" id="RC_mhttpd_custom_create">
How to create a custom page</a></h2>
<p>A custom page may be written in ordinary HTML code and/or JavaScript. It may include any of the following special features provided for use with MIDAS:</p>
<p><a class="anchor" id="idx_mhttpd_page_custom_features"></a></p>
<ul>
<li><a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_midas_buttons">Access to the standard MIDAS Menu buttons</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access.html">Access to the ODB from a Custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_custom_pw_protection">Password protection of ODB variables accessed from a custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_script_buttons">CustomScript Buttons</a></li>
<li><a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_refresh">Page refresh</a></li>
<li><a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_alias">Alias Buttons and Hyperlinks</a></li>
<li><a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_getmsg">Access to message log</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_custom_checkboxes">Including checkboxes on a custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_js_update_part">Periodic update of parts of a custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_RPC_access.html">ODB RPC access</a></li>
</ul>
<ul>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_image">Image insertion into a Custom page</a><ul>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_history">Inserting a history image in a custom page</a></li>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_imagemap">Mapping active areas onto the image</a><ul>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_getmouse">Display mouse position</a></li>
</ul>
</li>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_Labels_Bars_Fills">Superimposing Labels, Bars and Fills onto an image</a></li>
<li><a class="el" href="RC_mhttpd_Image_access.html#RC_mhttpd_custom_edit_boxes">Edit boxes floating on top of a graphic</a></li>
</ul>
</li>
</ul>
<p><br/>
 All these features will be described in the following sections. They apply to both <b>external</b> and <b>internal</b> web pages. <a class="anchor" id="idx_mhttpd_page_custom_external"></a> <a class="anchor" id="mhttpd_custom_external"></a> Since external custom pages are more commonly used than internal, the examples in the following sections use <b>external</b> file(s). Examples of <b>internal</b> pages can be found <a class="el" href="RC_mhttpd_Internal.html">here</a>.</p>
<p><br/>
 <hr/>
<br/>
 </p>
<h3><a class="anchor" id="RC_mhttpd_custom_including_js">
Including JavaScript code in an HTML custom page</a></h3>
<p>Javascript code can be inserted in the HTML file by enclosing it between the <span class="htmltag">&lt;script type="text/javascript"&gt; ..... &lt;/script&gt;</span> HTML tags, for example: <br/>
 </p>
<div class="fragment"><pre class="fragment">&lt;!-- include some js code --&gt;
&lt;script  type=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;
\code
var my_title=<span class="stringliteral">&quot;Gas Analyzer Custom Page&quot;</span>
var my_name=<span class="stringliteral">&quot;GasAnalyzer&quot;</span>
var my_num = 10;

document.write(<span class="stringliteral">&apos;&lt;title&gt;T2KGas: &apos;</span> +my_title+ <span class="charliteral">&apos;(&apos;</span> +my_num+ <span class="stringliteral">&apos;)&lt;/title&gt;&apos;</span>);
&lt;/script&gt;
</pre></div><p> <br/>
 The <span class="htmltag">&lt;script ...&gt;</span> HTML tag is also used to <a class="el" href="RC_mhttpd_custom_js_lib.html#RC_mhttpd_include_js_library">include</a> the <a class="el" href="RC_mhttpd_custom_js_lib.html">JavaScript built-in library mhttpd.js</a> in the custom page, to allow access to the ODB using the JavaScript (JS) <a class="el" href="RC_mhttpd_custom_js_lib.html#RC_mhttpd_js_library_features">built-in functions</a>. <br/>
Custom pages may be written entirely in JavaScript, if preferred. For example, a file of user-written JavaScript functions can be included into multiple HTML custom pages (provided links are created to these files in the ODB <span class="odb">/Custom</span> tree - see <a class="el" href="RC_mhttpd_Activate.html">details here</a>).</p>
<p>In the following HTML code fragment, the <a class="el" href="RC_mhttpd_custom_js_lib.html">JavaScript built-in library mhttpd.js</a> is included, as well as two user-written Javascript files.</p>
<div class="fragment"><pre class="fragment">........
&lt;html&gt;
&lt;head&gt;
&lt;!-- include mhttpd js library   --&gt;
&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>  src=<span class="stringliteral">&quot;/mhttpd.js&quot;</span>&gt;
&lt;/script&gt;

&lt;!-- js_constants! -&gt; filename  names.js
List of device names and corresponding index into arrays
 --&gt;
&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>  src=<span class="stringliteral">&quot;js_constants!&quot;</span>&gt;
&lt;/script&gt;

&lt;!-- js_functions! -&gt; filename  common_functions.js
 --&gt;      
&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span>  src=<span class="stringliteral">&quot;js_functions!&quot;</span>&gt;
&lt;/script&gt;
.......
</pre></div><hr/>
<h3><a class="anchor" id="RC_mhttpd_custom_key_access">
Access to the ODB from a Custom Page</a></h3>
<p>To include the custom features such as Buttons, ODB editing etc. a custom page needs to have at least one form declared with the HTML <span class="htmltag"> &lt;form...&gt;....&lt;/form&gt; </span> tags. Declarations for buttons, ODB editing etc. must be inserted between the enclosing HTML <span class="htmltag">&lt;form...&gt; </span> tags, which are coded like this : </p>
<div class="fragment"><pre class="fragment">&lt;form method=<span class="stringliteral">&quot;GET&quot;</span> action=<span class="stringliteral">&quot;http://hostname.domain:port/CS/&lt;Custom_page_key&gt;&quot;</span>&gt;
.......
.......
&lt;/form&gt;
</pre></div><p> where <span class="odb">Custom_page_key</span> is the name of the key that has been <a class="el" href="RC_mhttpd_Activate.html#RC_odb_custom_keynames">defined in the /Custom ODB directory</a> in order to <a class="el" href="RC_mhttpd_Activate.html">activate the custom page</a>.</p>
<p><br/>
 For a <b>remote</b> page defined using a key named <span class="odb">Test&amp;</span>, the HTML <span class="htmltag"> &lt;form...&gt; </span> tag might be </p>
<div class="fragment"><pre class="fragment">&lt;form method=<span class="stringliteral">&quot;GET&quot;</span> action=<span class="stringliteral">&quot;http://hostname.domain:port/CS/Test&amp;&quot;</span>\&gt;
</pre></div><p>For a <b>local</b> page defined using a key named <span class="odb">MyExpt&amp;</span>, the <span class="htmltag">&lt;form...&gt;</span> tag might be </p>
<div class="fragment"><pre class="fragment">&lt;form name=<span class="stringliteral">&quot;form1&quot;</span> method=<span class="stringliteral">&quot;Get&quot;</span> action=<span class="stringliteral">&quot;/CS/MyExpt&amp;&quot;</span>&gt;
</pre></div><p><br/>
</p>
<hr/>
<p><a class="anchor" id="idx_mhttpd_page_custom_refresh"></a> </p>
<h3><a class="anchor" id="RC_mhttpd_custom_refresh">
Page refresh</a></h3>
<p>The following <span class="htmltag">&lt;meta...&gt; </span> tag included in the HTML header code will cause the whole custom page to refresh in 60 seconds :</p>
<div class="fragment"><pre class="fragment">&lt;meta http-equiv=<span class="stringliteral">&quot;Refresh&quot;</span> content=<span class="stringliteral">&quot;60&quot;</span>&gt;
</pre></div><p> <br/>
</p>
<p>It is also possible to <a class="el" href="RC_mhttpd_custom_ODB_access_features.html#RC_mhttpd_js_update_part">periodically update parts</a> of a custom page.</p>
<hr/>
<h2><a class="anchor" id="RC_mhttpd_custom_midas_buttons">
Access to the standard MIDAS Menu buttons</a></h2>
<p>Access to the standard MIDAS Menu buttons can be provided with HTML <span class="htmltag">&lt;input...&gt;</span> tags of the form:</p>
<ul>
<li><span class="htmltag"> &lt;input name="cmd" value=&lt;<em>button-name</em> &gt; type="submit" &gt; </span></li>
</ul>
<p>Valid values are the standard MIDAS <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_menu_buttons">Menu buttons</a> (Start, Pause, Resume, Stop, ODB, Elog, Alarms, History, Programs, etc). The <span class="htmltag">&lt;input...&gt;</span> tags must be declared within enclosing HTML <span class="htmltag">&lt;form...&gt;....&lt;/form&gt; </span> tags (see <a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_key_access">above</a>).</p>
<p>The following html fragment shows the inclusion of three of the standard buttons, giving access to the Main Status, ODB and Messages pages : </p>
<div class="fragment"><pre class="fragment">&lt;form name=<span class="stringliteral">&quot;form1&quot;</span> method=<span class="stringliteral">&quot;Get&quot;</span> action=<span class="stringliteral">&quot;/CS/MyExpt&amp;&quot;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;cmd&quot;</span> value=<span class="stringliteral">&quot;Status&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;cmd&quot;</span> value=<span class="stringliteral">&quot;ODB&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;cmd&quot;</span> value=<span class="stringliteral">&quot;Messages&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;
...
&lt;/form&gt;
</pre></div><hr/>
<h2><a class="anchor" id="RC_mhttpd_custom_alias">
Alias Buttons and Hyperlinks</a></h2>
<p>Any hyperlink can easily be included on a custom page by using the standard HTML anchor <span class="htmltag">&lt;a...&gt;</span> tag, e.g. </p>
<div class="fragment"><pre class="fragment">&lt;a href=<span class="stringliteral">&quot;http://ladd00.triumf.ca/~daqweb/doc/midas/html/&quot;</span>&gt;Midas Help&lt;/a&gt;
</pre></div><p>Links on a custom page equivalent to <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_Alias_buttons">alias-buttons</a> can also be made e.g.</p>
<div class="fragment"><pre class="fragment">&lt;button type=<span class="stringliteral">&quot;button&quot;</span> onclick=<span class="stringliteral">&quot;document.location.href=&apos;/Alias/alias&amp;&apos;;&quot;</span>&gt;alias&lt;/button&gt;
</pre></div><h2><a class="anchor" id="RC_mhttpd_custom_simple_example">
Simple Example of a custom page in HTML</a></h2>
<p>Here is a simple example of an HTML custom page demonstrating the features described above, including access to</p>
<ul>
<li>the standard MIDAS Menu buttons<ul>
<li>"Status" and "ODB"</li>
</ul>
</li>
<li>alias buttons<ul>
<li>"TPC Button" a local link through the <span class="odb">/alias</span> ODB tree</li>
<li>"triumf" an external link</li>
</ul>
</li>
<li>alias links<ul>
<li>"TpcGasPlc" local link to <span class="odb">/Equipment/TpcGasPlc</span></li>
<li>"TPC Alias-link" local link through the <span class="odb">/alias</span> ODB tree (to same area as "TPC Button")</li>
</ul>
</li>
</ul>
<p><br/>
 </p>
<center> <span class="image">A simple custom page</span> </p>
<div align="center">
<img src="simple_custom.jpg" alt="simple_custom.jpg"/>
</div>
 </center><p> <br/>
</p>
<p>The code for this page is shown below: </p>
<div class="fragment"><pre class="fragment"> &lt;!DOCTYPE html PUBLIC <span class="stringliteral">&quot;-//w3c//dtd html 4.0 transitional//en&quot;</span>&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;simple custom page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form name=<span class="stringliteral">&quot;form1&quot;</span> method=<span class="stringliteral">&quot;Get&quot;</span> action=<span class="stringliteral">&quot;/CS/Colour&amp;&quot;</span>&gt;
&lt;table style=<span class="stringliteral">&quot;text-align: center; width: 40%;&quot;</span> border=<span class="stringliteral">&quot;1&quot;</span> cellpadding=<span class="stringliteral">&quot;2&quot;</span> cellspacing=<span class="stringliteral">&quot;2&quot;</span>&gt;
&lt;tr&gt;
&lt;td colspan=<span class="stringliteral">&quot;2&quot;</span>
style=<span class="stringliteral">&quot;vertical-align: top; background-color: mediumslateblue; color: white; text-align: center;&quot;</span>&gt;
Custom Page <span class="keywordflow">for</span> experiment &lt;odb src=<span class="stringliteral">&quot;/Experiment/Name&quot;</span>&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: lightyellow;  text-align: center;&quot;</span>&gt;
Run Control Buttons:&lt;/td&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: lightyellow;  text-align: center;&quot;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;cmd&quot;</span> value=<span class="stringliteral">&quot;Status&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;
&lt;input name=<span class="stringliteral">&quot;cmd&quot;</span> value=<span class="stringliteral">&quot;ODB&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: seagreen; color: white; text-align: center;&quot;</span>&gt;Alias Buttons:&lt;/td&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: seagreen;  text-align: center;&quot;</span>&gt;
&lt;button type=<span class="stringliteral">&quot;button&quot;</span> onclick=<span class="stringliteral">&quot;document.location.href=&apos;/Alias/TPC Common&amp;&apos;;&quot;</span>&gt;TPC Button&lt;/button&gt;
&lt;button type=<span class="stringliteral">&quot;button&quot;</span> onclick=<span class="stringliteral">&quot;window.open(&apos;http://triumf.ca&apos;);&quot;</span>&gt;triumf&lt;/button&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: fuschia;  text-align: center;&quot;</span>&gt;Links:&lt;/td&gt;
&lt;td
style=<span class="stringliteral">&quot;vertical-align: top; background-color: fuschia;  text-align: center;&quot;</span>&gt;
&lt;a href=<span class="stringliteral">&quot;/SC/TpcGasPlc&quot;</span>&gt;TpcGasPlc&lt;/a&gt;
&lt;a href=<span class="stringliteral">&quot;/Alias/TPC Common&amp;&quot;</span>&gt;TPC Alias-link&lt;/a&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/form&gt;
&lt;/body&gt;
</pre></div><p>To create this page, you need an existing MIDAS experiment. To have all the buttons/links work, you need the ODB keys</p>
<ul>
<li><span class="odb">/Equipment/&lt;eqp-name&gt;</span> (<em>&lt;eqp-name&gt;</em> is "TpcGasPlc" in the example)</li>
<li><span class="odb">/Alias/&lt;alias-name&gt;</span> (<em>&lt;alias-name&gt;</em> is "TPC Common&amp;" in the example)</li>
</ul>
<ul>
<li>create a file <em>custom.html</em> containing the above code. In this example, the code is in path <em>/home/mydir/custom.html</em></li>
<li>in <em>custom.html</em><ul>
<li>change <em>TPC Common&amp;</em> to your <em> &lt;alias-name&gt; </em> if different</li>
<li>change <em>TpcGasPlc</em> to your <em>&lt;eqp-name&gt; </em> if different</li>
</ul>
</li>
<li>in the ODB for your experiment, create a key <span class="odb">/custom/test</span> as shown below: <div class="fragment"><pre class="fragment">     $ odb
     [local:customgas:S]/&gt;cd /custom
     [local:customgas:S]/Custom&gt;create <span class="keywordtype">string</span> test
     String length [32]:
     [local:customgas:S]/Custom&gt;<span class="keyword">set</span> test <span class="stringliteral">&quot;/home/mydir/custom.html&quot;</span>
</pre></div></li>
<li>on the mhttpd status page for the experiment, there should now be a custom-button labelled "custom"</li>
<li>click on this "custom" button to see the custom page</li>
</ul>
<p><br/>
<hr/>
<br/>
 <a class="anchor" id="idx_mhttpd_buttons_customscript"></a> <a class="anchor" id="idx_mhttpd_custom_script-button"></a> </p>
<h2><a class="anchor" id="RC_mhttpd_custom_script_buttons">
CustomScript Buttons</a></h2>
<p>CustomScript buttons can be provided on custom webpages. These buttons are equivalent to <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_script_buttons">Optional Script buttons</a> on the MIDAS Main Status page, and allow a particular action to be performed when the button is pressed.</p>
<p>If the user defines a new tree in ODB named <span class="odb">/CustomScript</span> , then any key created in the <span class="odb">/CustomScript</span> tree will appear as a script-button of that name on a custom page that includes an HTML <span class="htmltag">&lt;input...&gt;</span> tag of the form: </p>
<div class="fragment"><pre class="fragment">        &lt;input type=submit name=customscript value=<span class="stringliteral">&quot;my button&quot;</span>&gt;
</pre></div><p> where the action of the button <em> "my button"</em> will be found in the <span class="odb">/customscript/my button</span> subdirectory.</p>
<p><a class="anchor" id="idx_ODB_tree_customscript"></a> </p>
<h3><a class="anchor" id="RC_odb_customscript_tree">
ODB /CustomScript tree</a></h3>
<dl class="note"><dt><b>Note:</b></dt><dd>The optional <span class="odb">/CustomScript</span> tree is applicable only to <a class="el" href="RC_mhttpd.html">mhttpd</a>, and ignored by <a class="el" href="RC_odbedit.html">odbedit</a>.</dd></dl>
<p>The syntax of CustomScript buttons in the <span class="odb"> /customscript </span> directory is identical to that of the <a class="el" href="RC_mhttpd_status_page_features.html#RC_mhttpd_status_script_buttons">Optional Script buttons</a> under the <span class="odb">/Script</span> ODB directory, i.e.</p>
<ul>
<li>each sub-directory ( <span class="odb">/CustomScript/&lt;button name&gt;/</span>) should contain at least one string key which is the custom script command to be executed.</li>
<li>Further keys will be passed as <b> arguments </b> to the script.</li>
<li>MIDAS symbolic links are permitted.</li>
</ul>
<p><br/>
 </p>
<h3><a class="anchor" id="RC_mhttpd_customscript_example">
Example of CustomScript buttons and corresponding /CustomScript tree</a></h3>
<p>The following JavaScript fragment shows customscript buttons that appear only when the run is stopped. The button labelled "tri_config" and, depending on the current experimental mode (given by variable <em> "ppg_mode" </em>), three of the mode buttons labelled "1a","1b","1c" or "1d" . </p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span> (rstate == state_stopped) <span class="comment">// run stopped</span>
{
 document.write(<span class="stringliteral">&apos;&lt;input name=&quot;customscript&quot; value=&quot;tri_config&quot; type=&quot;submit&quot;&gt;&apos;</span>);
<span class="keywordflow">if</span>(ppg_mode != <span class="stringliteral">&apos;1a&apos;</span>)
  document.write(<span class="stringliteral">&apos;&lt;input name=&quot;customscript&quot; value=&quot;1a&quot; type=&quot;submit&quot;&gt;&apos;</span>);
<span class="keywordflow">if</span>(ppg_mode != <span class="stringliteral">&apos;1b&apos;</span>)
  document.write(<span class="stringliteral">&apos;&lt;input name=&quot;customscript&quot; value=&quot;1b&quot; type=&quot;submit&quot;&gt;&apos;</span>);
<span class="keywordflow">if</span>(ppg_mode != <span class="stringliteral">&apos;1c&apos;</span>)
 document.write(<span class="stringliteral">&apos;&lt;input name=&quot;customscript&quot; value=&quot;1c&quot; type=&quot;submit&quot;&gt;&apos;</span>);
<span class="keywordflow">if</span>(ppg_mode != <span class="stringliteral">&apos;1d&apos;</span>)
 document.write(<span class="stringliteral">&apos;&lt;input name=&quot;customscript&quot; value=&quot;1d&quot; type=&quot;submit&quot;&gt;&apos;</span>);
}
</pre></div><p>The corresponding entry under /customscript is as shown below. The first button (tri_config) when pressed will cause a user-written program <em> tri_config </em> to be executed. The other buttons "1a","1b" etc. when pressed will cause the current experimental mode to be changed to that mode. Only the entry for "1a" is shown. </p>
<div class="fragment"><pre class="fragment">[local:ebit:S]/&gt;ls /customscript/tri_config
cmd                             /home/ebit/online/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>/perl/exec.pl
include path                    /home/ebit/online/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>/perl/
experiment name -&gt; /experiment/Name
                                ebit
execute                         <span class="stringliteral">&apos;/home/ebit/online/ppg/tri_config -s&apos;</span>
beamline                        ebit

[local:ebit:S]/&gt;ls /customscript/1a
cmd                             /home/ebit/online/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>/perl/change_mode.pl
include path                    /home/ebit/online/<a class="code" href="vppg_8c.html#a763ec2fd56afac7a05f9d3ca2d29328e">ppg</a>/perl/
experiment name -&gt; /experiment/Name
                                ebit
ppg_mode                        1a
modefile                        defaults
</pre></div><p>These buttons are illustrated in the example <a class="el" href="RC_Ebit_custom_page.html">Custom Pages for Ebit Experiment</a></p>
<p><br/>
<hr/>
<br/>
</p>
<p><a class="anchor" id="idx_ODBGetMsg-JavaScript-function"></a> </p>
<h2><a class="anchor" id="RC_mhttpd_custom_getmsg">
Access to message log</a></h2>
<p>The message log can be accessed from a custom page using a call to the <a class="el" href="RC_mhttpd_custom_js_lib.html">JavaScript library function</a> <span class="js"> ODBGetMsg </span> (provided the JS library is <a class="el" href="RC_mhttpd_custom_js_lib.html#RC_mhttpd_include_js_library">included</a>). There is no HTML equivalent to this JS function. <br/>
 </p>
<table style="text-align: left; width: 100%;" border="1" cellpadding="2" cellspacing="0">
<caption align="bottom">Above: ODB Message access from JavaScript </caption>
<tr>
<td colspan="1" style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>JavaScript Function  </p>
</td><td style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>Purpose  </p>
</td><td style="vertical-align: top; background-color: rgb(204, 204, 255); font-weight: bold; text-align: center;"><p>Parameters  </p>
<p></p>
</td></tr>
<tr>
<td style="vertical-align: top; background-color: white; font-weight: bold; text-align: left;"><div class="fragment"><pre class="fragment"> ODBGetMsg(n)
</pre></div>  </td><td style="vertical-align: top; background-color: white; font-weight: normal; text-align: left;"><p>Get the most recent <b>n</b> lines from the system message log  </p>
</td><td style="vertical-align: top; background-color: white; font-weight: normal; text-align: left;"><p><b>n</b> number of lines required   </p>
</td></tr>
</table>
<p><br/>
 This allows the inclusion of the "Last Midas message" on a custom page. e.g. </p>
<div class="fragment"><pre class="fragment">&lt;script&gt;
var message;
message= ODBGetMsg(1);
document.write(<span class="stringliteral">&apos;Last message:&apos;</span>+message+<span class="stringliteral">&apos;&lt;br&gt;&apos;</span>);
&lt;/script&gt;
</pre></div><p><br/>
 </p>
<center> <span class="image">A simple custom page with a call to ODBGetMsg()</span> </p>
<div align="center">
<img src="simple_msg.jpg" alt="simple_msg.jpg"/>
</div>
 </center><p> <br/>
</p>
<p>The Javascript call has been added to the <a class="el" href="RC_mhttpd_custom_features.html#RC_mhttpd_custom_simple_example">Simple Example of a custom page in HTML</a> above, by</p>
<ul>
<li>adding access to the standard MIDAS Javascript library to the header</li>
<li>adding the call to ODBGetMsg()</li>
</ul>
<p>as detailed below: </p>
<div class="fragment"><pre class="fragment">&lt;!DOCTYPE html PUBLIC <span class="stringliteral">&quot;-//w3c//dtd html 4.0 transitional//en&quot;</span>&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt; table test&lt;/title&gt;
&lt;script type=<span class="stringliteral">&quot;text/javascript&quot;</span> src=<span class="stringliteral">&quot;../mhttpd.js&quot;</span>&gt;&lt;/script&gt;
&lt;/head&gt;
............
............
&lt;/table&gt;

&lt;script&gt;
var message;
message= ODBGetMsg(1);
document.write(<span class="stringliteral">&apos;&lt;h2&gt;Last message:&lt;/h2&gt;&apos;</span>+message+<span class="stringliteral">&apos;&lt;br&gt;&apos;</span>);
&lt;/script&gt;
&lt;/form&gt;
&lt;/body&gt;
</pre></div><p><br/>
<hr/>
<br/>
</p>
<ul>
<li><a class="el" href="RC_mhttpd_custom_ODB_access.html">Access to the ODB from a Custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_RPC_access.html">ODB RPC access</a></li>
<li><a class="el" href="RC_mhttpd_Image_access.html">Inserting an Image into a Custom page</a></li>
<li><a class="el" href="RC_mhttpd_custom_status.html">Custom Status page</a></li>
</ul>
<p><br/>
 <br/>
 <a class="anchor" id="end"></a>  
<script type="text/javascript">
// pages parameters: back index next {top bottom}
pages( "RC_mhttpd_custom_js_lib", "RunControl","RC_mhttpd_custom_ODB_access", "RC_mhttpd_custom_features", "" );
sections("Features", "RunControl","FrontendOperation"); // last section; top of this section; next section
</script>
 </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<br>
<hr WIDTH="100%">
Midas DOC Version 2.3.0&nbsp;----&nbsp;PSI Stefan Ritt&nbsp;----
<br>
Contributions: Pierre-Andre Amaudruz - Sergio Ballestrero - Suzannah Daviel -
<a href=http://www.stack.nl/~dimitri/doxygen/features.html>Doxygen</a> - Peter Green -
Qing Gu - Greg Hackman - Gertjan Hofman - Paul Knowles - Exaos Lee - Rudi Meier - Glenn
Moloney - Dave Morris - John M O'Donnell - Konstantin Olchanski - Chris Pearson - Renee Poutissou
- Tamsen Schurman - Andreas Suter - Jan M.Wouters - Piotr Adam Zolnierczuk
<hr WIDTH="100%">

